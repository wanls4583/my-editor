(function(){"use strict";var e={7647:function(e,t,n){n(6624),n(7655),n(2423),n(4810);var i=n(5),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("keep-alive",[n("router-view")],1)],1)},o=[],r={name:"App"},a=r,c=n(5471),l=(0,c.Z)(a,s,o,!1,null,null,null),u=l.exports,h=n(7822),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"window",staticClass:"my-window",style:{"padding-top":e._topBarHeight,"padding-bottom":e._statusHeight},on:{mousedown:e.onWindMouseDown}},["app"===e.mode?n("side-bar",{ref:"sideBar"}):e._e(),n("div",{ref:"rightWrap",staticClass:"my-right-wrap",on:{contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.onContextmenu.apply(null,arguments)}}},[n("editor-bar",{directives:[{name:"show",rawName:"v-show",value:e.editorList.length,expression:"editorList.length"}],attrs:{editorList:e.editorList},on:{change:e.onChangeTab,close:e.onCloseTab,"close-all":e.onCloseAll,"close-saved":e.onCloseSaved,"close-to-left":e.onCloseToLeft,"close-to-right":e.onCloseToRight}}),e._l(e.editorList,(function(t){return[n("editor",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"item.active"}],key:t.id,ref:"editor"+t.id,refInFor:!0,attrs:{active:t.active,id:t.id},on:{change:function(n){return e.onFileChange(t.id)},save:function(n){return e.onSaveFile(t.id)}}})]})),n("window-menu",{ref:"winMenu"})],2),n("title-bar",{ref:"titleBar",attrs:{height:e.topBarHeight},on:{change:e.onMenuChange}}),n("status-bar",{ref:"statusBar",attrs:{height:e.statusHeight,languageList:e.languageList},on:{"select-langeuage":e.onSelectLanguage}}),n("cmd-panel"),n("Dialog",{directives:[{name:"show",rawName:"v-show",value:e.dialogVisible,expression:"dialogVisible"}],attrs:{btns:e.dialogBtns,content:e.dialogContent,icon:this.dialogIcon,"icon-color":this.dialogIconColor,overlay:!0,title:e.dialogTilte},on:{close:e.onDialogClose}})],1)},f=[],m=(n(2833),n(4952),n(3678),n(7481),n(3582),n(6482),n(9727),n(7997),n(9076),n(3766),n(2419),n(1200),n(3646),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"editorBar",staticClass:"my-editor-bar",on:{selectstart:function(e){e.preventDefault()}}},[n("div",{staticClass:"bar-scroller my-scroll-overlay my-scroll-mini"},e._l(e.editorList,(function(t){return n("div",{staticClass:"bar-item my-hover",class:[t.active?"my-active":""],attrs:{title:t.path},on:{click:function(n){return e.onClickItem(t.id)},contextmenu:function(n){return n.preventDefault(),n.stopPropagation(),e.onContextmenu(n,t.id)}}},[n("div",{staticClass:"bar-content",class:[t.icon]},[n("span",{staticClass:"bar-text"},[e._v(e._s(t.name))]),n("div",{staticClass:"bar-icon"},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.saved,expression:"item.saved"}],staticClass:"bar-close-icon iconfont icon-close",attrs:{title:"close"},on:{click:function(n){return n.stopPropagation(),e.onClose(t.id)}}}),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.saved,expression:"!item.saved"}],staticClass:"bar-dot"})])])])})),0),n("editor-bar-menu",{ref:"editorBarMenu"})],1)}),p=[],g=(n(5601),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"wrap"},[n("Menu",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],ref:"menu",attrs:{checkable:!1,menuList:e.menuList,styles:e.menuStyle},on:{change:e.onMenuChange}})],1)}),v=[],y=n(8092),C=n.n(y),k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"scroller",staticClass:"my-menu my-shadow my-border",style:e.styles,on:{mousedown:function(e){e.stopPropagation()}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],ref:"content"},[e._l(e.myMenuList,(function(t,i){return[n("div",{staticClass:"my-menu-group"},e._l(t,(function(t){return n("div",{staticClass:"my-menu-item my-center-between my-hover",class:{"my-active":e.checkable&&t.checked,disabled:t.disabled},on:{mousedown:function(n){return e.onClick(t)},mouseover:function(n){return e.onHover(t)}}},[n("div",{staticClass:"my-menu-title"},[e._v(e._s(t.name))]),t.shortcut?n("div",{staticClass:"my-menu-shortcut"},[e._v(" "+e._s(t.shortcut)+" ")]):e._e()])})),0),i<e.myMenuList.length-1?n("div",{staticClass:"my-separator"}):e._e()]}))],2)])},x=[],b=(n(3109),{name:"Menu",props:{menuList:{type:Array,default:[]},styles:{type:Object},checkable:{type:Boolean,default:!0},hoverCheck:{type:Boolean,default:!1},value:{type:[Number,String]}},data:function(){return{index:-1,itemHeight:26,myMenuList:[]}},computed:{visible:function(){for(var e=0;e<this.myMenuList.length;e++)if(this.myMenuList[e].length)return!0;return!1}},watch:{menuList:function(){this.initMenu()},value:function(e){this.setChecked(e)},index:function(){var e=this;this.$nextTick((function(){e.scrollToIndex()}))}},created:function(){this.initMenu()},mounted:function(){var e=this;this.keydownFn=function(t){e.$refs.content.clientHeight&&(38===t.keyCode?e.setCheckedByIndex(e.index-1):40===t.keyCode?e.setCheckedByIndex(e.index+1):13===t.keyCode&&e.index>-1&&e.$emit("change",e.indexMap[e.index]))},C()(window).on("keydown",this.keydownFn)},destroyed:function(){C()(window).unbind("keydown",this.keydownFn)},methods:{initMenu:function(){var e=this,t=-1,n=this.menuList;this.index=-1,this.maxIndex=-1,this.indexMap={},!n[0]||n[0]instanceof Array||(n=[n]),this.myMenuList=n.map((function(n){return n.map((function(n){return n=Object.assign({},n),n.value=void 0===n.value?n.name:n.value,n.checked=n.value===e.value,e.indexMap[++t]=n,e.maxIndex=t,n.checked&&(e.index=t),n}))}))},scrollToIndex:function(){var e=this.$refs.scroller,t=(this.index+1)*this.itemHeight;e&&t>e.clientHeight+e.scrollTop?e.scrollTop=t-e.clientHeight:e&&t<e.scrollTop+this.itemHeight&&(e.scrollTop=t-this.itemHeight)},onClick:function(e){e.disabled||(this.clearChecked(),e.checked=!0,this.$emit("change",e))},onHover:function(e){this.hoverCheck&&this.setChecked(e.value)},setChecked:function(e){var t=this,n=-1;this.myMenuList.forEach((function(i){i.forEach((function(i){i.checked=i.value===e,n++,i.checked&&(t.index=n)}))})),this.myMenuList.splice()},setCheckedByIndex:function(e){this.clearChecked(),e<0?e=this.maxIndex:e>this.maxIndex&&(e=0),this.indexMap[e].checked=!0,this.index=e,this.myMenuList.splice()},clearChecked:function(){this.myMenuList.forEach((function(e){e.forEach((function(e){e.checked=!1}))}))}}}),w=b,T=(0,c.Z)(w,k,x,!1,null,null,null),L=T.exports,P=new i.Z,E=P,S={name:"EditorBar",components:{Menu:L},data:function(){return{menuList:[[{name:"Close",op:"close",shortcut:"Ctrl+F4"},{name:"Close to the Left",op:"closeToLeft"},{name:"Close to the Right",op:"closeToRight"},{name:"Close Saved",op:"closeSaved",shortcut:"Ctrl+K U"},{name:"Close All",op:"closeAll",shortcut:"Ctrl+K W"}]],menuVisible:!1,menuStyle:{left:"10px",top:"40px"}}},created:function(){this.initEventBus()},methods:{initEventBus:function(){var e=this;E.$on("close-menu",(function(){e.menuVisible=!1}))},show:function(e,t){var n=this;this.tabId=t,this.menuVisible=!0;var i=C()(this.$refs.wrap).parent();this.$nextTick((function(){var t=i.offset(),s=n.$refs.menu.$el.clientWidth;s+e.clientX>t.left+i[0].clientWidth?n.menuStyle.left=e.clientX-t.left-s+"px":n.menuStyle.left=e.clientX-t.left+"px",n.menuStyle.top=e.clientY-t.top+"px"}))},onMenuChange:function(e){switch(e.op){case"close":this.$parent.$emit("close",this.tabId);break;case"closeToLeft":this.$parent.$emit("close-to-left",this.tabId);break;case"closeToRight":this.$parent.$emit("close-to-right",this.tabId);break;case"closeSaved":this.$parent.$emit("close-saved",this.tabId);break;case"closeAll":this.$parent.$emit("close-all",this.tabId);break}this.menuVisible=!1}}},_=S,I=(0,c.Z)(_,g,v,!1,null,null,null),M=I.exports,B=n(9689),D=n(2177),F=n(5094),A=n(9554),N=(n(8588),n(3915),n(8594),n(6242),n(8061),n(3850),n(1243),n(6864),n(2246),n(8260),n(3660),n(8157),window.require||window.parent.require||function(){}),O=N("@electron/remote"),W=N("path"),$=O.app.getAppPath(),R={dirname:$,scopeIdMap:{},scopeReg:null,colors:{},nowTheme:{value:"Default Dark+",type:"dark",path:W.join($,"main/extensions/theme-monokai/themes/monokai-color-theme.json")},nowIconTheme:{value:"vs-seti",path:W.join($,"main/extensions/theme-seti/icons/vs-seti-icon-theme.json")},nowIconData:{},themes:[],iconThemes:[],languageList:[],scopeFileList:[],scopeTokenList:[],grammars:{},sourceWordMap:{},defaultWordPattern:"(-?\\d*\\.\\d\\w*)|([^\\`\\~\\!\\@\\%\\^\\&\\*\\(\\)\\-\\=\\+\\[\\{\\]\\}\\\\\\|\\;\\:\\'\\\"\\,\\.\\<\\>/\\?\\s]+)"},j=R,H=n(5302),z=window.require||window.parent.require||function(){},V=z("fs"),K=function(){function e(){(0,B.Z)(this,e)}return(0,D.Z)(e,null,[{key:"readClipboard",value:function(){return window.clipboardData?new Promise((function(e){e(clipboardData.getData("Text"))})):navigator.clipboard?navigator.clipboard.readText():void 0}},{key:"writeClipboard",value:function(e){window.clipboardData?clipboardData.setData("Text",e):navigator.clipboard&&navigator.clipboard.writeText(e)}},{key:"getNum",value:function(e){e=String(e),e=e.replace(/[^0123456789\.]/g,"");var t=/^\d+(\.\d*)?$/,n=t.exec(e),i=n&&n[0]||"";return i&&(i=Number(n[0])),i}},{key:"space",value:function(e){for(var t="",n=0;n<e;n++)t+=" ";return t}},{key:"sortNum",value:function(e){e.sort((function(e,t){return Number(e)-Number(t)}))}},{key:"getCharWidth",value:function(t){var n="------------------------------------------------------------------------------------",i="一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一",s="char-width-"+e.getUUID(),o="char-width-"+e.getUUID(),r=C()('<div class="my-line">\n        <div class="my-code"><span id="'.concat(s,'">').concat(n,'</span><span id="').concat(o,'">').concat(i,"</span></div>\n        </div>"));C()(t).append(r);var a=C()("#"+s)[0],c=a.scrollWidth/n.length,l=a.clientHeight,u=window.getComputedStyle?window.getComputedStyle(a,null).fontSize:a.currentStyle.fontSize,h=C()("#"+o)[0].scrollWidth/i.length;return r.remove(),{charWidth:c,fullAngleCharWidth:h,charHight:l,fontSize:u}}},{key:"getStrWidth",value:function(e,t,n,i,s,o){i=i||4,"undefined"!=typeof s&&(e=e.substr(s)),"undefined"!=typeof o&&(e=e.substring(0,o-s));var r=e.match(this.fullAngleReg),a=e.length*t,c=e.match(/\t/g);return c=c&&c.length||0,r=r&&r.length||0,r&&(r-=c,a=r*n+(e.length-r)*t,a+=c*t*(i-1)),a}},{key:"getStrExactWidth",value:function(t,n,i){if(e.getStrExactWidth.count=e.getStrExactWidth.count||0,e.getStrExactWidth.count++,!t)return 0;var s="str-width-"+e.getUUID(),o=C()('<div class="my-line my-temp-text" style="visibility:hidden">\n        <div class="my-code" id="'.concat(s,'">').concat(c(t),"</div>\n        </div>"));C()(i).append(o);var r=C()("#"+s)[0],a=r.clientWidth;return C()(".my-temp-text").remove(),a;function c(t){for(var i=Math.floor(t.length/100),s=[],o=0;o<i;o++){var r=100*o;s.push(e.htmlTrans(t.slice(r,r+100)))}return i*=100,i<t.length&&s.push(e.htmlTrans(t.slice(i))),"<span>".concat(s.join("</span><span>").replace(/\t/g,e.space(n||4)),"</span>")}}},{key:"htmlTrans",value:function(e){return e=e.replace(/\&\#/g,"&amp;#"),e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{key:"deepAssign",value:function(e,t,n){return i(e,t,n,new Map);function i(e,t,n,s){for(var o in n=n||[],t){var r=t[o];if(n.indexOf(o)>-1)e[o]=r;else if("object"!==(0,A.Z)(r)||r instanceof RegExp||null===r||r.nodeName&&r.nodeType)e[o]=r;else if(s.has(r))e[o]=s.get(r);else{var a=null;r instanceof Array?(a=e[o]||[],s.set(r,a),e[o]=i(a,r,n,new Map(s))):(a=e[o]||{},s.set(r,a),e[o]=i(a,r,n,new Map(s)))}}return e}}},{key:"getUUID",value:function(e){e=e||16;for(var t="",n=0;n<e;n++)t+=(16*Math.random()|0).toString(16);return t}},{key:"comparePos",value:function(e,t){return e.line>t.line||e.line==t.line&&e.column>t.column?1:e.line==t.line&&e.column==t.column?0:-1}},{key:"createWorker",value:function(e){var t=new Blob([e]),n=window.URL.createObjectURL(t),i=new Worker(n);return i}},{key:"defineProperties",value:function(e,t,n){var i={};n.forEach((function(e){i[e]={get:function(){return"function"==typeof t[e]?t[e].bind(t):t[e]}}})),Object.defineProperties(e,i)}},{key:"getLanguageById",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].language===t)return e[n]}},{key:"getLanguageByScopeName",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].scopeName===t)return e[n]}},{key:"getWordPattern",value:function(t){var n=j.defaultWordPattern;if(t=e.getLanguageById(j.languageList,t),t){var i=j.sourceWordMap[t.scopeName];i=i&&i.pattern,n=i||n}return new RegExp(n)}},{key:"getIconByPath",value:function(e,t,n,i,s){var o=/[^\\\/]+$/.exec(t),r="",a="";return o=o&&o[0],e?(o&&(r=/(?<=\.)[^\.]+$/.exec(o),a=/(?<=\.)[^\.]+\.[^\.]+$/.exec(o),r=r&&r[0],a=a&&a[0]),"light"!==n&&"contrast light"!==n||(e=e.light),"dir"===i?s?e.folderExpanded:e.folder:e.fileNames&&e.fileNames[o]?e.fileNames[o]:e.fileExtensions&&e.fileExtensions[a]?e.fileExtensions[a]:e.fileExtensions&&e.fileExtensions[r]?e.fileExtensions[r]:e.file):""}},{key:"readFile",value:function(e){return new Promise((function(t,n){V.readFile(e,(function(e,i){return e?n(e):t(i)}))}))}},{key:"loadJsonFile",value:function(t){return e.readFile(t).then((function(e){return e=e.toString(),e=(0,H.Z)(e),e=e.replaceAll(/\,(?=\s*(?:(?:\r\n|\n|\r))*\s*[\]\}])/g,""),e=JSON.parse(e),e}))}},{key:"fuzzyMatch",value:function(t,n,i){var s={},o={},r=0,a=0,c="",l="",u=!1,h={},d=0,f=[],m=null,p=n.toLowerCase();if(t===n)return i?{score:100,indexs:[]}:null;C();for(var g=0;g<n.length;g++){var v=n[g],y=p[g];if(s[y]&&(!c||o[c+y]||o[y+c]&&u))if(!h[y]||h[y]<s[y]){if(h[y]=h[y]?h[y]+1:1,f.push(g),"_"===y||"$"===y?a+=10:u&&(a+=5,o[c+y]&&(a+=1,k(l,v)&&u&&(a+=5))),x(y))return m;o[y+c]&&!o[c+y]||(c=y,l=v),u=!0}else a--,u=y===c;else!d&&a>-9?a-=3:a--,u=y===c}function C(){if(e.fuzzyMatch.cache&&e.fuzzyMatch.cache.word===t)return s=e.fuzzyMatch.cache.wordMap,o=e.fuzzyMatch.cache.towMap,void(r=e.fuzzyMatch.cache.wordLength);for(var n="",i=0;i<t.length;i++){var a=t[i].toLowerCase();s[a]=s[a]?s[a]+1:1,i>0&&(o[n+a]=!0),n=a}r=Object.keys(s).length,e.fuzzyMatch.cache={word:t,wordMap:s,towMap:o,wordLength:r}}function k(e,t){var n=e.charCodeAt(0),i=t.charCodeAt(0);return n<97&&i>=97||i<97&&n>=97}function x(e){if(h[e]===s[e]&&++d===r)return m={score:a,indexs:f},!0}}}]),e}();Array.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},Array.prototype.empty=function(){return this.length=0,this},Array.prototype.insert=function(e,t){if(t&&this.length){var n=0,i=this.length-1;while(n<i){var s=Math.floor((n+i)/2);t(e,this[s])>0?n=s+1:i=s}t(e,this[n])<0&&n--,this.splice(n+1,0,e)}else this.push(e)},String.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},K.fullAngleReg=/[\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF\uFFF9-\uFFFC]|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,K.keyCode={DELETE:46,BACKSPACE:8},K.command=(0,F.Z)({DELETE:"delete",INSERT:"insert",MOVEUP:"moveLineUp",MOVEDOWN:"moveLineDown",COPY_UP:"copyLineUp",COPY_DOWN:"copyLineDown",DELETE_COPY_UP:"deleteCopyLineUp",DELETE_COPY_DOWN:"deleteCopyLineDown",REPLACE:"replace",INSERT_LINE:"insertLine",DELETE_LINE:"deleteLine"},"REPLACE","replace"),K.constData={LINE_COMMENT:"line-comment",BLOCK_COMMENT:"block-comment",BRACKET:"bracket",TAG:"tag"};var Z=K,U=function(){function e(t){(0,B.Z)(this,e),this.initProperties(t)}return(0,D.Z)(e,[{key:"initProperties",value:function(e){Z.defineProperties(this,e,["$emit"])}},{key:"onKeyDown",value:function(e){if(e.ctrlKey)if(this.pressK)switch(this.pressK=!1,e.keyCode){case 85:e.preventDefault(),this.$emit("close-saved");break;case 87:e.preventDefault(),this.$emit("close-all");break}else switch(e.keyCode){case 75:e.preventDefault(),this.pressK=!0;break;case 115:e.preventDefault(),this.$emit("close");break}}}]),e}(),Y={name:"EditorBar",components:{EditorBarMenu:M},props:{editorList:{type:Array}},data:function(){return{list:[]}},provide:function(){return{rootList:this.list}},created:function(){var e=this;this.shortcut=new U(this),this.initEventBus(),C()(window).on("keydown",(function(t){e.shortcut.onKeyDown(t)}))},methods:{initEventBus:function(){var e=this;E.$on("tab-change",(function(t){e.$nextTick((function(){var t=C()(e.$refs.editorBar).find("div.my-active");t.length&&t[0].scrollIntoView()}))}))},onClickItem:function(e){this.$emit("change",e)},onClose:function(e){this.$emit("close",e)},onContextmenu:function(e,t){this.$refs.editorBarMenu.show(e,t)}}},q=Y,G=(0,c.Z)(q,m,p,!1,null,null,null),X=G.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"editor",staticClass:"my-editor-wrap",on:{contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.onContextmenu.apply(null,arguments)},selectstart:function(e){e.preventDefault()},wheel:function(t){return t.preventDefault(),e.onWheel.apply(null,arguments)}}},[e.active?n("div",{staticClass:"my-nums",style:{top:e._numTop}},[n("div",{staticClass:"my-num",staticStyle:{visibility:"hidden"}},[e._v(e._s(e.maxLine))]),e._l(e.renderHtmls,(function(t){return n("div",{key:t.num,staticClass:"my-num",class:{"my-active":e.nowCursorPos.line===t.num},style:{height:e._lineHeight,"line-height":e._lineHeight}},[n("span",{staticClass:"num"},[e._v(e._s(t.num))]),t.fold?n("span",{staticClass:"my-fold my-center-center",class:["iconfont","open"==t.fold?"my-fold-open icon-down1":"my-fold-close icon-right"],on:{click:function(n){return e.onToggleFold(t.num)}}}):e._e()])}))],2):e._e(),n("div",{staticClass:"my-content-wrap",style:{"box-shadow":e._leftShadow}},[n("div",{ref:"scroller",staticClass:"my-scroller my-scroll-overlay",on:{scroll:e.onScroll}},[n("div",{ref:"content",staticClass:"my-content",style:{minWidth:e._contentMinWidth,height:e.contentHeight},on:{mousedown:e.onContentMdown,mousemove:e.onContentMmove,mouseleave:e.onContentMLeave,selectend:function(t){return t.preventDefault(),e.onSelectend.apply(null,arguments)}}},[e.active?n("div",{ref:"render",staticClass:"my-render",style:{top:e._top}},e._l(e.renderHtmls,(function(t){return n("div",{key:t.num,staticClass:"my-line",class:{"my-active":e._activeLine(t.num)},style:{height:e._lineHeight,"line-height":e._lineHeight},attrs:{"data-line":t.num,id:"line_"+t.num}},[n("div",{staticClass:"my-code",class:[t.active?"my-active":"",t.selected?t.isFsearch?"my-search-bg":"my-select-bg":"",t.selected&&e.selectedFg?"my-select-fg":"","close"==t.fold?"fold-close":""],attrs:{"data-line":t.num},domProps:{innerHTML:e._s(t.html)}}),e.bracketMatch&&t.num==e.bracketMatch.start.line?n("div",{staticClass:"my-bracket-match",style:{left:e.bracketMatch.start.left+"px",width:e.bracketMatch.start.width+"px"}}):e._e(),e.bracketMatch&&t.num==e.bracketMatch.end.line?n("div",{staticClass:"my-bracket-match",style:{left:e.bracketMatch.end.left+"px",width:e.bracketMatch.end.width+"px"}}):e._e(),e._l(t.selectStarts,(function(e){return n("div",{staticClass:"my-line-bg my-select-bg",class:{"my-active":e.active,"my-search-bg":e.isFsearch},style:{left:e.left+"px",width:e.width+"px"}})})),e._l(t.selectEnds,(function(e){return n("div",{staticClass:"my-line-bg my-select-bg",class:{"my-active":e.active,"my-search-bg":e.isFsearch},style:{left:e.left+"px",width:e.width+"px"}})})),e._l(t.tabNum,(function(t){return n("span",{staticClass:"my-tab-line",style:{left:e._tabLineLeft(t)}})})),e._l(t.cursorList,(function(t){return n("div",{staticClass:"my-cursor",staticStyle:{top:"0px"},style:{height:e._lineHeight,left:t,visibility:e._cursorVisible}})}))],2)})),0):e._e(),n("textarea",{ref:"textarea",staticClass:"my-textarea",style:{top:e._textAreaPos.top,left:e._textAreaPos.left},on:{blur:e.onBlur,compositionend:e.onCompositionend,compositionstart:e.onCompositionstart,copy:function(t){return t.preventDefault(),e.onCopy.apply(null,arguments)},cut:function(t){return t.preventDefault(),e.onCut.apply(null,arguments)},focus:e.onFocus,input:e.onInput,keydown:e.onKeyDown,paste:function(t){return t.preventDefault(),e.onPaste.apply(null,arguments)}}}),n("auto-tip",{directives:[{name:"show",rawName:"v-show",value:e.autoTipList&&e.autoTipList.length,expression:"autoTipList && autoTipList.length"}],ref:"autoTip",attrs:{styles:e.autoTipStyle,tipList:e.autoTipList},on:{change:e.onClickAuto}})],1)]),n("search-dialog",{directives:[{name:"show",rawName:"v-show",value:e.searchVisible,expression:"searchVisible"}],ref:"searchDialog",attrs:{count:e.searchCount,now:e.searchNow},on:{close:e.onCloseSearch,next:function(t){return e.onSearchNext()},prev:function(t){return e.onSearchPrev()},replace:e.replace,replaceAll:e.replaceAll,search:e.onSearch}})],1),n("Menu",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],ref:"menu",attrs:{checkable:!1,menuList:e.menuList,styles:e.menuStyle},on:{change:e.onClickMenu}}),n("tip",{directives:[{name:"show",rawName:"v-show",value:e.tipContent,expression:"tipContent"}],ref:"tip",attrs:{content:e.tipContent,styles:e.tipStyle}})],1)},Q=[],ee=(n(4996),n(7518),n(5031)),te=n(650),ne=window.require||window.parent.require||function(){},ie=ne("fs"),se=ne("path"),oe={stringToken:/(\.|^)string(\.|$)/},re=function(){function e(t,n){(0,B.Z)(this,e),this.currentLine=1,this.initRegistry(),this.initProperties(t,n),this.initLanguage(t.language)}return(0,D.Z)(e,[{key:"initRegistry",value:function(){var e=this,t=ie.readFileSync(se.join(j.dirname,"main/lib/onig.wasm")).buffer,n=te.loadWASM(t).then((function(){return{createOnigScanner:function(e){return new te.OnigScanner(e)},createOnigString:function(e){return new te.OnigString(e)}}}));this.registry=new ee.Registry({onigLib:n,loadGrammar:function(t){var n=Z.getLanguageByScopeName(j.scopeFileList,t);return n?n.configPath?Z.loadJsonFile(n.configPath).then((function(t){return e.sourceFoldMap[n.scopeName]={},j.sourceWordMap[n.scopeName]=t.wordPattern,e.hasTextGrammar=e.hasTextGrammar||n.scopeName.startsWith("text"),e.initLanguageConifg(e.sourceFoldMap[n.scopeName],t),Z.readFile(n.path).then((function(e){return ee.parseRawGrammar(e.toString(),n.path)}))})):Z.readFile(n.path).then((function(e){return ee.parseRawGrammar(e.toString(),n.path)})):null}})}},{key:"initLanguage",value:function(e){var t=this;if(this.language!==e){if(this.language=e,this.grammar=null,this.foldType=1,this.sourceFoldMap={},this.hasTextGrammar=!1,this.currentLine=1,e=Z.getLanguageById(j.languageList,e),this.scopeName=e&&e.scopeName||"",this.scopeName){if(!j.grammars[this.scopeName])return this.registry.loadGrammar(this.scopeName).then((function(e){t.grammar=e,j.grammars[t.scopeName]={grammar:e,sourceFoldMap:t.sourceFoldMap,hasTextGrammar:t.hasTextGrammar},t.tokenizeVisibleLins()}));var n=j.grammars[this.scopeName];this.grammar=n.grammar,this.sourceFoldMap=n.sourceFoldMap,this.hasTextGrammar=n.hasTextGrammar}return this.tokenizeVisibleLins(),Promise.resolve()}}},{key:"initProperties",value:function(e,t){Z.defineProperties(this,e,["startLine","maxVisibleLines","maxLine","renderLine","folder","$nextTick"]),Z.defineProperties(this,t,["htmls"])}},{key:"initLanguageConifg",value:function(e,t){var n=this,i=[];e.__comments__={lineComment:"",blockComment:[]},t.comments&&(t.comments.lineComment&&(i.push(t.comments.lineComment),e[t.comments.lineComment]=0,e.__comments__.lineComment=t.comments.lineComment),t.comments.blockComment&&(i.push(t.comments.blockComment[0]),i.push(t.comments.blockComment[1]),e[t.comments.blockComment[0]]=-this.foldType,e[t.comments.blockComment[1]]=this.foldType,e.__comments__.blockComment=t.comments.blockComment,e.__endCommentReg__=new RegExp(t.comments.blockComment[1].replace(/[\{\}\(\)\[\]\&\?\+\*\\]/g,"\\$&"),"g"),this.foldType++)),t.brackets&&t.brackets.forEach((function(t){e[t[0]]?e[t[1]]||(i.push(t[1]),e[t[1]]=-e[t[0]]):e[t[1]]?e[t[0]]||(i.push(t[0]),e[t[0]]=-e[t[1]]):(i.push(t[0]),i.push(t[1]),e[t[0]]=-n.foldType,e[t[1]]=n.foldType,n.foldType++)})),i=i.join("|"),i=i.replace(/[\{\}\(\)\[\]\&\?\+\*\\]/g,"\\$&"),e.__foldReg__=new RegExp(i,"g")}},{key:"onInsertContentAfter",value:function(e,t){var n=this;e<=this.currentLine?(this.currentLine=e,clearTimeout(this.tokenizeLinesTimer),this.$nextTick((function(){n.currentLine===e&&n.tokenizeLines(e)}))):this.tokenizeVisibleLins()}},{key:"onDeleteContentAfter",value:function(e,t){var n=this;t<=this.currentLine?(this.currentLine=t,clearTimeout(this.tokenizeLinesTimer),this.$nextTick((function(){n.currentLine===t&&n.tokenizeLines(t)}))):this.tokenizeVisibleLins()}},{key:"tokenizeVisibleLins",value:function(){var e=this,t=this.tokenizeVisibleLinsId+1||1;this.tokenizeVisibleLinsId=t,this.$nextTick((function(){if(e.tokenizeVisibleLinsId===t){var n=e.currentLine,i=e.startLine,s=e.startLine+e.maxVisibleLines;s=e.folder.getRealLine(s),e.asyncTokenizeLines(i,s).then((function(){i=e.startLine-2e3,i=i<1?1:i,i>n?e.asyncTokenizeLines(i,s).then((function(){e.tokenizeLines(n)})):e.tokenizeLines(n)}))}}))}},{key:"asyncTokenizeLines",value:function(e,t){var n=this;return new Promise((function(i){n.tokenizeLines(e,t,i)}))}},{key:"tokenizeLines",value:function(e,t,n){var i=this,s=0,o=Date.now();if(t=t||this.maxLine,t=t>this.maxLine?this.maxLine:t,cancelIdleCallback(this.tokenizeLinesTimer),!this.scopeName||this.grammar){while(e<=t){var r=this.htmls[e-1];if(!r.tokens){var a=this.tokenizeLine(e);if(r.tokens=a.tokens,r.folds=a.folds,r.stateFold=a.stateFold,this.checkLineVisible(e)&&(r.tokens=this.splitLongToken(r.tokens),r.html=this.createHtml(r.tokens,r.text),this.renderLine(r.lineId)),(!r.states||r.states.equals&&!r.states.equals(a.states)||r.states.toString()!==a.states.toString())&&(r.states=a.states,r=this.htmls[e],r&&(r.tokens=null,r.html="")),s++,s%5==0&&Date.now()-o>=20){e++;break}}e++}this.currentLine=e,e<=t?this.tokenizeLinesTimer=requestIdleCallback((function(){i.tokenizeLines(e,t,n)})):n&&n()}else this.tokenizeLinesTimer=setTimeout((function(){i.tokenizeLines(e,t,n)}))}},{key:"createHtml",value:function(e,t){return e.map((function(e){var i="",s=t.substring(e.startIndex,e.endIndex);return"plain"===e.scopes[0]?i="my-plain":"selected"===e.scopes[0]?i="my-select-fg":(i=n(e),i=i&&"my-scope-".concat(i.scopeId)||""),'<span class="'.concat(i,'" data-column="').concat(e.startIndex,'">').concat(Z.htmlTrans(s),"</span>")})).join("");function n(e){var t=null,n=e.scopes;e.scope=n.join(" ");e:for(var i=n.length-1;i>=0;i--)for(var s=n[i],o=0;o<j.scopeTokenList.length;o++){var r=j.scopeTokenList[o],a=r.scopes.peek();if(s.indexOf(a)>-1&&r.regexp.test(e.scope)){t=r;break e}}return t}}},{key:"tokenizeLine",value:function(e){var t=this.htmls[e-1].text,n=[];if(t.length>1e4||!this.scopeName)return{tokens:[{scopes:["plain"],startIndex:0,endIndex:t.length}],folds:[],states:ee.INITIAL};var i=e>1&&this.htmls[e-2].states||ee.INITIAL,s=this.grammar.tokenizeLine(t,i),o=this.addFold(e,s.tokens,n);return s.tokens.peek().endIndex=t.length,{tokens:s.tokens,states:s.ruleStack,folds:n,stateFold:o}}},{key:"addFold",value:function(e,t,n){var i="",s=0,o=!1,r=this.htmls[e-1].text,a=e>1?this.htmls[e-2].stateFold:null;t.forEach((function(e){oe.stringToken.test(e.scopes.join("."))&&(e.isString=!0)}));e:for(var c=0;c<t.length;c++){for(var l=t[c],u="",h=null,d=l.scopes.length-1;d>=0;d--)if(h=this.sourceFoldMap[l.scopes[d]],h){if(u=l.scopes[d],i||c===t.length-1){if(u!==i||c===t.length-1){var f=c===t.length-1?l.endIndex:l.startIndex,m=this.addBracket({tokens:t,line:e,foldMap:h,folds:n,startIndex:s,endIndex:f,stateFold:a,lineText:r});if(m&&m.type===Z.constData.LINE_COMMENT)break e;i=l.scopes[d],s=l.startIndex}}else i=l.scopes[d],s=l.startIndex;break}this.addTagFold({token:l,foldMap:h,folds:n,lineText:r})&&(o=!0)}return o&&n.sort((function(e,t){return e.startIndex-t.startIndex})),n.length?n.peek().type===Z.constData.BLOCK_COMMENT?n.peek():null:a}},{key:"addBracket",value:function(e){var t=e.tokens,n=e.foldMap,i=e.folds,s=e.startIndex,o=e.endIndex,r=e.stateFold,a=e.lineText.slice(s,o),c=n.__foldReg__,l=null,u=null;u=i.length?i.peek():r,u&&u.type===Z.constData.BLOCK_COMMENT&&u.side<0&&(c=n.__endCommentReg__);while(l=c.exec(a)){var h=Z.constData.BRACKET;if(n.__comments__.lineComment===l[0]?h=Z.constData.LINE_COMMENT:n.__comments__.blockComment[0]!==l[0]&&n.__comments__.blockComment[1]!==l[0]||(h=Z.constData.BLOCK_COMMENT),!d(l))if(i.push({startIndex:s+l.index,endIndex:s+l.index+l[0].length,side:n[l[0]],type:h}),h===Z.constData.BLOCK_COMMENT&&n[l[0]]<0)n.__endCommentReg__.lastIndex=c.lastIndex,c.lastIndex=0,c=n.__endCommentReg__;else if(h===Z.constData.LINE_COMMENT)break}return c.lastIndex=0,i.length&&i.peek();function d(e){for(var n=e.index,i=0;i<t.length;i++){if(t[i].startIndex<=n&&t[i].endIndex>n){if(t[i].isString)return!0;break}if(t[i].startIndex>n)break}return!1}}},{key:"addTagFold",value:function(e){var t=e.token,n=e.folds,i=e.foldMap,s=e.lineText;if(this.hasTextGrammar&&t.scopes.peek().startsWith("entity.name.tag")){var o=s.slice(t.startIndex,t.endIndex),r=0;return i[o]?r=i[o]:(r=this.foldType++,i[o]=r),"<"===s[t.startIndex-1]&&(r=-r),n.push({startIndex:t.startIndex,endIndex:t.endIndex,side:r,type:Z.constData.TAG}),!0}}},{key:"splitLongToken",value:function(e){var t=[];return e.forEach((function(e){var n=e.endIndex-e.startIndex;if(n>100){for(var i=e.startIndex,s=Math.floor(n/100),o=0;o<s;o++){var r=100*o,a=100*(o+1);a=a>e.endIndex?e.endIndex:a,t.push({startIndex:r+i,endIndex:a,scopes:e.scopes})}s*=100,s<n&&t.push({startIndex:s+i,endIndex:e.endIndex,scopes:e.scopes})}else t.push(e)})),t}},{key:"checkLineVisible",value:function(e){var t=this.startLine+this.maxVisibleLines;return t=this.folder.getRealLine(t),!this.folder.getLineInFold(e)&&(e>=this.startLine&&e<=t)}}]),e}(),ae=window.require||window.parent.require||function(){},ce=ae("path"),le=ae("child_process"),ue=null,he=function(){function e(t,n){(0,B.Z)(this,e),this.initProperties(t,n),this.initLanguage(t.language),this.initEvent()}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this,t,["htmls","getAllText"]),Z.defineProperties(this,e,["setErrors"])}},{key:"initLanguage",value:function(e){this.language!==e&&(this.language=e,this.setErrors([]),this.initEvent(),this.parse())}},{key:"initEvent",value:function(){var e=this;null===ue&&(ue=le.fork(ce.join(j.dirname,"main/process/lint/index.js")),ue.on("message",(function(t){console.log(t),t.parseId===e.parseId&&e.setErrors(t.results)}))),ue.on("close",(function(){ue=null,e.initEvent()}))}},{key:"onInsertContentAfter",value:function(e,t){var n=this;clearTimeout(this.parseTimer),this.parseId="",this.parseTimer=setTimeout((function(){n.parse()}),300)}},{key:"onDeleteContentAfter",value:function(e,t){var n=this;clearTimeout(this.parseTimer),this.parseId="",this.parseTimer=setTimeout((function(){n.parse()}),300)}},{key:"parse",value:function(){if(this.language){var e=this.getAllText();this.parseId=Z.getUUID(),ue.send({text:e,parseId:this.parseId,language:this.language})}}}]),e}(),de=(n(4649),n(5932),n(9209)),fe={TOKEN_TYPE:{TEXT:"text",SOURCE:"source",TAG_NAME:"tag-name",ATTR_NAME:"attr-name",STRING:"string",WORD:"word",CSS:"css",CSS_VALUE:"css-value",CSS_PROPERTY:"css-property",CSS_SELECTOR:"css-selector",CSS_TAG:"css-tag",CSS_CLASS:"css-class",CSS_ATTR:"css-attr",CSS_PSEUDO:"css-pseudo",EMMET_HTML:"emmet-html",EMMET_CSS:"emmet-css"}},me=window.require||window.parent.require||function(){},pe=me("path"),ge={stringToken:/(?:\.|^)(?:string|regexp)(?:\.|$)/,tagToken:/meta\.tag/,tagNameToken:/entity\.name\.tag/,tagAttrName:/attribute\-name/,cssValueToken:/property\-list|property\-value|separator/,cssPropertyToken:/meta\.property\-name/,cssSelectorToken:/meta\.selector/,cssAttributeToken:/attribute\-selector/,cssClassToken:/attribute\-name\.class/,cssPseudoToken:/pseudo\-element/,styleCss:/([^\:\;\"\'\s]+)\s*\:\s*([^\:\;]+)?$/,styleCssProperty:/(?:^|[\;\"\'])([^\:\;]+)$/},ve=function(){function e(t,n){(0,B.Z)(this,e),this.initProperties(t,n),this.doneMap={},this.results=[],this.wordPattern=Z.getWordPattern(this.language),this.wordPattern=new RegExp("^(".concat(this.wordPattern.source,")$"))}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this,e,["language","cursor","nowCursorPos","tokenizer","autoTipList","setAutoTip","selectAutoTip"]),Z.defineProperties(this,t,["htmls","replaceTip","insertContent"])}},{key:"reset",value:function(){this.currentLine=1,this.results=[],this.doneMap={}}},{key:"stop",value:function(){cancelIdleCallback(this.searchTimer)}},{key:"search",value:function(){var e=this;this.stop(),this.searchTimer=requestIdleCallback((function(){e._search()}))}},{key:"emmet",value:function(){var e=this.htmls[this.nowCursorPos.line-1],t=this.getTokenIndex(this.nowCursorPos),n=e.tokens[t],i=n&&e.text.slice(n.startIndex,this.nowCursorPos.column),s=null,o="";if(i){var r=n.scopes.peek();if(r.startsWith("text."))s=(0,de.Kl)(i),o=fe.TOKEN_TYPE.EMMET_HTML;else if(this._isCssToken(n)){if(this._isCssPropertyToken(n))s=(0,de.Kl)(i,i.length,{type:"stylesheet"});else if(this._isCssValueToken(n)){var a=e.tokens[t-1];a&&this._isCssPropertyToken(a)&&(i=e.text.slice(a.startIndex,a.endIndex)+i,s=(0,de.Kl)(i,i.length,{type:"stylesheet"}))}o=fe.TOKEN_TYPE.EMMET_CSS}}s?this.replaceTip({word:s.abbreviation,result:s.abbreviation,type:o}):this.autoTipList&&this.autoTipList.length?this.selectAutoTip():this.insertContent("\t")}},{key:"_search",value:function(){var e=this.htmls[this.nowCursorPos.line-1],t=this.getTokenIndex(this.nowCursorPos),n=e.tokens[t],i=n&&e.text.slice(n.startIndex,this.nowCursorPos.column);if(this.reset(),this.setAutoTip(null),i)if(this._isTextToken(n)){var s=n.scopes.peek();if(s.startsWith("text."))this._searchEmmet(i);else if(this._isTagNameToken(n))this._searchTagName(i);else if(this._isAttrNameToken(n)){var o=this._getPreTagName(t,this.nowCursorPos.line);o&&this._searchTagAttrName(i,o)}}else if(this._isCssToken(n))if(this._isCssPropertyToken(n))this._searchCssProperty(i);else if(this._isCssValueToken(n)){var r=e.tokens[t-1];if(r&&this._isCssPropertyToken(r)){var a=e.tokens[t-1];a&&this._isCssPropertyToken(a)&&(i=e.text.slice(a.startIndex,a.endIndex)+i,this._searchCssProperty(i))}else{var c=this._getPreCssProperty(t,this.nowCursorPos.line);c&&this._searchCssValue(i,c)}}else this._isCssSelectorToken(n)?(this._isTagNameToken(n)?this._searchCssTag(i):i.indexOf(":")>-1&&this._searchCssPseudo(i),this._searchSelector(i,n)):this._isTagToken(n)&&this._searchStyle(i,n);else this._isSourceToken(n)&&this.wordPattern.test(i)&&this._searchWord(i,n)}},{key:"_searchWord",value:function(e,t){var n=this;this._searchDocument((function(i){i.tokens.forEach((function(s){if(s!==t){var o=i.text.slice(s.startIndex,s.endIndex);if(n.wordPattern.test(o)){if(n._isTextToken(s)||n._isStringToken(s))return;n._addTip({word:e,value:o,type:fe.TOKEN_TYPE.WORD})}}}))}))}},{key:"_searchSelector",value:function(e,t){var n=this;this._isCssClassToken(t)&&"."!==e&&(e="."+e),this._searchDocument((function(i){i.tokens.forEach((function(s){if(s!==t&&n._isCssSelectorToken(s)){var o=i.text.slice(s.startIndex,s.endIndex);if(!n.wordPattern.test(o))return;n._isCssClassToken(s)&&(o="."+o),"."===e?n._isCssClassToken(s)&&".."!==o&&n._addTip({word:e,value:o,type:fe.TOKEN_TYPE.CSS_CLASS,skipMatch:!0}):n._isCssClassToken(t)?n._isCssClassToken(s)&&n._addTip({word:e,value:o,type:fe.TOKEN_TYPE.CSS_CLASS}):n._addTip({word:e,value:o,type:fe.TOKEN_TYPE.CSS_SELECTOR})}}))}),!0)}},{key:"_searchDocument",value:function(e,t){var n=this,i=this.currentLine,s=Date.now(),o=0;while(i<=this.htmls.length){var r=this.htmls[i-1];if(i++,r.tokens&&(e(r),o++,o%5==0&&Date.now()-s>=20))break}this.currentLine=i,this._showTip(t),i<=this.htmls.length&&(this.searchTimer=requestIdleCallback((function(){n._searchDocument(e,t)})))}},{key:"_searchTagName",value:function(e){var t=this,n=this.getHtmlData();n.tags.forEach((function(n){t._addTip({word:e,value:n.name,type:fe.TOKEN_TYPE.TAG_NAME})})),this.results.length||this._addTip({word:e,value:e,type:fe.TOKEN_TYPE.TAG_NAME,skipMatch:!0}),this._showTip()}},{key:"_searchTagAttrName",value:function(e,t){var n=this,i=this.getHtmlData(),s=i.tagMap[t];s=s&&s.attributes,s&&s.forEach((function(t){n._addTip({word:e,value:t.name,type:fe.TOKEN_TYPE.ATTR_NAME,after:'=""'})})),i.globalAttributes.forEach((function(t){n._addTip({word:e,value:t.name,type:fe.TOKEN_TYPE.ATTR_NAME,after:'=""'})})),this._showTip()}},{key:"_searchCssTag",value:function(e){var t=this,n=this.getHtmlData();n.tags.forEach((function(n){t._addTip({word:e,value:n.name,type:fe.TOKEN_TYPE.CSS_TAG})}))}},{key:"_searchCssPseudo",value:function(e){var t=this,n=this.getCssData(),i=e.split(":").peek().trim();n.pseudoClasses.forEach((function(n){i?t._addTip({word:e,value:n.name,type:fe.TOKEN_TYPE.CSS_PSEUDO}):t._addTip({word:e,value:n.name,type:fe.TOKEN_TYPE.CSS_PSEUDO,skipMatch:!0})})),n.pseudoElements.forEach((function(n){i?t._addTip({word:e,value:n.name,type:fe.TOKEN_TYPE.CSS_PSEUDO}):t._addTip({word:e,value:n.name,type:fe.TOKEN_TYPE.CSS_PSEUDO,skipMatch:!0})}))}},{key:"_searchStyle",value:function(e,t){var n=this.nowCursorPos.column,i=this.htmls[this.nowCursorPos.line-1],s=null;if(e=i.text.slice(t.startIndex,n),s=ge.styleCss.exec(e),s&&s[1]){var o=s[1],r=s[2]||"";this._searchCssValue(r,o)}else s=ge.styleCssProperty.exec(e),s&&s[1]&&this._searchCssProperty(s[1])}},{key:"_searchCssProperty",value:function(e){var t=this,n=this.getCssData();if(n.properties.forEach((function(n){t._addTip({word:e,value:n.name,type:fe.TOKEN_TYPE.CSS_PROPERTY,after:": "})})),!this.results.length){var i=(0,de.Kl)(e,e.length,{type:"stylesheet"});i&&i.abbreviation&&this._addTip({word:i.abbreviation,value:i.abbreviation,type:fe.TOKEN_TYPE.EMMET_CSS,skipMatch:!0})}this._showTip()}},{key:"_searchCssValue",value:function(e,t){var n=this,i=this.getCssData(),s=i.propertyMap[t];if(s=s&&s.values,s){var o=e.trim();":"===o||""===o?(s.forEach((function(t){n._addTip({word:e,value:t.name,type:fe.TOKEN_TYPE.CSS_VALUE,before:" ",after:";",skipMatch:!0})})),this._showTip(!0)):(s.forEach((function(t){n._addTip({word:e,value:t.name,type:fe.TOKEN_TYPE.CSS_VALUE,after:";"})})),this._showTip())}}},{key:"_searchEmmet",value:function(e){var t=(0,de.Kl)(e);t&&t.abbreviation&&(this._addTip({word:t.abbreviation,value:t.abbreviation,type:fe.TOKEN_TYPE.EMMET_HTML,skipMatch:!0}),this._showTip())}},{key:"_setTokenType",value:function(e){e.isSourceToken=!1,e.isCssToken=!1,e.isTextToken=!1,e.isTagToken=!1,e.isTagAttrNameToken=!1,e.scope=e.scope||e.scopes.join(" ");for(var t=e.scopes.length-1;t>=0;t--){var n=e.scopes[t];if(n.startsWith("source.")){e.isSourceToken=!0,n.startsWith("source.css")&&(e.isCssToken=!0);break}if(n.startsWith("text.")){e.isTextToken=!0,e.isTagAttrNameToken=ge.tagAttrName.test(e.scope);break}}e.isTagToken=ge.tagToken.test(e.scope),e.isTagNameToken=ge.tagNameToken.test(e.scope),e.isStringToken=ge.stringToken.test(e.scope),e.isCssToken&&(e.isCssValueToken=ge.cssValueToken.test(e.scope),e.isCssPropertyToken=ge.cssPropertyToken.test(e.scope),e.isCssSelectorToken=ge.cssSelectorToken.test(e.scope),e.isCssClassToken=ge.cssClassToken.test(e.scope),e.isCssAttributeToken=ge.cssAttributeToken.test(e.scope),e.isCssPseudoToken=ge.cssPseudoToken.test(e.scope))}},{key:"_isTextToken",value:function(e){return void 0===e.isTextToken&&this._setTokenType(e),e.isTextToken}},{key:"_isSourceToken",value:function(e){return void 0===e.isSourceToken&&this._setTokenType(e),e.isSourceToken}},{key:"_isCssToken",value:function(e){return void 0===e.isCssToken&&this._setTokenType(e),e.isCssToken}},{key:"_isCssPropertyToken",value:function(e){return void 0===e.isCssPropertyToken&&this._setTokenType(e),e.isCssPropertyToken}},{key:"_isCssValueToken",value:function(e){return void 0===e.isCssValueToken&&this._setTokenType(e),e.isCssValueToken}},{key:"_isCssSelectorToken",value:function(e){return void 0===e.isCssSelectorToken&&this._setTokenType(e),e.isCssSelectorToken}},{key:"_isCssClassToken",value:function(e){return void 0===e.isCssClassToken&&this._setTokenType(e),e.isCssClassToken}},{key:"_isCssAttributeToken",value:function(e){return void 0===e.isCssAttributeToken&&this._setTokenType(e),e.isCssAttributeToken}},{key:"_isCssPseudoToken",value:function(e){return void 0===e.isCssPseudoToken&&this._setTokenType(e),e.isCssPseudoToken}},{key:"_isStringToken",value:function(e){return void 0===e.isStringToken&&this._setTokenType(e),e.isStringToken}},{key:"_isTagToken",value:function(e){return void 0===e.isTagToken&&this._setTokenType(e),e.isTagToken}},{key:"_isTagNameToken",value:function(e){return void 0===e.isTagNameToken&&this._setTokenType(e),e.isTagNameToken}},{key:"_isAttrNameToken",value:function(e){return void 0===e.isTagAttrNameToken&&this._setTokenType(e),e.isTagAttrNameToken}},{key:"_getPreTagName",value:function(e,t){var n="",i=0;e:while(t>=1){var s=this.htmls[t-1];if(!s.tokens)break;e=e>-1?e:s.tokens.length;for(var o=e-1;o>=0;o--){var r=s.tokens[o];if(this._isTagNameToken(r)){n=s.text.slice(r.startIndex,r.endIndex);break e}if(i++,i>100)break e}t--,e=-1}return n}},{key:"_getPreCssProperty",value:function(e,t){var n="",i=0;e:while(t>=1){var s=this.htmls[t-1];if(!s.tokens)break;e=e>-1?e:s.tokens.length;for(var o=e-1;o>=0;o--){var r=s.tokens[o];if(this._isCssPropertyToken(r)){n=s.text.slice(r.startIndex,r.endIndex);break e}if(i++,i>100||!this._isCssValueToken(r))break e}t--,e=-1}return n}},{key:"_addTip",value:function(e){var t=null,n=e.fullMatch;if(n=void 0===n||n,!this.doneMap[e.value]||e.skipDone)if(t=e.skipMatch?{indexs:[],score:0}:Z.fuzzyMatch(e.word.trim(),e.value,n),t){var i={result:e.value,word:e.word||"",desc:e.desc||"",type:e.type||"",before:e.before||"",after:e.after||"",icon:this.getIcon(e.scope),indexs:t.indexs,score:t.score};this.results.push(i),this.doneMap[e.value]=i}else this.doneMap[e.value]=!0}},{key:"_showTip",value:function(e){var t=null,n=e?200:10;this.results.sort((function(e,t){return t.score-e.score})),t=this.results.slice(0,n),this.setAutoTip(t)}},{key:"checkEmmetValid",value:function(e){var t="";if(ge.invalidEmmetParen.exec(e))return!1;while(e!==(t=e.replace(ge.paremEmmet,"a")))e=t;return!!ge.emmet.exec(e)}},{key:"getTokenIndex",value:function(e){var t=this.htmls[e.line-1].tokens;if(t)for(var n=0;n<t.length;n++)if(t[n].startIndex<e.column&&t[n].endIndex>=e.column)return n;return-1}},{key:"getHtmlData",value:function(){if(this.htmlData)return this.htmlData;var e=me(pe.join(j.dirname,"main/data/browsers.html-data"));return this.htmlData=e,e.tagMap={},e.tags.forEach((function(t){e.tagMap[t.name]=t})),this.htmlData}},{key:"getCssData",value:function(){if(this.cssData)return this.cssData;var e=me(pe.join(j.dirname,"main/data/browsers.css-data"));return this.cssData=e,e.propertyMap={},e.properties.forEach((function(t){e.propertyMap[t.name]=t})),this.cssData}},{key:"getIcon",value:function(e){return""}}]),e}(),ye=ve,Ce=(n(8361),n(5782),(0,D.Z)((function e(t){(0,B.Z)(this,e),this.dataList=new Array(t+1),this.linkList=new Array(t+2),this.num=0,this.next=null,this.prev=null,this.pNode=null}))),ke=function(){function e(t,n){(0,B.Z)(this,e),this.max=n||4,this.root=null,this.head=null,this.size=0,this.compare=t||function(e,t){return e-t}}return(0,D.Z)(e,[{key:"insert",value:function(e){if(!this.root){var t=new Ce(this.max);return t.dataList[0]=e,t.num++,this.root=t,this.head=t,this.size++,void(this.arrayCache=null)}var n=this._search(e,!0),i=null,s=Math.floor(this.max/2)||1,o=this.iterator(n,e);if(this.findIndex(n,e)>-1)return o;this.size++,this.arrayCache=null;while(n){for(var r=n.linkList,a=n.dataList,c=0;c<n.num;c++){var l=a[c];if(this.compare(e,l)<0){m(a,r,c);break}c===n.num-1&&m(a,r,c+1)}if(n.num++,n.num<=this.max)break;var u=new Ce(this.max),h=n.linkList[0];e=a[s],h||(n.next&&(n.next.prev=u),u.next=n.next,n.next=u,u.prev=n,u.pNode=n.pNode),i=u;for(var d=h?s+1:s,f=0;d<n.num;d++,f++)u.dataList[f]=a[d],u.linkList[f+1]=r[d+1],u.linkList[f+1]&&(u.linkList[f+1].pNode=u),a[d]=null,r[d+1]=null,u.num++;if(n.num=s,h&&(n.dataList[n.num]=null,u.linkList[0]=n.linkList[n.num+1],u.linkList[0]&&(u.linkList[0].pNode=u),n.linkList[n.num+1]=null),!n.pNode){this.root=new Ce(this.max),this.root.dataList[0]=e,this.root.linkList[0]=n,this.root.linkList[1]=u,this.root.num=1,n.pNode=this.root,u.pNode=this.root;break}n=n.pNode}return o;function m(t,s,o){for(var r=n.num;r>=o+1;r--)t[r]=t[r-1],s[r+1]=s[r];t[o]=e,s[o+1]=i,i&&(i.pNode=n)}}},{key:"delete",value:function(e){var t=this,n=this._search(e),i=null,s=Math.floor(this.max/2)||1;if(n){var o=n.dataList,r=this.findIndex(n,e);i=o[r];for(var a=r;a<n.num;a++)o[a]=o[a+1];if(n.num--,this.size--,this.arrayCache=null,!this.size)return this.root=null,i}while(n&&n.num<s&&n.pNode){var c=n.pNode,l=c.linkList.indexOf(n),u=c.linkList[l-1],h=c.linkList[l+1],d=n.linkList[0];u&&u.num>s?(m(n,1),d?(n.dataList[0]=c.dataList[l-1],n.linkList[0]=u.linkList[u.num],c.dataList[l-1]=u.dataList[u.num-1]):(n.dataList[0]=u.dataList[u.num-1],c.dataList[l-1]=n.dataList[0]),n.linkList[0]&&(n.linkList[0].pNode=n),c.dataList[l-1]=u.dataList[u.num-1],u.dataList[u.num-1]=null,u.linkList[u.num]=null,u.num--,n.num++):h&&h.num>s?(d?(n.dataList[n.num]=c.dataList[l],n.linkList[n.num+1]=h.linkList[0],c.dataList[l]=h.dataList[0]):(n.dataList[n.num]=h.dataList[0],c.dataList[l]=h.dataList[1]),n.linkList[n.num+1]&&(n.linkList[n.num+1].pNode=n),p(h,1),h.num--,n.num++):h?f(n.pNode,l,n,h):u&&f(n.pNode,l-1,u,n)}return i;function f(e,i,s,o){var r=s.linkList[0]?1:0;m(o,s.num+r);for(var a=0;a<s.num;a++)o.dataList[a]=s.dataList[a],o.linkList[a+1]=s.linkList[a+1],o.linkList[a+1]&&(o.linkList[a+1].pNode=o);o.linkList[0]=s.linkList[0],o.linkList[0]&&(o.linkList[0].pNode=o),r&&(o.dataList[s.num]=e.dataList[i]),p(e,1,i),o.num+=s.num+r,e.num--,r||(t.head===s?(t.head=o,t.head.prev=null):(s.prev.next=o,o.prev=s.prev)),e.num?n=e:(t.root=o,t.root.pNode=null,n=null)}function m(e,t){for(var n=e.num-1;n>=0;n--)e.dataList[t+n]=e.dataList[n],e.linkList[t+n+1]=e.linkList[n+1];e.linkList[t]=e.linkList[0]}function p(e,t,n){n=n||0;for(var i=n;i<e.num;i++)e.dataList[i]=e.dataList[i+t],e.linkList[i]=e.linkList[i+t];e.linkList[e.num]=e.linkList[e.num+t]}}},{key:"search",value:function(e,t,n){var i=this._search(e,n,t);return i&&(i=this.iterator(i,e,t)),i}},{key:"findIndex",value:function(e,t){for(var n=0;n<e.num;n++)if(0===this.compare(t,e.dataList[n]))return n;return-1}},{key:"iterator",value:function(e,t,n){var i=e.num,s=e.num,o=e.num;n=n||this.compare;for(var r=0;r<e.num;r++){var a=e.dataList[r],c=n(t,a);if(c<=0){s=r,i=r;break}}return{next:l,prev:u,reset:function(){i=s,e=o}};function l(){return i<e.num?e.dataList[i++]:e.next?(e=e.next,i=0,e.dataList[i]):null}function u(){return i--,i>=0?e.dataList[i]:e.prev?(e=e.prev,i=e.num-1,e.dataList[i]):(i++,null)}}},{key:"forEach",value:function(e){for(var t=this.toArray(),n=0;n<t.length;n++)e(t[n],n)}},{key:"toArray",value:function(){if(this.arrayCache)return this.arrayCache;var e=[],t=this.head;while(t){for(var n=t.dataList,i=0;i<t.num;i++)e.push(n[i]);t=t.next}return this.arrayCache=e,e}},{key:"get",value:function(e){var t=this.head,n=-1;while(t){for(var i=t.dataList,s=0;s<t.num;s++)if(n++,n==e)return i[s];t=t.next}return null}},{key:"empty",value:function(){this.root=null,this.head=null,this.size=0,this.arrayCache=null}},{key:"_search",value:function(e,t,n){var i=this.root;n=n||this.compare;while(i)for(var s=i.linkList,o=i.dataList,r=0;r<i.num;r++){var a=n(e,o[r]);if(0===a){if(s[r+1]){i=s[r+1];break}return i}if(!(a>0)){if(s[r]){i=s[r];break}return t?i:null}if(!o[r+1]||n(e,o[r+1])<0){if(s[r+1]){i=s[r+1];break}return t?i:null}}}}]),e}(),xe=ke,be=function(e,t){return e.start.line-t.start.line},we=["br","hr","area","base","img","input","link","meta","basefont","param","col","frame","embed","keygen","source"],Te={};we.forEach((function(e){Te[e]=!0}));var Le=function(){function e(t,n){(0,B.Z)(this,e),this.folds=new xe(be),this.editorFunObj={},this.initProperties(t,n)}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this.editorFunObj,e,["unFold"]),Z.defineProperties(this,e,["selecter"]),Z.defineProperties(this,t,["htmls"])}},{key:"onInsertContentAfter",value:function(e,t){for(var n=this.folds.toArray(),i=1/0,s=0;s<n.length;s++){var o=n[s];if(!(o.start.line<e.line)){i=s;break}o.end.line>e.line&&this.editorFunObj.unFold(o.start.line)}if(t.line>e.line){n[i]&&n[i].start.line===e.line&&(this.editorFunObj.unFold(e.line),i++);for(var r=i;r<n.length;r++)n[r].start.line+=t.line-e.line,n[r].end.line+=t.line-e.line}}},{key:"onDeleteContentAfter",value:function(e,t){for(var n=this.folds.toArray(),i=1/0,s=0;s<n.length;s++){var o=n[s],r=o.start.line,a=o.end.line;if(!(r<=e.line)){i=s;break}r<e.line?(r>=t.line&&r<e.line||r<t.line&&a>t.line)&&this.editorFunObj.unFold(r):e.line>t.line&&this.editorFunObj.unFold(r)}if(e.line>t.line)for(var c=i;c<n.length;c++)n[c].start.line+=t.line-e.line,n[c].end.line+=t.line-e.line}},{key:"foldLine",value:function(e){var t=this.getRangeFold(e);if(t){for(var n=t.start.line+1;n<t.end.line;n++){var i=this.getFoldByLine(n);i&&i.end.line>t.end.line&&this.editorFunObj.unFold(n)}this.folds.insert(t)}return t}},{key:"unFold",value:function(e){var t=this.getFoldByLine(e);return t&&this.folds.delete(t),t}},{key:"getFoldByLine",value:function(e){var t=this.folds.search(e,(function(e,t){return e-t.start.line}));return t&&t.next()}},{key:"getLineInFold",value:function(e){var t=this.folds.search(e,(function(e,t){return e-t.start.line}),!0);if(t){var n=t.prev();if(n&&n.start.line<e&&n.end.line>e)return!0}return!1}},{key:"getRangeFold",value:function(e,t){var n=[],i=e,s=this.htmls[i-1],o=null;if(s.folds&&s.folds.length)for(var r=0;r<s.folds.length;r++){var a=s.folds[r];if(a.side<=0)n.push(a);else if(a.side>0)for(var c=n.length-1;c>=0;c--)if(n[c].side+a.side===0){n.splice(c,1);break}}if(n.length){var l="";if(o=n.peek(),o=Object.assign({line:i},o),l=s.text.slice(o.startIndex,o.endIndex),Te[l])return!1;if(o.type===Z.constData.LINE_COMMENT){var u=i,h=null;e=i+1;while(e<=this.htmls.length){var d=this.htmls[e-1],f=d.text.trimLeft(),m=d.text.length-f.length,p=d.folds&&d.folds[0];if(!p||p.type!==Z.constData.LINE_COMMENT||p.startIndex!==m)break;if(u=e,h=p,t&&u-i>1)return!0;e++}return t?u-i>1:{start:o,end:Object.assign({line:u},h)}}return this.getRangeFoldByStartFold(o,t)}return!1}},{key:"getRangeFoldByStartFold",value:function(e,t){var n=e.line,i=[],s=null;while(n<=this.htmls.length&&(!t||n-e.line<=1)){var o=this.htmls[n-1];if(o.folds&&o.folds.length)for(var r=0;r<o.folds.length;r++){var a=o.folds[r];if(!(n===e.line&&a.startIndex<=e.startIndex))if(a.side===e.side)i.push(a);else if(e.side+a.side===0){if(0===i.length)return s={start:e,end:Object.assign({line:n},a)},t?n-e.line>1:s;i.pop()}}n++}return t?n-e.line>1:s}},{key:"getBracketMatch",value:function(e){var t=e.line,n=null,i=[];e:while(t>=1&&!n){for(var s=this.htmls[t-1].folds||[],o=s.length-1;o>=0;o--){var r=s[o];if(r.type!==Z.constData.TAG)if(r.side>0&&(t<e.line||r.endIndex<e.column))i.push(r);else if(r.side<0&&(t<e.line||r.startIndex<=e.column)){var a=!1;if(i.length)for(var c=i.length-1;c>=0;c--)if(i[c].side+r.side===0){i.splice(c,1),a=!0;break}if(!a){n=Object.assign({line:t},r);break e}}}t--}if(n)return this.getRangeFoldByStartFold(n)}},{key:"getRealLine",value:function(e){var t=0,n=1,i=1,s=this.folds.toArray();while(t<s.length&&n<e){var o=s[t];if(!(n+o.start.line-i<e))break;n+=o.start.line+1-i,i=o.end.line,t++;while(t<s.length&&s[t].end.line<=o.end.line)t++}return i+=e-n,i}},{key:"getRelativeLine",value:function(e){var t=e,n=0,i=this.folds.toArray();while(n<i.length){var s=i[n];if(!(e>=s.end.line))break;t-=s.end.line-s.start.line-1,n++;while(n<i.length&&i[n].end.line<=s.end.line)n++}return t}}]),e}(),Pe=function(){function e(t,n,i){(0,B.Z)(this,e),this.selecter=i,this.initProperties(t,n),this.wordPattern=Z.getWordPattern(this.language),this.wholeWordPattern=new RegExp("^(".concat(this.wordPattern.source,")$")),this.wordPattern=new RegExp(this.wordPattern.source,"g")}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this,e,["language","fSearcher","searcher","nowCursorPos","cursor","$nextTick","$refs"]),Z.defineProperties(this,t,["htmls","getRangeText","getAllText"])}},{key:"search",value:function(e){var t=null,n=0,i=0,s=this.hasCache(),o=null;if(e=e||{},s)t=this.getFromCache(e.direct,e.increase);else{if(o=e&&e.config||this.getSearchConfig(),!o||!o.text)return{now:0,count:0};t=this._search(o)}return t&&t.result&&(this.searcher===this||e.increase?s?(this.cursor.addCursorPos(t.result.end),this.selecter.addActive(t.result.end)):(0===this.selecter.activedRanges.size?this.cursor.setCursorPos(t.result.end):this.initIndexs(),this.selecter.addRange(t.results)):s?(this.selecter.setActive(t.result.end),this.cursor.setCursorPos(t.result.end),this.searcher.clearSearch()):(this.selecter.addRange(t.results),this.clearActive()),n=t.now,i=t.results.length),{now:n,count:i}}},{key:"_search",value:function(e){var t=this,n=null,i=null,s=null,o=null,r=null,a=[],c={},l=null,u=1,h=0,d=0,f=this.getAllText(),m=e.text.split(/\n/),p=e.text.replace(/\\|\.|\*|\+|\-|\?|\(|\)|\[|\]|\{|\}|\^|\$|\~|\!|\&|\|/g,"\\$&");this.wholeWordPattern.test(e.text)&&e.wholeWord&&(p="(?:\\b|(?<=[^0-9a-zA-Z]))"+p+"(?:\\b|(?=[^0-9a-zA-Z]))"),n=new RegExp("[^\n]*?("+p+")|[^\n]*?\n",e.ignoreCase?"img":"mg"),e=e||{};while(i=n.exec(f))i[1]?(s={line:u,column:h+i[0].length-i[1].length},o={line:u+m.length-1,column:m.length>1?m.peek().length:h+i[0].length},u=o.line,h=o.column,l={start:s,end:o},a.push(l),!r&&Z.comparePos(o,t.nowCursorPos)>=0&&(r=l,d=a.length-1,c[a.length-1]=!0)):(u++,h=0);return a.length?(!r&&a.length&&(d=0,r=a[0]),this.cacheData={config:e,results:a,indexs:c,index:d},{now:this.cacheData.index+1,results:a,result:r}):null}},{key:"initIndexs",value:function(){var e=this,t=this.selecter.activedRanges.toArray();this.cacheData.indexs={},t.forEach((function(t){for(var n=0;n<e.cacheData.results.length;n++){var i=e.cacheData.results[n];if(0===Z.comparePos(t.start,i.start)){e.cacheData.index=n,e.cacheData.indexs[n]=!0;break}}}))}},{key:"refreshSearch",value:function(e){var t=this;if(this.hasCache()||e)return new Promise((function(n){var i=t.refreshSearch.id+1||1;t.refreshSearch.id=i,t.$nextTick((function(){t.refreshSearch.id===i&&((t.hasCache()||e)&&(e=e||t.cacheData.config,t.clearSearch(),t.search({config:e})),n())}))}))}},{key:"hasCache",value:function(){return!!this.cacheData}},{key:"clearSearch",value:function(e){e?this.selecter.clearInactiveRange():this.selecter.clearRange(),this.cacheData=null}},{key:"clearActive",value:function(){this.cacheData&&(this.cacheData.index=-1,this.cacheData.indexs={},this.selecter.clearActive())}},{key:"setPrevActive",value:function(e){var t=this.cacheData.results,n=this.cacheData.index;this.cacheData.index=t.length-1;for(var i=t.length-1;i>=0;i--){var s=t[i],o=Z.comparePos(s.end,e);if(o<0||-1===n&&0===o){this.cacheData.index=i;break}}}},{key:"setNextActive",value:function(e){var t=this.cacheData.results,n=this.cacheData.index;this.cacheData.index=0;for(var i=0;i<t.length;i++){var s=t[i],o=Z.comparePos(s.end,e);if(o>0||-1===n&&0===o){this.cacheData.index=i;break}}}},{key:"removeNow",value:function(){this.cacheData.results.splice(this.cacheData.index,1),this.cacheData.index--}},{key:"clone",value:function(e){this.cacheData=e,e&&this.selecter.addRange(e.results)}},{key:"getCacheData",value:function(){return this.cacheData}},{key:"getNowRange",value:function(){return this.cacheData.results[this.cacheData.index]}},{key:"getFromCache",value:function(e,t){var n=this.cacheData.results,i=null,s=0;if(this.fSearcher!==this||t){var o=this.cacheData.indexs,r=0;r="up"===e?-1:1,s=this.cacheData.index+r,s==n.length?s=0:s<0&&(s=n.length-1),o[s]?s=this.cacheData.index:(i=n[s],o[s]=!0,this.cacheData.index=s)}else"up"===e?this.setPrevActive(this.nowCursorPos):this.setNextActive(this.nowCursorPos),s=this.cacheData.index,i=this.cacheData.results[s],this.cacheData.indexs={i:!0};return{now:s+1,result:i,results:n}}},{key:"getConfig",value:function(){if(this.cacheData)return Object.assign({},this.cacheData.config)}},{key:"getSearchConfig",value:function(){var e=null,t=!1,n="",i=this.searcher.selecter.getRangeByCursorPos(this.nowCursorPos);return this.searcher===this&&this.selecter.ranges.size>0?null:(i?n=this.getRangeText(i.start,i.end):(n=this.getNowWord().text,t=!0),n&&(e={text:n,wholeWord:t,ignoreCase:t}),e)}},{key:"getNowWord",value:function(){var e=this.htmls[this.nowCursorPos.line-1].text,t="",n=this.nowCursorPos.column,i=n,s=n,o=null;while(o=this.wordPattern.exec(e)){if(o.index<=n&&o.index+o[0].length>=n){i=o.index,s=o.index+o[0].length,t=o[0];break}if(o.index>n)break}return this.wordPattern.lastIndex=0,{text:t,range:{start:{line:this.nowCursorPos.line,column:i},end:{line:this.nowCursorPos.line,column:s}}}}}]),e}(),Ee=function(e,t){var n=Z.comparePos(e.start,t.start);return 0===n?Z.comparePos(e.end,t.end):n},Se=function(){function e(t,n){(0,B.Z)(this,e),this.initProperties(t,n),this.ranges=new xe(Ee),this.activedRanges=new xe(Ee)}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this,e,["cursor","renderSelectedBg","clearSelectionToken"]),Z.defineProperties(this,t,["htmls"]),this.setContextData=function(e,n){t.setData(e,n)},this.setEditorData=function(t,n){e.setData(t,n)}}},{key:"getRange",value:function(e){var t=this.ranges.search(e);return t&&t.next()}},{key:"getRangeByLine",value:function(e){var t=[],n=this.ranges.search({line:e,column:0},(function(e,t){return e-t.start.line}),!0);if(n){var i=n.next();while(i){if(i.start===e||i.end.line===e)t.push(i);else if(i.start.line>e)break;i=n.next()}}return t}},{key:"getRangeByCursorPos",value:function(e){var t=this.ranges.search(e,(function(e,t){return 0===Z.comparePos(e,t.start)||0===Z.comparePos(e,t.end)?0:Z.comparePos(e,t.start)}));return t&&t.next()}},{key:"getRangeWithCursorPos",value:function(e){var t=this.ranges.search(e,(function(e,t){return Z.comparePos(e,t.start)}),!0);if(t){var n=t.prev();if(n&&Z.comparePos(n.end,e)>=0)return n;if(t.reset(),n=t.next(),n&&0==Z.comparePos(n.start,e))return n}return!1}},{key:"select",value:function(e,t){var n=this;this.cursor.multiCursorPos.forEach((function(i){var s=n.getRangeByCursorPos(i);if(s){var o=s.start,r=s.end;n.cursor.moveCursor(i,e,t),"left"===e?Z.comparePos(i,s.start)<0?o=i:r=i:Z.comparePos(i,s.end)>0?r=i:o=i,n.updateRange(s,{start:o,end:r})}else{var a=Object.assign({},i),c=n.cursor.moveCursor(i,e,t);s=n.createRange(a,c),s&&n.addRange({start:a,end:c})}})),this.renderSelectedBg()}},{key:"selectAll",value:function(){var e={line:this.htmls.length,column:this.htmls.peek().text.length};this.setEditorData("forceCursorView",!1),this.cursor.setCursorPos(e),this.setRange({line:1,column:0},e),this.renderSelectedBg()}},{key:"selectAllOccurence",value:function(){var e=this;this.cursor.clearCursorPos(),this.ranges.forEach((function(t){e.cursor.addCursorPos(t.end),t.active||(t.active=!0,e.activedRanges.insert(t))})),this.renderSelectedBg()}},{key:"addActive",value:function(e){var t=this.getRangeByCursorPos(e);t&&!t.active&&(t.active=!0,this.activedRanges.insert(t)),this.renderSelectedBg()}},{key:"addRange",value:function(e){var t=this,n=[],i=e instanceof Array?e:[e];return i.forEach((function(e){var i=e.start,s=e.end,o=Z.comparePos(i,s);if(o>0){var r=i;i=s,s=r}else if(!o)return;var a=t.cursor.getCursorsByLineColumn(i.line,i.column)||t.cursor.getCursorsByLineColumn(s.line,s.column);e={start:{line:i.line,column:i.column},end:{line:s.line,column:s.column},active:!!a};var c=t.getRange(e);c?(c.active||(c.active=a,t.activedRanges.insert(c)),n.push(c)):(t.ranges.insert(e),a&&t.activedRanges.insert(e),n.push(e),t.filterRange(e))})),this.renderSelectedBg(),e instanceof Array?n:n[0]}},{key:"removeRange",value:function(e){e=this.ranges.delete(e),e&&(e.active&&this.activedRanges.delete(e),this.cursor.removeCursor(e.start),this.cursor.removeCursor(e.end),this.renderSelectedBg())}},{key:"setRange",value:function(e,t){var n=Z.comparePos(e,t);if(n>0){var i=e;e=t,t=i}else if(!n)return;var s=this.cursor.getCursorsByLineColumn(e.line,e.column)||this.cursor.getCursorsByLineColumn(t.line,t.column),o={start:Object.assign({},e),end:Object.assign({},t),active:!!s};return this.clearRange(),this.ranges.insert(o),s&&this.activedRanges.insert(o),this.renderSelectedBg(),o}},{key:"setActive",value:function(e){var t=this.getRangeByCursorPos(e);this.activedRanges.forEach((function(e){e.active=!1})),this.activedRanges.empty(),t&&(t.active=!0,this.activedRanges.insert(t)),this.renderSelectedBg()}},{key:"updateRange",value:function(e,t){var n=t.start,i=t.end,s=Z.comparePos(n,i);if(s>0){var o=n;n=i,i=o}else if(!s)return!1;this.ranges.delete(e),e.start.line=n.line,e.start.column=n.column,e.end.line=i.line,e.end.column=i.column,this.ranges.insert(e),this.filterRange(e),this.renderSelectedBg()}},{key:"filterRange",value:function(e){var t=this,n=this.ranges.search(e),i=[],s=n.prev();s&&Z.comparePos(s.end,e.start)>0&&i.push(s),n.reset(),n.next(),s=n.next(),s&&Z.comparePos(e.end,s.start)>0&&i.push(s),i.forEach((function(e){t.ranges.delete(e),t.activedRanges.delete(e),t.cursor.removeCursor(e.start),t.cursor.removeCursor(e.end)}))}},{key:"createRange",value:function(e,t){var n=Z.comparePos(e,t);if(n>0){var i=e;e=t,t=i}return 0===n?null:{start:e,end:t}}},{key:"clearRange",value:function(){this.ranges.empty(),this.activedRanges.empty(),this.renderSelectedBg()}},{key:"clearActive",value:function(){this.activedRanges.forEach((function(e){e.active=!1})),this.activedRanges.empty(),this.renderSelectedBg()}},{key:"clearInactiveRange",value:function(){var e=this;this.activedRanges.size?(this.ranges.forEach((function(t){t.active||e.ranges.delete(t)})),this.renderSelectedBg()):this.clearRange()}},{key:"clone",value:function(e,t){t=t||[];var n={start:Object.assign({},e.start),end:Object.assign({},e.end)};return t.forEach((function(t){n[t]=e[t]})),n}}]),e}(),_e={word:/[a-zA-Z0-9_]/,dWord:Z.fullAngleReg,space:/\s/},Ie=function(){function e(t,n){(0,B.Z)(this,e),this.initProperties(t,n),this.multiCursorPos=new xe(Z.comparePos),this.multiKeyCode="ctrl",this.wordPattern=Z.getWordPattern(this.language),this.rightWrodPattern=new RegExp("^(".concat(this.wordPattern.source,")")),this.leftWrodPattern=new RegExp("(".concat(this.wordPattern.source,")$"))}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this,e,["language","nowCursorPos","searcher","selecter","setNowCursorPos","renderCursor","getColumnByWidth","getStrWidth"]),Z.defineProperties(this,t,["htmls"])}},{key:"addCursorPos",value:function(e){var t=this.getCursorsByLineColumn(e.line,e.column);return t?(this.setNowCursorPos(t),t):(e={line:e.line,column:e.column},this.multiCursorPos.insert(e),this.setNowCursorPos(e),e)}},{key:"addCursorAbove",value:function(){var e=this;this.multiCursorPos.forEach((function(t){if(t.line>1){var n=t.moveWidth||e.getStrWidth(e.htmls[t.line-1].text,0,t.column),i=e.getColumnByWidth(e.htmls[t.line-2].text,n),s=e.addCursorPos({line:t.line-1,column:i});s.moveWidth=n,e.setNowCursorPos(s)}}))}},{key:"addCursorBelow",value:function(){var e=this;this.multiCursorPos.forEach((function(t){if(t.line<e.htmls.length){var n=t.moveWidth||e.getStrWidth(e.htmls[t.line-1].text,0,t.column),i=e.getColumnByWidth(e.htmls[t.line].text,n),s=e.addCursorPos({line:t.line+1,column:i});s.moveWidth=n,e.setNowCursorPos(s)}}))}},{key:"addCursorLineEnds",value:function(){var e=this;this.selecter.activedRanges.size&&(this.clearCursorPos(),this.selecter.activedRanges.forEach((function(t){var n=t.start.line,i=t.end.line;while(n<i)e.addCursorPos({line:n,column:e.htmls[n-1].text.length}),n++;e.setNowCursorPos(e.addCursorPos({line:i,column:e.htmls[i-1].text.length}))})),this.searcher.clearSearch())}},{key:"setCursorPos",value:function(e){if(e={line:e.line,column:e.column},1==this.multiCursorPos.size){var t=this.multiCursorPos.get(0);if(0===Z.comparePos(t,e))return t}return this.multiCursorPos.empty(),this.multiCursorPos.insert(e),this.setNowCursorPos(e),e}},{key:"updateCursorPos",value:function(e,t,n){var i=this.getCursorsByLineColumn(e.line,e.column);return i===e&&this.multiCursorPos.delete(e),e.line=t,e.column=n,this.multiCursorPos.insert(e),e===this.nowCursorPos?this.setNowCursorPos(this.nowCursorPos):this.renderCursor(),e}},{key:"removeCursor",value:function(e){e=this.getCursorsByLineColumn(e.line,e.column),e&&(e.del=!0,this.multiCursorPos.delete(e),e===this.nowCursorPos&&this.setNowCursorPos(null),this.renderCursor())}},{key:"removeCursorInRange",value:function(e){var t=this,n=this.multiCursorPos.search(e.start,null,!0);if(n){var i=null,s=[];while(i=n.next()){var o=Z.comparePos(i,e.end);if(o>=0)break;Z.comparePos(i,e.start)>0&&s.push(i)}s.forEach((function(e){e.del=!0,t.multiCursorPos.delete(e)})),this.renderCursor()}}},{key:"clearCursorPos",value:function(){this.multiCursorPos.forEach((function(e){e.del=!0})),this.multiCursorPos.empty(),this.setNowCursorPos(null)}},{key:"getCursorsByLine",value:function(e){var t=[],n=null,i=this.multiCursorPos.search({line:e,column:0},null,!0);if(i)while(n=i.next())if(n.line===e)t.push(n);else if(n.line>e)break;return t}},{key:"getCursorsByLineColumn",value:function(e,t){var n=this.multiCursorPos.search({line:e,column:t});return n&&n.next()}},{key:"moveCursor",value:function(e,t,n){var i=this.htmls[e.line-1].text,s=e.line,o=e.column;if("up"!==t&&"down"!==t&&(e.moveWidth=0),"home"===t)o=0;else if("end"===t)o=this.htmls[s-1].text.length;else if("up"===t){if(s>1){var r=e.moveWidth||this.getStrWidth(i,0,o);e.moveWidth=r,s--,i=this.htmls[s-1].text,o=this.getColumnByWidth(i,r)}}else if("down"===t){if(s<this.htmls.length){var a=e.moveWidth||this.getStrWidth(i,0,o);e.moveWidth=a,s++,i=this.htmls[s-1].text,o=this.getColumnByWidth(i,a)}}else if("left"===t){while(0===o&&s>1)s--,i=this.htmls[s-1].text,o=i.length;if(o>0)if(n){while(o&&i[o-1].match(_e.space))o--;if(o>0){var c=null,l=o;o--,i=i.slice(0,l),c=this.leftWrodPattern.exec(i),c&&(o=c.index)}}else e.line===s&&o--}else{while(o===i.length&&s<this.htmls.length)s++,o=0,i=this.htmls[s-1].text;if(o<i.length)if(n){while(o<i.length&&i[o].match(_e.space))o++;o<i.length&&(i=i.slice(o),i=this.rightWrodPattern.exec(i),i&&0==i.index?o+=i[0].length:o++)}else e.line===s&&o++}return this.updateCursorPos(e,s,o),{line:s,column:o}}},{key:"switchMultiKeyCode",value:function(){this.multiKeyCode="ctrl"===this.multiKeyCode?"alt":"ctrl"}}]),e}(),Me=function(){function e(t,n){(0,B.Z)(this,e),this.history=[],this.initProperties(t,n)}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this,e,["cursor"]),Z.defineProperties(this,t,["insertContent","deleteContent","moveLineUp","moveLineDown","copyLineUp","copyLineDown","deleteCopyLineUp","deleteCopyLineDown","insertLine","deleteLine","replace"])}},{key:"undo",value:function(){if(this.history.index>0){var e=this.history[this.history.index-1];if(this.doCommand(e),this.history.index--,e.serial){var t=this.history[this.history.index-1];t&&t.serial===e.serial&&this.undo()}}}},{key:"redo",value:function(){if(this.history.index<this.history.length){var e=this.history[this.history.index];if(this.history.index++,this.doCommand(e),e.serial){var t=this.history[this.history.index];t&&t.serial===e.serial&&this.redo()}}}},{key:"doCommand",value:function(e){var t=e.type||(e instanceof Array?e[0].type:e.type);switch(t){case Z.command.DELETE:this.cursor.clearCursorPos(),this.deleteContent(Z.keyCode.BACKSPACE,e);break;case Z.command.INSERT:if(this.cursor.clearCursorPos(),e instanceof Array){var n=[];e.forEach((function(e){n.push(e.text)})),this.insertContent(n,e)}else this.insertContent(e.text,e);break;case Z.command.DELETE_LINE:this.cursor.clearCursorPos(),this.deleteLine(e);break;case Z.command.INSERT_LINE:this.cursor.clearCursorPos(),this.insertLine(e);break;case Z.command.MOVEUP:this.cursor.clearCursorPos(),this.moveLineUp(e);break;case Z.command.MOVEDOWN:this.cursor.clearCursorPos(),this.moveLineDown(e);break;case Z.command.COPY_DOWN:this.cursor.clearCursorPos(),this.copyLineDown(e);break;case Z.command.DELETE_COPY_DOWN:this.cursor.clearCursorPos(),this.deleteCopyLineDown(e);break;case Z.command.COPY_UP:this.cursor.clearCursorPos(),this.copyLineUp(e);break;case Z.command.DELETE_COPY_UP:this.cursor.clearCursorPos(),this.deleteCopyLineUp(e);break;case Z.command.REPLACE:this.cursor.clearCursorPos(),this.replace(e.text,e.cursorPos,e);break}}},{key:"pushHistory",value:function(e){while(this.history.length>this.history.index)this.history.pop();var t=this,n=this.history[this.history.index-1];if(e=this.sortComand(e),n instanceof Array&&e instanceof Array&&n.length===e.length&&Date.now()-this.pushHistoryTime<2e3)if(s(n)&&s(e)&&o(n[0],e[0]))for(var i=0;i<n.length;i++)r(n[i],e[i]);else this.history.push(e);else o(n,e)?r(n,e):this.history.push(e);function s(e){for(var t=1;t<e.length;t++)if(e[t].type!==e[t-1].type)return!1;return!0}function o(e,n){if((n.type==Z.command.DELETE||n.type==Z.command.INSERT)&&e&&e.type==n.type&&e.preCursorPos.line==n.cursorPos.line&&Date.now()-t.pushHistoryTime<2e3){if(e.type==Z.command.DELETE&&0==Z.comparePos(e.cursorPos,n.preCursorPos))return!0;if(e.type==Z.command.INSERT&&(0==Z.comparePos(e.cursorPos,n.preCursorPos)||0==Z.comparePos(e.cursorPos,n.cursorPos)))return!0}}function r(e,t){e.type===Z.command.DELETE?(t.preCursorPos.column-=e.cursorPos.column-e.preCursorPos.column,e.preCursorPos=t.preCursorPos,e.cursorPos=t.cursorPos):(e.cursorPos=t.cursorPos,t.keyCode===Z.keyCode.DELETE?e.text=e.text+t.text:e.text=t.text+e.text)}this.history.index=this.history.length,this.pushHistoryTime=Date.now()}},{key:"updateHistory",value:function(e){var t=this,n=this.history.index;e instanceof Array?e.forEach((function(e,i){e.keyCode=t.history[n-1][i].keyCode})):e.keyCode=this.history[n-1].keyCode,this.history[n-1]=this.sortComand(e)}},{key:"sortComand",value:function(e){return e instanceof Array&&e.sort((function(e,t){return e=e.cursorPos,t=t.cursorPos,e.line===t.line?e.column-t.column:e.line-t.line})),e}}]),e}(),Be=(n(2455),{word:/[a-zA-Z0-9_]/,emmetWord:/^[a-zA-Z][a-zA-Z0-9\-]*/,emmetAttr:/^[\.\#]([^\.\#\>\<\+\*\(\)]*)/,emmetNum:/^\*(\d+)/,dWord:Z.fullAngleReg,endTag:/(?=\<\/)/,space:/\s/}),De=function(){function e(t){(0,B.Z)(this,e),this.lineId=Number.MIN_SAFE_INTEGER,this.serial=1,this.htmls=[],this.fgLines=[],this.lineIdMap=new Map,this.renderedIdMap=new Map,this.renderedLineMap=new Map,this.initProperties(t),this.initData()}return(0,D.Z)(e,[{key:"initProperties",value:function(e){Z.defineProperties(this,e,["language","tabSize","nowCursorPos","maxLine","maxWidthObj","cursor","history","tokenizer","lint","folder","selecter","searcher","fSelecter","fSearcher","autocomplete","render","unFold","setNowCursorPos","setErrors","setAutoTip","getStrWidth","$emit"]),this.setEditorData=function(t,n){e.setData(t,n)}}},{key:"initData",value:function(){this.htmls.push({lineId:this.lineId++,text:"",html:"",width:0,tokens:[],folds:[],states:[],stateFold:null}),this.lineIdMap.set(this.htmls[0].lineId,this.htmls[0])}},{key:"setData",value:function(e,t){"function"!==typeof this[e]&&(this[e]=t)}},{key:"insertContent",value:function(e,t){var n=null,i=[],s=!1;if(t)t.forEach((function(e){i.push(e.cursorPos)}));else{if(this.selecter.activedRanges.size){var o=this.deleteContent();o.serial=this.serial++,s=o.serial}i=this.cursor.multiCursorPos.toArray()}return n=this._insertMultiContent(e,i,t),n.serial=s,t?(this.history.updateHistory(n),n.serial=t.serial):this.history.pushHistory(n),this.setNowCursorPos(this.cursor.multiCursorPos.get(0)),this.fSearcher.refreshSearch(),n}},{key:"_insertMultiContent",value:function(e,t,n){var i=this,s=null,o=null,r=[],a=e instanceof Array?e:e.split(/\r\n|\n/),c=0,l=0;return this.cursor.clearCursorPos(),"\n"===e&&(a=["\n"]),t.forEach((function(u,h){var d=a.length===t.length?a[h]:e,f=n&&n[h]||{},m=f.margin||"right",p=f.active||!1,g={line:u.line,column:u.column};g.line+=c,s&&g.line===s.line?g.column+=l:l=0,o=i._insertContent(d,g,!n),r.push(o),s=o.cursorPos,o.margin=m,o.active=p,c+=o.cursorPos.line-o.preCursorPos.line,l+=o.cursorPos.column-o.preCursorPos.column,"right"===m?i.cursor.addCursorPos(o.cursorPos):i.cursor.addCursorPos(o.preCursorPos),p&&i.selecter.addRange({start:o.preCursorPos,end:o.cursorPos})})),r}},{key:"_insertContent",value:function(e,t,n){var i=this,s=this.htmls[t.line-1],o=s.text,r=Object.assign({},t);if(t.moveWidth=0,e=e.split(/\r\n|\n/),e=e.map((function(e){return e={lineId:i.lineId++,text:e,html:"",width:0,tokens:null,folds:null,states:null,stateFold:null},i.lineIdMap.set(e.lineId,e),e})),e.length>1){if(!e[0].text&&n){var a=l.call(this,o,this.folder.getRangeFold(t.line,!0));a&&(e[1].text=a+e[1].text.trimLeft())}r.column=e[e.length-1].text.length,e[0].text=o.slice(0,t.column)+e[0].text,e[e.length-1].text=e[e.length-1].text+o.slice(t.column),this.htmls=this.htmls.slice(0,t.line-1).concat(e).concat(this.htmls.slice(t.line))}else r.column+=e[0].text.length,e[0].text=o.slice(0,t.column)+e[0].text+o.slice(t.column),this.htmls.splice(t.line-1,1,e[0]);r.line+=e.length-1,this.setEditorData("maxLine",this.htmls.length),this.lint.onInsertContentAfter(t.line,r.line),this.tokenizer.onInsertContentAfter(t.line,r.line),this.folder.onInsertContentAfter(Object.assign({},t),Object.assign({},r)),this.setLineWidth(e),this.setErrors([]),this.setAutoTip(null),this.render(!0),this.$emit("change");var c={type:Z.command.DELETE,cursorPos:Object.assign({},r),preCursorPos:Object.assign({},t)};return c;function l(e,t){var n=0,i="",s=/^\s+/.exec(e);s&&(n=/\t+/.exec(s[0]),n=n&&n[0].length||0,n+=Math.ceil((s[0].length-n)/this.tabSize)),n+=t?1:0;for(var o=0;o<n;o++)i+="\t";return i}}},{key:"deleteContent",value:function(e,t){var n=this,i=[],s=[];return t?s=t.map((function(e){var t={start:e.preCursorPos,end:e.cursorPos,margin:e.margin,active:e.active};return t})):this.cursor.multiCursorPos.forEach((function(e){var t=n.selecter.getRangeByCursorPos(e);t?(0===Z.comparePos(t.start,e)?t.margin="left":t.margin="right",s.push(t)):s.push(e)})),i=this._deleteMultiContent(s,e),t?(i.serial=t.serial,this.history.updateHistory(i),i.forEach((function(e){n.cursor.addCursorPos(e.cursorPos)}))):i.length&&this.history.pushHistory(i),this.setNowCursorPos(this.cursor.multiCursorPos.get(0)),this.searcher.clearSearch(),this.fSearcher.refreshSearch(),i}},{key:"_deleteMultiContent",value:function(e,t){var n=this,i=[],s=null,o=null,r=0,a=0;return this.cursor.clearCursorPos(),e.forEach((function(e){e.start&&e.end?l(e):c(e)})),i;function c(e){var c={line:e.line,column:e.column};c.line-=r,o&&c.line===o.line?c.column-=a:a=0,s=n._deleteContent(c,t),s.text&&i.push(s),o=s.cursorPos,r+=s.preCursorPos.line-o.line,a+=s.preCursorPos.column-o.column,n.cursor.addCursorPos({line:o.line,column:o.column})}function l(e){var c=e.start,l=e.end;c.line-=r,l.line-=r,o&&c.line===o.line?(c.column-=a,c.line===l.line?l.column-=a:a=0):a=0,s=n._deleteContent(e,t),s.text&&i.push(s),o=s.cursorPos,r+=s.preCursorPos.line-o.line,a+=s.preCursorPos.column-o.column,n.cursor.addCursorPos({line:o.line,column:o.column})}}},{key:"_deleteContent",value:function(e,t){var n=this,i=null,s=t===Z.keyCode.DELETE?"left":"right";e.moveWidth=0,e.start&&e.end&&(i=e,e=i.end,s=i.margin);var o=null,r=this.htmls[e.line-1],a=r.text,c="",l=[r.lineId],u=Object.assign({},e),h=Object.assign({},e);if(i){var d=i.end,f=this.htmls[d.line-1];o=i.start,r=this.htmls[o.line-1],a=r.text,c=this.getRangeText(i.start,i.end),1==o.line&&d.line==this.maxLine?(l=[this.maxWidthObj.lineId],this.lineIdMap.clear()):l=this.htmls.slice(o.line-1,d.line).map((function(e){return n.lineIdMap.delete(e.lineId),e.lineId})),this.lineIdMap.set(r.lineId,r),o.line==d.line?(a=a.slice(0,o.column)+a.slice(d.column),r.text=a):(a=a.slice(0,o.column),r.text=a,a=f.text,a=a.slice(d.column),r.text+=a,this.htmls.splice(o.line,d.line-o.line)),h.line=o.line,h.column=o.column}else if(Z.keyCode.DELETE==t)e.column==a.length?e.line<this.htmls.length&&(this.lineIdMap.delete(this.htmls[e.line].lineId),a=r.text+this.htmls[e.line].text,this.htmls.splice(e.line,1),c="\n",u={line:e.line-1,column:0}):(c=a[e.column],a=a.slice(0,e.column)+a.slice(e.column+1),u={line:e.line,column:e.column+1}),r.text=a;else{if(0==e.column){if(e.line>1){var m=this.htmls[e.line-2].text.length;this.lineIdMap.delete(this.htmls[e.line-2].lineId),a=this.htmls[e.line-2].text+a,this.htmls.splice(e.line-2,1),c="\n",h.line=e.line-1,h.column=m}}else c=a[e.column-1],a=a.slice(0,e.column-1)+a.slice(e.column),h.column=e.column-1;r.text=a}r.width=this.getStrWidth(r.text),r.html="",r.tokens=null,r.folds=null,r.states=null,r.stateFold=null,this.setEditorData("maxLine",this.htmls.length),this.lint.onDeleteContentAfter(u.line,h.line),this.tokenizer.onDeleteContentAfter(u.line,h.line),this.folder.onDeleteContentAfter(Object.assign({},u),Object.assign({},h)),this.setErrors([]),this.setAutoTip(null),this.render(!0),this.$emit("change"),r.width>=this.maxWidthObj.width?this.setEditorData("maxWidthObj",{lineId:r.lineId,text:r.text,width:r.width}):l.indexOf(this.maxWidthObj.lineId)>-1&&this.setMaxWidth();var p={type:Z.command.INSERT,cursorPos:Object.assign({},h),preCursorPos:Object.assign({},u),text:c,keyCode:t,margin:s,active:i&&i.active};return p}},{key:"setMaxWidth",value:function(){var e=this,t=0,n=Date.now(),i={line:this.htmls[0].lineId,width:0};function s(){while(t<e.htmls.length){var o=e.htmls[t];if(o.width>i.width&&(i={lineId:o.lineId,text:o.text,width:o.width}),t++,Date.now()-n>20)break}t<e.htmls.length?e.setMaxWidthTimer=setTimeout((function(){s()}),20):e.setEditorData("maxWidthObj",i)}clearTimeout(this.setMaxWidthTimer),s()}},{key:"setLineWidth",value:function(e){var t=this,n=0,i=Date.now(),s=this.maxWidthObj;function o(){while(n<e.length){var r=e[n];if(t.lineIdMap.has(r.lineId)){var a=t.getStrWidth(r.text);r.width=a,a>s.width&&(s={lineId:r.lineId,text:r.text,width:a})}if(n++,Date.now()-i>20)break}n<e.length?t.setLineWidthTimer=setTimeout((function(){o()}),20):t.setEditorData("maxWidthObj",s)}clearTimeout(this.setLineWidthTimer),o()}},{key:"moveLineUp",value:function(e){this.moveLine(e,"up")}},{key:"moveLineDown",value:function(e){this.moveLine(e,"down")}},{key:"moveLine",value:function(e,t){var n=this,i=[],s=[],o=0,r=null,a=null;e?(a=e.searchConifg,i=e.cursorPos):(a=this.searcher.getConfig(),i=[],this.cursor.multiCursorPos.toArray().forEach((function(e){var s=n.selecter.getRangeByCursorPos(e),o=!0,a=s?s.start.line:e.line;if(r){var c=r.end?r.end.line:r.line;c+1!==a&&c!==a||(s&&n.selecter.removeRange(s),o=!1)}if(o){var l=s&&s.end.line||a;1===a&&"up"===t||l===n.maxLine&&"down"===t?o=!1:(s?(s.margin=0===Z.comparePos(s.start,e)?"left":"right",r=s):r=e,i.push(r))}})));while(o<i.length){var c=i[o],l=c.start?c:null;this._moveLine(c,t);var u="down"===t?1:-1;l?(l.start.line=l.start.line+u,l.end.line=l.end.line+u):c.line=c.line+u,s.push(l?this.selecter.clone(l,["margin"]):Object.assign({},c)),o++}if(s.length){this.searcher.clearSearch(),this.cursor.clearCursorPos(),s.forEach((function(e){e.start?(n.cursor.addCursorPos("left"===e.margin?e.start:e.end),n.selecter.addRange(e)):n.cursor.addCursorPos(e)}));var h={type:"down"===t?Z.command.MOVEUP:Z.command.MOVEDOWN,cursorPos:s,searchConifg:a};e?(this.history.updateHistory(h),this.searcher.refreshSearch(e.searchConifg)):(this.history.pushHistory(h),this.searcher.refreshSearch(a)),this.fSearcher.refreshSearch()}}},{key:"_moveLine",value:function(e,t){var n=e.start?e:null,i=0,s=0,o="";n?(o=this.htmls.slice(n.start.line-1,n.end.line).map((function(e){return e.text})).join("\n"),"down"===t?(i=n.start.line,s=n.end.line+1,o=this.htmls[s-1].text+"\n"+o):(i=n.start.line-1,s=n.end.line,o=o+"\n"+this.htmls[i-1].text)):(i=e.line-("down"===t?0:1),s=i+1,o=this.htmls[s-1].text+"\n"+this.htmls[i-1].text);var r={line:i,column:0},a={line:s,column:this.htmls[s-1].text.length};this._deleteContent({start:r,end:a}),this._insertContent(o,r)}},{key:"copyLineUp",value:function(e){this.copyLine(e,"up")}},{key:"copyLineDown",value:function(e){this.copyLine(e,"down")}},{key:"copyLine",value:function(e,t){var n=this,i=[],s=[],o=[],r=null,a=[],c=null;e?(c=e.searchConifg,i=e.cursorPos):(c=this.searcher.getConfig(),i=[],this.cursor.multiCursorPos.toArray().forEach((function(e){var t=n.selecter.getRangeByCursorPos(e),s=t&&t.start.line||e.line,o=!0;if(r){var a=r.end?r.end.line:r.line;a===s&&(o=!1)}o&&(t?(t.margin=0===Z.comparePos(t.start,e)?"left":"right",r=t):r=e,i.push(r))}))),i.forEach((function(e){var t=0,i="";e.end?(t=e.start.line-1,i=n.htmls.slice(e.start.line-1,e.end.line).map((function(e){return e.text})).join("\n")):(t=e.line-1,i=n.htmls[e.line-1].text),t=t<1?1:t,i="\n"+i,a.push(i),s.push({line:t,column:n.htmls[t-1].text.length})})),this._insertMultiContent(a,s).forEach((function(e,s){var r=0,a=i[s];if(r=e.cursorPos.line,"down"===t&&(r+=a.start?a.end.line-a.start.line+1:1),a.start){var c=a.end.line-a.start.line;a.end.line=r,a.start.line=r-c}else a.line=r;o.push(a.start?n.selecter.clone(a,["margin"]):Object.assign({},a))})),this.searcher.clearSearch(),this.cursor.clearCursorPos(),o.forEach((function(e){e.start?(n.cursor.addCursorPos("left"===e.margin?e.start:e.end),n.selecter.addRange(e)):n.cursor.addCursorPos(e)}));var l={type:"down"===t?Z.command.DELETE_COPY_DOWN:Z.command.DELETE_COPY_UP,cursorPos:o,searchConifg:c};e?(this.history.updateHistory(l),this.searcher.refreshSearch(e.searchConifg)):(this.history.pushHistory(l),this.searcher.refreshSearch(c)),this.fSearcher.refreshSearch()}},{key:"deleteCopyLineUp",value:function(e){this.deleteCopyLine(e,"up")}},{key:"deleteCopyLineDown",value:function(e){this.deleteCopyLine(e,"down")}},{key:"deleteCopyLine",value:function(e,t){var n=this,i=[],s=[],o=[];i=e.cursorPos,i.forEach((function(e){var t=0,i=0,o=null,r=0,a=0;e.end?(t=e.start.line-1,i=e.end.line):(t=e.line-1,i=e.line),a=n.htmls[i-1].text.length,t<1?(t=1,i<n.maxLine&&(i++,a=0)):r=n.htmls[t-1].text.length,o={start:{line:t,column:r},end:{line:i,column:a}},s.push(o)})),this._deleteMultiContent(s).forEach((function(e,s){var r=i[s];if(r.start){var a=r.end.line-r.start.line;"up"===t?(r.start.line=e.cursorPos.line+(1===r.start.line?0:1),r.end.line=r.start.line+a):(r.end.line=e.cursorPos.line,r.start.line=r.end.line-a)}else r.line="up"===t?e.cursorPos.line+(1===r.line?0:1):e.cursorPos.line;o.push(r.start?n.selecter.clone(r,["margin"]):Object.assign({},r))})),this.searcher.clearSearch(),this.cursor.clearCursorPos(),o.forEach((function(e){e.start?(n.cursor.addCursorPos("left"===e.margin?e.start:e.end),n.selecter.addRange(e)):n.cursor.addCursorPos(e)}));var r={type:"down"===t?Z.command.COPY_UP:Z.command.COPY_DOWN,cursorPos:o,searchConifg:e.searchConifg};this.history.updateHistory(r),this.searcher.refreshSearch(e.searchConifg),this.fSearcher.refreshSearch()}},{key:"insertLine",value:function(e){var t=this,n=e.searchConifg,i=e.cursorPos,s=e.text,o=[];i.forEach((function(e){var n=e.start?e.start.line-1:e.line-1;n=n<1?1:n,o.push({line:n,column:t.htmls[n-1].text.length})})),this._insertMultiContent(s,o),this.searcher.clearSearch(),this.cursor.clearCursorPos(),i.forEach((function(e){e.start?(t.cursor.addCursorPos("left"===e.margin?e.start:e.end),t.selecter.addRange(e)):t.cursor.addCursorPos(e)}));var r={type:Z.command.DELETE_LINE,cursorPos:i,searchConifg:n};this.history.updateHistory(r),this.searcher.refreshSearch(e.searchConifg),this.fSearcher.refreshSearch()}},{key:"deleteLine",value:function(e){var t=this,n=[],i=[],s=[],o=null,r=[],a=null;e?(a=e.searchConifg,n=e.cursorPos):(a=this.searcher.getConfig(),this.cursor.multiCursorPos.forEach((function(e){var i=t.selecter.getRangeByCursorPos(e),s=i&&i.start.line||e.line,r=!0;if(o){var a=o.end?o.end.line:o.line;a===s&&(r=!1)}r&&(i?(i.margin=0===Z.comparePos(i.start,e)?"left":"right",o=i):o=e,n.push(o))}))),n.forEach((function(e){var n=0,s=0,o=null,a=0,c=0;e.end?(n=e.start.line-1,s=e.end.line):(n=e.line-1,s=e.line),c=t.htmls[s-1].text.length,n<1?(n=1,s<t.maxLine&&(s++,c=0)):a=t.htmls[n-1].text.length,o={start:{line:n,column:a},end:{line:s,column:c}},r.push(t.getRangeText(o.start,o.end)),i.push(o)})),this._deleteMultiContent(i).forEach((function(e,i){var o=n[i],r=e.cursorPos.line,a=n[i].column;o.start&&(a="left"===o.margin?o.start.column:o.end.column),a=a>t.htmls[r-1].text.length?t.htmls[r-1].text.length:a,s.push({line:r,column:a})})),this.searcher.clearSearch(),this.cursor.clearCursorPos(),s.forEach((function(e){t.cursor.addCursorPos(e)}));var c={type:Z.command.INSERT_LINE,cursorPos:n,text:r,searchConifg:a};e?(this.history.updateHistory(c),this.searcher.refreshSearch(e.searchConifg)):this.history.pushHistory(c),this.fSearcher.refreshSearch()}},{key:"replace",value:function(e,t){var n=null,i=this.serial++;return n=this._deleteMultiContent(t),n.serial=i,this.history.pushHistory(n),n=this._insertMultiContent(e,this.cursor.multiCursorPos.toArray()),n.serial=i,this.history.pushHistory(n),this.fSearcher.refreshSearch()}},{key:"replaceTip",value:function(e){var t=e.word||"",n=e.after||"",i=e.before||"",s=i+r(e)+n,o=null;function r(e){var t="";if(e.type===fe.TOKEN_TYPE.EMMET_HTML||e.type===fe.TOKEN_TYPE.EMMET_CSS)try{var n={};e.type===fe.TOKEN_TYPE.EMMET_CSS&&(n.type="stylesheet"),t=(0,de.ZP)(e.result,n)}catch(i){t=e.result}else e.type===fe.TOKEN_TYPE.TAG_NAME?t+=e.result+"></".concat(e.result,">"):t=e.result;return t}function a(){var e=[];return this.cursor.multiCursorPos.forEach((function(n){var i=null;i={start:{line:n.line,column:n.column-t.length},end:{line:n.line,column:n.column}},e.push(i)})),e}function c(){var t=this;if(e.type===fe.TOKEN_TYPE.TAG_NAME||e.type===fe.TOKEN_TYPE.EMMET_HTML){var n=Be.endTag.exec(s);if(n)for(var i=s.slice(n.index),o=i.split("\n"),r=this.cursor.multiCursorPos.toArray(),a=r.length-1;a>=0;a--){var c=l.call(this,o,r[a]);this.cursor.updateCursorPos(r[a],c.line,c.column)}}else e.type===fe.TOKEN_TYPE.ATTR_NAME&&this.cursor.multiCursorPos.forEach((function(e){t.cursor.moveCursor(e,"left")}))}function l(e,t){var n=t.line,i=t.column;return 1===e.length?i-=e[0].length:(n-=e.length-1,i=this.htmls[n-1].text.length-e[0].length),{line:n,column:i}}s!==t&&(o=a.call(this),this.replace(s,o),c.call(this),e.type===fe.TOKEN_TYPE.CSS_PROPERTY&&this.autocomplete.search())}},{key:"getRangeText",value:function(e,t){var n=this.htmls[e.line-1].text;if(e.line!=t.line){var i=[];n=n.slice(e.column),i=this.htmls.slice(e.line,t.line-1),i=i.map((function(e){return e.text})),n+=i.length?"\n"+i.join("\n"):"",t.line<=this.maxLine&&(n+="\n"+this.htmls[t.line-1].text.slice(0,t.column))}else n=n.slice(e.column,t.column);return n}},{key:"getCopyText",value:function(e){var t=this,n="",i=null,s=[];return this.cursor.multiCursorPos.forEach((function(e){var n=t.selecter.getRangeByCursorPos(e),o=null;n?s.push(n):i&&e.line===i.line||(o=e.line>1?{line:e.line-1,column:t.htmls[e.line-2].text.length}:{line:e.line,column:0},n={start:o,end:{line:e.line,column:t.htmls[e.line-1].text.length}},s.push(n),i=e)})),s.forEach((function(e){var i=t.getRangeText(e.start,e.end);n="\n"===i[0]?n+=i:n+="\n"+i})),e&&(this.history.pushHistory(this._deleteMultiContent(s)),this.searcher.clearSearch(),this.fSearcher.refreshSearch()),n.slice(1)}},{key:"getAllText",value:function(){return this.htmls.map((function(e){return e.text})).join("\n")}}]),e}();De.contexts={};var Fe=De,Ae=function(){function e(t,n){(0,B.Z)(this,e),this.initProperties(t,n)}return(0,D.Z)(e,[{key:"initProperties",value:function(e,t){Z.defineProperties(this,e,["nowCursorPos","cursor","selecter","searcher","autocomplete","fSearcher","history","autoTipList","setAutoTip","prevAutoTip","nextAutoTip","selectAutoTip","searchWord","openSearch","$emit"]),Z.defineProperties(this,t,["htmls","insertContent","deleteContent","moveLineUp","moveLineDown","copyLineUp","copyLineDown","deleteLine"]),this.setEditorData=function(t,n){e.setData(t,n)}}},{key:"onKeyDown",value:function(e){var t=this;if(e.ctrlKey&&e.shiftKey){switch(e.preventDefault(),e.keyCode){case 37:this.selecter.select("left",!0);break;case 38:this.moveLineUp();break;case 39:this.selecter.select("right",!0);break;case 40:this.moveLineDown();break;case 68:this.copyLineUp();break;case 75:this.deleteLine();break;case 76:e.preventDefault(),this.cursor.addCursorLineEnds();break}return!1}if(e.ctrlKey&&e.altKey)switch(e.keyCode){case 38:e.preventDefault(),this.cursor.addCursorAbove();break;case 40:e.preventDefault(),this.cursor.addCursorBelow();break}else if(e.altKey&&e.shiftKey)switch(e.keyCode){case 40:e.preventDefault(),this.copyLineDown();break}else if(e.ctrlKey)switch(e.keyCode){case 37:n("left",!0);break;case 39:n("right",!0);break;case 65:e.preventDefault(),this.selecter.selectAll();break;case 68:e.preventDefault(),this.searchWord("down");break;case 70:e.preventDefault(),this.openSearch();break;case 72:e.preventDefault(),this.openSearch(!0);break;case 83:this.$emit("save");break;case 90:case 122:e.preventDefault(),this.history.undo();break;case 89:case 121:e.preventDefault(),this.history.redo();break}else if(e.shiftKey)switch(e.keyCode){case 37:this.selecter.select("left");break;case 38:this.selecter.select("up");break;case 39:this.selecter.select("right");break;case 40:this.selecter.select("down");break}else switch(e.keyCode){case 9:e.preventDefault(),this.autocomplete.emmet();break;case 37:n("left");break;case 35:n("end");break;case 36:n("home");break;case 38:this.autoTipList&&this.autoTipList.length?t.prevAutoTip():n("up");break;case 39:n("right");break;case 40:this.autoTipList&&this.autoTipList.length?t.nextAutoTip():n("down");break;case 13:case 100:this.autoTipList&&this.autoTipList.length&&(e.preventDefault(),this.selectAutoTip());break;case Z.keyCode.DELETE:this.deleteContent(Z.keyCode.DELETE),this.autocomplete.search();break;case Z.keyCode.BACKSPACE:this.deleteContent(Z.keyCode.BACKSPACE),this.autocomplete.search();break}function n(e,n){t.selecter.getRangeByCursorPos(t.nowCursorPos)||t.cursor.multiCursorPos.forEach((function(i){t.cursor.moveCursor(i,e,n)})),t.setAutoTip(null),t.searcher.clearSearch(),t.fSearcher.clearActive()}}}]),e}(),Ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-search",on:{contextmenu:[function(e){e.preventDefault()},function(e){e.stopPropagation()}],mousedown:function(e){e.stopPropagation()},selectstart:function(e){e.stopPropagation()}}},[n("div",{staticClass:"my-search-left active-click",staticStyle:{"border-radius":"0"},attrs:{tabindex:"-1"},on:{click:e.showReplace}},[n("span",{staticClass:"iconfont",class:{"icon-down1":e.replaceVisible,"icon-right":!e.replaceVisible},staticStyle:{"font-size":"14px"},attrs:{title:"Toggle Replace mode"}})]),n("div",{staticStyle:{"flex-grow":"1"}},[n("div",{staticClass:"my-search-top"},[n("div",{staticClass:"my-search-input",class:{"my-active":e.input1Focus}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],ref:"input1",style:{height:e.input1Height+"px"},attrs:{type:"text",spellcheck:"false"},domProps:{value:e.text},on:{blur:function(t){e.input1Focus=!1},focus:function(t){e.input1Focus=!0},keydown:e.onKeyDown,input:[function(t){t.target.composing||(e.text=t.target.value)},e.onInput]}}),n("span",{staticClass:"my-search-suffix",class:{"my-active":e.ignoreCase},attrs:{title:"Match Case(Alt+C)"},on:{click:e.changeCase}},[e._v("Aa")]),n("span",{staticClass:"my-search-suffix iconfont icon-whole-word",class:{"my-active":e.wholeWord},attrs:{title:"Match Whole Word(Alt+W)"},on:{click:e.changeWhole}})]),e.count?n("div",[n("span",[e._v(e._s(e.now))]),n("span",[e._v(" of ")]),n("span",[e._v(e._s(e.count))])]):n("span",{staticClass:"no-result",class:{"my-active":e.text}},[e._v("No results")])]),e.replaceVisible?n("div",{staticClass:"my-search-bottom",staticStyle:{"margin-top":"5px"}},[n("div",{staticClass:"my-search-input",class:{"my-active":e.input2Focus}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.replaceText,expression:"replaceText"}],ref:"input2",style:{height:e.input2Height+"px"},attrs:{type:"text",spellcheck:"false"},domProps:{value:e.replaceText},on:{blur:function(t){e.input2Focus=!1},focus:function(t){e.input2Focus=!0},keydown:e.onKeyDown2,input:function(t){t.target.composing||(e.replaceText=t.target.value)}}})]),n("span",{staticClass:"iconfont icon-replace active-click",class:{"enabled-color":e.count>0,"disabled-color":0==e.count},staticStyle:{"margin-right":"5px"},attrs:{title:"Replace(Enter)",tabindex:"-1"},on:{click:e.replace}}),n("span",{staticClass:"iconfont icon-replace-all active-click",class:{"enabled-color":e.count>0,"disabled-color":0==e.count},staticStyle:{"margin-right":"5px"},attrs:{title:"Replace All(Ctrl+Alt+Enter)",tabindex:"-1"},on:{click:e.replaceAll}})]):e._e()]),n("div",{staticClass:"my-search-right"},[n("span",{staticClass:"iconfont icon-up active-click",class:{"enabled-color":e.count>0,"disabled-color":0==e.count},staticStyle:{"margin-right":"5px"},attrs:{title:"Previous Match(Shift Enter)",tabindex:"-1"},on:{click:e.searchPrev,focus:function(t){e.preFocus=!0},blur:function(t){e.preFocus=!1}}}),n("span",{staticClass:"iconfont icon-down active-click",class:{"enabled-color":e.count>0,"disabled-color":0==e.count},staticStyle:{"margin-right":"5px"},attrs:{title:"Next Match(Enter)",tabindex:"-1"},on:{click:e.searchNext,focus:function(t){e.nextFocus=!0},blur:function(t){e.nextFocus=!1}}}),n("span",{staticClass:"iconfont icon-close active-click",attrs:{title:"Close"},on:{click:e.close}})])])},Oe=[],We={name:"Search",props:{now:{type:Number,default:1},count:{type:Number,default:0}},data:function(){return{text:"",replaceText:"",replaceVisible:!1,wholeWord:!1,ignoreCase:!1,searchPrevActive:!1,searchNextActive:!1,input1Focus:!1,input2Focus:!1,preFocus:!1,nextFocus:!1,input1Height:30,input2Height:30}},watch:{text:function(){var e=this.text.split(/\n/);this.input1Height=20*e.length+10},replaceText:function(){var e=this.replaceText.split(/\n/);this.input2Height=20*e.length+10}},created:function(){var e=this;C()(document).on("keydown",(function(t){13!==t.keyCode&&100!==t.keyCode||(e.preFocus?e.searchPrev():e.nextFocus&&e.searchNext())}))},methods:{initData:function(e){for(var t in e)this[t]=e[t]},getData:function(){return{text:this.text,wholeWord:this.wholeWord,ignoreCase:this.ignoreCase}},search:function(){var e=this,t=this.search.id||1;this.search.id=t,this.$nextTick((function(){e.search.id===t&&e.$emit("search",{text:e.text,ignoreCase:e.ignoreCase,wholeWord:e.wholeWord})}))},changeCase:function(){this.ignoreCase=!this.ignoreCase,this.focus(),this.onInput()},changeWhole:function(){this.wholeWord=!this.wholeWord,this.focus(),this.onInput()},showReplace:function(){this.replaceVisible=!this.replaceVisible},searchNext:function(){this.count&&this.$emit("next")},searchPrev:function(){this.count&&this.$emit("prev")},replace:function(){this.count&&this.$emit("replace",{text:this.replaceText})},replaceAll:function(){this.count&&this.$emit("replaceAll",{text:this.replaceText})},close:function(){this.$emit("close")},focus:function(){var e=this;this.$refs.input1.focus(),requestAnimationFrame((function(){e.$refs.input1.focus()}))},directBlur:function(){this.searchPrevActive=!1,this.searchNextActive=!1},onKeyDown:function(e){13!==e.keyCode&&100!==e.keyCode||(e.preventDefault(),this.$emit("next"))},onKeyDown2:function(e){13!==e.keyCode&&100!==e.keyCode||(e.preventDefault(),this.count&&(e.ctrlKey&&e.altKey?this.replaceAll():this.replace()))},onInput:function(){var e=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){e.search()}),100)}}},$e=We,Re=(0,c.Z)($e,Ne,Oe,!1,null,null,null),je=Re.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"auto",staticClass:"my-auto my-shadow my-border my-scroll-overlay my-scroll-mini",style:e.styles,on:{mousedown:function(e){e.stopPropagation()},wheel:function(e){e.stopPropagation()}}},[n("div",e._l(e.tipList,(function(t){return n("div",{staticClass:"my-auto-item my-center-between",class:{"my-active":t.active},on:{mousedown:function(n){return e.onClick(t)}}},[n("div",{staticClass:"my-center-between"},[n("div",{staticClass:"my-auto-icon my-center-center iconfont",class:[t.icon]}),n("div",{staticClass:"my-auto-content"},[n("span",{domProps:{innerHTML:e._s(e._html(t))}})])]),n("div",{staticClass:"my-auto-desc"},[e._v(e._s(t.desc))])])})),0)])},ze=[],Ve={name:"AutoTip",props:{tipList:{type:Array,default:[]},styles:{type:Object}},data:function(){return{nowIndex:0,itemHeight:25}},computed:{_html:function(){return function(e){var t=0,n="";return e.indexs.forEach((function(i){n+=e.result.slice(t,i),n+='<span class="match-char">'.concat(e.result[i],"</span>"),t=i+1})),n+e.result.slice(t)}}},watch:{nowIndex:function(){var e=this.$refs.auto,t=(this.nowIndex+1)*this.itemHeight;e&&t>e.clientHeight+e.scrollTop?e.scrollTop=t-e.clientHeight:e&&t<e.scrollTop+this.itemHeight&&(e.scrollTop=t-this.itemHeight)}},created:function(){},methods:{onClick:function(e){this.$emit("change",e)},prev:function(){var e=this.getActiveIndex();this.tipList[e].active=!1,e-=1,e=e<0?this.tipList.length-1:e,this.tipList[e].active=!0,this.nowIndex=e},next:function(){var e=this.getActiveIndex();this.tipList[e].active=!1,e+=1,e=e>this.tipList.length-1?0:e,this.tipList[e].active=!0,this.nowIndex=e},getActiveIndex:function(){for(var e=0;e<this.tipList.length;e++)if(this.tipList[e].active)return e}}},Ke=Ve,Ze=(0,c.Z)(Ke,He,ze,!1,null,"378f7506",null),Ue=Ze.exports,Ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-tip",style:e.styles,on:{mousedown:function(e){e.stopPropagation()}}},[n("div",{staticClass:"my-tip-content"},[n("div",{domProps:{innerHTML:e._s(e.content)}})])])},qe=[],Ge={name:"Tip",props:{content:String,styles:{type:Object}},data:function(){return{}},created:function(){},methods:{}},Xe=Ge,Je=(0,c.Z)(Xe,Ye,qe,!1,null,null,null),Qe=Je.exports,et=Fe.contexts,tt={name:"Editor",components:{SearchDialog:je,Menu:L,AutoTip:Ue,Tip:Qe},props:{id:{type:Number},active:{type:Boolean,default:!1}},data:function(){return{charObj:{charWidth:7.15,fullAngleCharWidth:15,charHight:19},nowCursorPos:{line:1,column:0},cursorVisible:!0,cursorFocus:!0,language:"",theme:"",tabSize:4,renderHtmls:[],startLine:1,top:0,cursorLeft:0,scrollLeft:0,scrollTop:0,maxVisibleLines:1,maxLine:1,contentHeight:"100%",scrollerArea:{},bracketMatch:{start:{},end:{}},maxWidthObj:{lineId:null,text:"",width:0},menuList:[[{name:"Cut",op:"cut",shortcut:"Ctrl+X"},{name:"Copy",op:"copy",shortcut:"Ctrl+C"},{name:"Paste",op:"paste",shortcut:"Ctrl+V"}]],menuStyle:{top:"0px",left:"0px","min-width":"200px"},tipStyle:{top:"0px",left:"0px"},autoTipStyle:{top:"50%",left:"50%"},errorMap:{},errors:[],autoTipList:[],tipContent:null,menuVisible:!1,searchVisible:!1,selectedFg:!1,activeLineBg:!0,searchNow:1,searchCount:0}},computed:{_numTop:function(){return this.top-this.charObj.charHight+"px"},_leftShadow:function(){return this.scrollLeft?"17px 0 16px -16px rgba(0, 0, 0, 0.8) inset":"none"},_top:function(){return(this.folder.getRelativeLine(this.startLine)-1)*this.charObj.charHight+"px"},_lineHeight:function(){return this.charObj.charHight+"px"},_cursorVisible:function(){return this.cursorVisible&&this.cursorFocus?"visible":"hidden"},_hScrollWidth:function(){return this._contentMinWidth},_contentMinWidth:function(){var e=0;return this.$refs.content&&(e=Z.getStrExactWidth(this.maxWidthObj.text,this.tabSize,this.$refs.content),e+=this.charObj.fullAngleCharWidth),e=this.scrollerArea.width>e?this.scrollerArea.width:e,e+"px"},_textAreaPos:function(){var e=this.cursorLeft,t=this.top;if(this.nowCursorPos){var n=this.nowCursorPos.line<this.startLine?this.startLine:this.nowCursorPos.line;t=this.folder.getRelativeLine(n)*this.charObj.charHight,t>this.scrollTop+this.scrollerArea.height-2*this.charObj.charHight&&(t=this.scrollTop+this.scrollerArea.height-2*this.charObj.charHight)}return{top:t+"px",left:e+"px"}},_tabLineLeft:function(){var e=this;return function(t){return(t-1)*e.tabSize*e.charObj.charWidth+"px"}},_activeLine:function(){var e=this;return function(t){return e.nowCursorPos.line==t&&e.activeLineBg}},space:function(){return Z.space(this.tabSize)},myContext:function(){return et[this.id]}},watch:{language:function(e){this.myContext.htmls.forEach((function(e){e.tokens=null,e.folds=null,e.stateFold=null,e.states=null,e.html=""})),this.lint.initLanguage(e),this.tokenizer.initLanguage(e)},theme:function(){this.myContext.htmls.forEach((function(e){e.html=""})),this.render()},tabSize:function(e){this.render(),this.maxWidthObj={lineId:null,text:"",width:0},this.myContext.setLineWidth(this.myContext.htmls)},maxLine:function(e){this.setContentHeight()},startLine:function(e){this.render(),this.tokenizer.tokenizeVisibleLins()},nowCursorPos:{handler:function(e){E.$emit("cursor-change",{line:e?e.line:"?",column:e?e.column:"?"}),this.renderBracketMatch()},deep:!0},active:function(e){e?this.showEditor():this.autocomplete.stop()}},created:function(){this.initData(),this.initEventBus(),this.initEvent()},mounted:function(){this.selectedFg=!!j.colors["editor.selectionForeground"],this.showEditor(),this.initResizeEvent()},destroyed:function(){this.unbindEvent()},methods:{initData:function(){this.editorId=this.id,et[this.editorId]=new Fe(this),this.maxWidthObj.lineId=this.myContext.htmls[0].lineId,this.tokenizer=new re(this,this.myContext),this.lint=new he(this,this.myContext),this.autocomplete=new ye(this,this.myContext),this.folder=new Le(this,this.myContext),this.history=new Me(this,this.myContext),this.selecter=new Se(this,this.myContext),this.searcher=new Pe(this,this.myContext,this.selecter),this.fSelecter=new Se(this,this.myContext),this.fSearcher=new Pe(this,this.myContext,this.fSelecter),this.shortcut=new Ae(this,this.myContext),this.cursor=new Ie(this,this.myContext),this.cursor.addCursorPos(this.nowCursorPos),this.wordPattern=Z.getWordPattern(this.language),this.wordPattern=new RegExp("^(".concat(this.wordPattern.source,")"))},initEvent:function(){var e=this;this.initEvent.fn1=function(t){e.active&&e.onDocumentMmove(t)},this.initEvent.fn2=function(t){e.active&&e.onDocumentMouseUp(t)},C()(document).on("mousemove",this.initEvent.fn1),C()(document).on("mouseup",this.initEvent.fn2)},initResizeEvent:function(){var e=this,t=new ResizeObserver((function(t){e.$refs.editor&&e.showEditor()}));t.observe(this.$refs.editor)},initEventBus:function(){var e=this;E.$on("language-change",this.initEventBus.fn1=function(t){e.active&&(e.language=t),e._language=t}),E.$on("tab-size-change",this.initEventBus.fn2=function(t){e.active&&(e.tabSize=t)}),E.$on("close-menu",this.initEventBus.fn3=function(){e.menuVisible=!1,e.autoTipList=null,e.autocomplete.stop()}),E.$on("theme-change",this.initEventBus.fn4=function(t){e.selectedFg=!!j.colors["editor.selectionForeground"],e.active&&(e.theme=t),e._theme=t})},unbindEvent:function(){C()(document).unbind("mousemove",this.initEvent.fn1),C()(document).unbind("mouseup",this.initEvent.fn2),E.$off("language-change",this.initEventBus.fn1),E.$off("tab-size-change",this.initEventBus.fn2),E.$off("close-menu",this.initEventBus.fn3),E.$off("theme-change",this.initEventBus.fn4)},showEditor:function(){var e=this;this.active&&this.$nextTick((function(){e.language=e._language||"",e.theme=e._theme||"",e.charObj=Z.getCharWidth(e.$refs.content),e.maxVisibleLines=Math.ceil(e.$refs.scroller.clientHeight/e.charObj.charHight)+1,e.render(),e.focus()}))},showCursor:function(){var e=this;if(this.cursorFocus=!0,this.cursor.multiCursorPos.size){if(!this.showCursor.show){this.showCursor.show=!0,this.cursorVisible=!0;var t=function t(){clearTimeout(e.curserTimer),e.curserTimer=setTimeout((function(){e.cursorVisible=!e.cursorVisible,t()}),500)};t()}}else this.showCursor.show=!1},hideCursor:function(){clearTimeout(this.curserTimer),this.showCursor.show=!1,this.cursorFocus=!1},focus:function(){var e=this;this.$refs.textarea.focus(),requestAnimationFrame((function(){e.$refs.textarea.focus()}))},render:function(e){var t=this,n=this.renderId+1||1;this.renderId=n,this.$nextTick((function(){t.renderId===n&&(t.renderLine(),t.renderSelectedBg(),t.renderSelectionToken(),t.renderError(),t.renderCursor(e),t.$nextTick((function(){t.scrollerArea={height:t.$refs.scroller.clientHeight,width:t.$refs.scroller.clientWidth}})))}))},renderLine:function(e){var t=this;if(e){if(this.myContext.renderedIdMap.has(e)){var n=this.myContext.lineIdMap.get(e),i=this.myContext.renderedIdMap.get(e);this.myContext.htmls[i.num-1]&&this.myContext.htmls[i.num-1].lineId===e&&(Object.assign(i,u(n,i.num)),this.renderCursor(),this.renderSelectedBg(),this.renderSelectionToken(i.line),this.renderError(i.line))}}else{this.myContext.renderedIdMap.clear(),this.myContext.renderedLineMap.clear(),this.renderHtmls=[];for(var s=0,o=this.startLine;s<this.maxVisibleLines&&o<=this.myContext.htmls.length;s++){var r=this.myContext.htmls[o-1],a=r.lineId,c=u(r,o),l=this.folder.getFoldByLine(o);this.renderHtmls.push(c),this.myContext.renderedIdMap.set(a,c),this.myContext.renderedLineMap.set(o,c),l?o=l.end.line:o++}}function u(e,n){var i=h(n),s="";t.folder.getFoldByLine(n)?s="close":t.folder.getRangeFold(n,!0)&&(s="open");var o=e.html;return o||(e.tokens&&e.tokens.length?(e.tokens=t.tokenizer.splitLongToken(e.tokens),e.html=t.tokenizer.createHtml(e.tokens,e.text),o=e.html):o=Z.htmlTrans(e.text)),o=o.replace(/\t/g,t.space),{html:o,num:n,tabNum:i,selectStarts:[],selectEnds:[],selected:!1,isFsearch:!1,fold:s,cursorList:[]}}function h(e){var n=t.myContext.htmls[e-1].text,i=/[^\s]/,s=0;if(t.myContext.renderedLineMap.has(e))return t.myContext.renderedLineMap.get(e).tabNum;if(i.exec(n)){var o=/^\s+/.exec(n);o&&(s=/\t+/.exec(o[0]),s=s&&s[0].length||0,s+=Math.ceil((o[0].length-s)/t.tabSize))}else{var r=e-1;while(r>=1){if(i.exec(t.myContext.htmls[r-1].text)){s=h(r),t.folder.getRangeFold(r,!0)&&s++;break}r--}}return s}},renderSelectedBg:function(){var e=this,t=this.renderSelectedBgId+1||1;this.renderSelectedBgId=t,this.activeLineBg=!0,this.$nextTick((function(){e.renderSelectedBgId==t&&(e.renderHtmls.length?(e.clearSelectionToken(),e.renderHtmls.forEach((function(e){e.selected=!1,e.selectStarts=[],e.selectEnds=[]})),e.fSelecter.ranges.forEach((function(t){e._renderSelectedBg(t,!0)})),e.selecter.ranges.forEach((function(t){var n=e.fSelecter.getRangeByCursorPos(t.start);e.searchVisible?!n&&t.active&&e._renderSelectedBg(t):e._renderSelectedBg(t)}))):requestAnimationFrame((function(){e.renderSelectedBg()})))}))},_renderSelectedBg:function(e,t){var n=this.renderHtmls[0].num,i=this.renderHtmls.peek().num,s=e.start,o=e.end,r=this.myContext.htmls[s.line-1].text,a=r.length;s.left=this.getStrWidth(r,0,s.column),s.line==o.line?s.width=this.getStrWidth(r,s.column,o.column)||10:(s.width=this.getStrWidth(r,s.column)||10,o.left=0,r=this.myContext.htmls[o.line-1].text,o.width=this.getStrWidth(r,0,o.column)||10),n=n>s.line+1?n:s.line+1,i=i<o.line-1?i:o.line-1;for(var c=n;c<=i;c++)if(this.myContext.renderedLineMap.has(c)){var l=this.myContext.renderedLineMap.get(c);l.selected=!0,l.isFsearch=t,l.active=e.active}this.myContext.renderedLineMap.has(s.line)&&(this.myContext.renderedLineMap.get(s.line).selectStarts.push({left:s.left,width:s.width,active:e.active,isFsearch:t}),o.line==s.line&&(a=o.column),e.active&&this._renderSelectionToken(s.line,s.column,a)),o.line>s.line&&this.myContext.renderedLineMap.has(o.line)&&(this.myContext.renderedLineMap.get(o.line).selectEnds.push({left:o.left,width:o.width,active:e.active,isFsearch:t}),e.active&&this._renderSelectionToken(o.line,0,o.column)),s.line!==this.nowCursorPos.line&&o.line!==this.nowCursorPos.line||(this.activeLineBg=!1)},renderSelectionToken:function(e){var t=this;if(j.colors["editor.selectionForeground"]){var n=this.selecter.getRangeByLine(e);n.forEach((function(n){if(n.active){var i=n.start.column,s=n.end.column;n.start.line===e?n.end.line>n.start.line&&(s=t.myContext.htmls[n.start.line-1].text.length):i=0,t._renderSelectionToken(e,i,s)}}))}},_renderSelectionToken:function(e,t,n){if(j.colors["editor.selectionForeground"]){var i=this.myContext.htmls[e-1],s=i.tokens,o=["selected"],r=[];this.myContext.fgLines.push(e);for(var a=0;a<s.length;a++){var c=s[a];if(c.startIndex<=t&&c.endIndex>t){if(c.startIndex<t&&r.push({startIndex:c.startIndex,endIndex:t,scopes:c.scopes}),c.endIndex>n){r.push({startIndex:t,endIndex:n,scopes:o}),r.push({startIndex:n,endIndex:c.endIndex,scopes:c.scopes}),r=r.concat(s.slice(a+1));break}r.push({startIndex:t,endIndex:c.endIndex,scopes:o})}else if(c.startIndex>t&&c.endIndex<=n)r.push({startIndex:c.startIndex,endIndex:c.endIndex,scopes:o});else{if(c.startIndex<n&&c.endIndex>n){r.push({startIndex:c.startIndex,endIndex:n,scopes:o}),r.push({startIndex:n,endIndex:c.endIndex,scopes:c.scopes}),r=r.concat(s.slice(a+1));break}if(c.startIndex>=n){r=r.concat(s.slice(a));break}r.push(c)}}i.html=this.tokenizer.createHtml(r,i.text),this.myContext.renderedIdMap.get(i.lineId).html=i.html,this.$nextTick((function(){i.fgTokens=r}))}},renderBracketMatch:function(){if(this.bracketMatch=this.folder.getBracketMatch(this.nowCursorPos),this.bracketMatch){var e=null,t=null;e=this.myContext.htmls[this.bracketMatch.start.line-1],t=this.bracketMatch.start,this.bracketMatch.start.width=this.getStrWidth(e.text,t.startIndex,t.endIndex),this.bracketMatch.start.left=this.getStrWidth(e.text,0,t.startIndex),e=this.myContext.htmls[this.bracketMatch.end.line-1],t=this.bracketMatch.end,this.bracketMatch.end.width=this.getStrWidth(e.text,t.startIndex,t.endIndex),this.bracketMatch.end.left=this.getStrWidth(e.text,0,t.startIndex)}},clearSelectionToken:function(){var e=this;this.myContext.fgLines.forEach((function(t){e._clearSelectionToken(t)})),this.myContext.fgLines.empty()},_clearSelectionToken:function(e){var t=this.myContext.htmls[e-1];t&&t.fgTokens&&(t.fgTokens=null,this.myContext.renderedLineMap.has(e)&&(this.myContext.renderedIdMap.get(t.lineId).html=this.tokenizer.createHtml(t.tokens,t.text)),t.html="")},renderCursor:function(e){var t=this,n=this,i=this.renderCursorId+1||1;function s(e){var t=[];n.cursor.getCursorsByLine(e.num).forEach((function(e){t.push(o(e))})),e.cursorList=t}function o(t){var i=0;if(!t.del)return i=n.getExactLeft(t),e&&t===n.nowCursorPos&&(i>n.scrollerArea.width+n.scrollLeft-n.charObj.fullAngleCharWidth?n.$refs.scroller.scrollLeft=i+n.charObj.fullAngleCharWidth-n.scrollerArea.width:i<n.scrollLeft&&(n.$refs.scroller.scrollLeft=i-1)),t===n.nowCursorPos&&(n.cursorLeft=i),i+"px"}this.renderCursorId=i,this.$nextTick((function(){t.renderCursorId===i&&t.renderHtmls.length&&(t.renderHtmls.forEach((function(e){s(e)})),t.cursorVisible=!0)}))},renderError:function(e){var t=this;function n(){var t=this,n=C()(this.$refs.render),o={};n.find("span.my-token-error").remove(),this.errors.forEach((function(n){var r=n.line+","+n.originColumn,a=null;if(!(e&&n.line!==e||o[r])){if(o[r]=!0,a=t.myContext.htmls[n.line-1],n.endLine||(n.endLine=n.line),n.column>=a.text.length&&(n.column=a.text.length-1),!n.endColumn){var c=null;(c=t.wordPattern.exec(a.text.slice(n.column)))?n.endColumn=n.column+c[0].length:n.endColumn=n.column+1}if(n.endColumn>a.text.length&&(n.endColumn=a.text.length),n.line===n.endLine)i.call(t,n.line,n.column,n.endColumn,r);else{i.call(t,n.line,n.column,a.text.length,r),i.call(t,n.endLine,0,n.endColumn,r);for(var l=n.line+1;l<n.endLine;l++)s.call(t,l,r)}}}))}function i(e,t,n,i){if(!(e<this.startLine||e>this.startLine+this.maxVisibleLines)){var s=C()(this.$refs.render),o=this.myContext.htmls[e-1],r=this.getToken(e,t),a=0;if(r){var c=s.find('div.my-code[data-line="'.concat(e,'"]')).find('span[data-column="'.concat(r.startIndex,'"]'));a=c[0].offsetLeft+this.getStrWidth(o.text,r.startIndex,t)}var l=this.getStrWidth(o.text,t,n)||this.charObj.charWidth,u='<span class="my-token-error" style="width:'.concat(l,"px;left:").concat(a,'px" data-key="').concat(i,'"></span>');s.find('div.my-code[data-line="'.concat(e,'"]')).append(u)}}function s(e,t){if(!(e<this.startLine||e>this.startLine+this.maxVisibleLines)){var n=C()(this.$refs.render),i='<span class="my-token-error" style="width:100%;left:0px" data-key="'.concat(t,'"></span>');n.find('div.my-code[data-line="'.concat(e,'"]')).append(i)}}this.$nextTick((function(){n.call(t)}))},foldLine:function(e){var t=this,n=this.folder.foldLine(e);this.focus(),n&&(this.cursor.multiCursorPos.forEach((function(i){if(i.line>e&&i.line<n.end.line){var s=t.myContext.htmls[e-1];i.line=e,i.column=s.text.length}})),this.setContentHeight(),this.render())},unFold:function(e){this.focus(),this.folder.unFold(e)&&(this.setContentHeight(),this.render())},openSearch:function(e){var t=this.$refs.searchDialog;if(!this.searchVisible||!this.fSelecter.activedRanges.size&&this.cursorFocus){if(this.cursorFocus){var n=this.fSearcher.getSearchConfig();if(n)t.initData({ignoreCase:n.ignoreCase,wholeWord:n.wholeWord,text:n.text});else if(this.searchVisible)return}this.searchVisible=!0,this.fSearcher.clearSearch(),this.searchText({config:t.getData()}),t.initData({replaceVisible:!!e}),t.focus()}},searchWord:function(e){var t=null;if(this.searcher.search({direct:e}),this.searchVisible){if(0===this.fSelecter.activedRanges.size){var n=this.fSearcher.getSearchConfig();n&&(this.fSearcher.clearSearch(),t=this.fSearcher.search({direct:e,increase:!0}))}else t=this.fSearcher.search({direct:e,increase:!0});t&&(this.searchNow=t.now,this.searchCount=t.count)}},searchText:function(e){var t=this.fSearcher.search(e);t?(this.searchNow=t.now,this.searchCount=t.count):this.searchCount=0},replace:function(e){var t=this;if(this.fSelecter.activedRanges.size){var n=this.fSearcher.getNowRange();this.myContext.replace(e.text,[n]).then((function(){t.searchText()}))}else this.searchText()},replaceAll:function(e){var t=this;this.fSelecter.ranges.size&&this.myContext.replace(e.text,this.fSelecter.ranges.toArray()).then((function(){t.fSearcher.clearSearch(),t.searchCount=0}))},prevAutoTip:function(){this.$refs.autoTip.prev()},nextAutoTip:function(){this.$refs.autoTip.next()},selectAutoTip:function(){var e=this.$refs.autoTip.getActiveIndex();this.onClickAuto(this.autoTipList[e])},setData:function(e,t){"function"!==typeof this[e]&&(this[e]=t)},setNowCursorPos:function(e){var t=this;if(this.nowCursorPos=e||{line:1,column:0},e){var n=this.setNowCursorPosId+1||1;this.setNowCursorPosId=n,this.$nextTick((function(){if(t.setNowCursorPosId==n){var i=t.folder.getRelativeLine(e.line)*t.charObj.charHight;i+t.charObj.charHight>t.scrollTop+t.scrollerArea.height?requestAnimationFrame((function(){t.setStartLine(i+t.charObj.charHight-t.scrollerArea.height),t.$refs.scroller.scrollTop=i+t.charObj.charHight-t.scrollerArea.height})):e.line<=t.startLine&&requestAnimationFrame((function(){e.line<=t.startLine&&(t.startLine=e.line,t.$refs.scroller.scrollTop=(t.folder.getRelativeLine(e.line)-1)*t.charObj.charHight)})),t.renderCursor(!0)}}))}},setContentHeight:function(){var e=this.myContext.htmls.length,t=0;e=this.folder.getRelativeLine(e),t=e*this.charObj.charHight,this.scrollerArea&&(t+=this.scrollerArea.height-this.charObj.charHight),this.contentHeight=t+"px"},setStartLine:function(e){var t=1;t=Math.floor(e/this.charObj.charHight),t++,this.startLine=this.folder.getRealLine(t),this.top=-e%this.charObj.charHight},setErrors:function(e){function t(e,t){var n=0;while(n<t.length){var i=t[n].line,s=[];while(n<t.length&&t[n].line===i){var o=i+","+t[n].column;t[n].originColumn=t[n].column,s.push(t[n].reason),e[o]?e[o]+="<br>"+t[n].reason:e[o]=t[n].reason,n++}i=i||this.htmls.length,e[i]=s.join("<br>")}}this.errorMap={},this.errors=e,t.call(this,this.errorMap,e),this.renderError()},setAutoTip:function(e){var t=this;clearTimeout(this.setAutoTip.hideTimer),e&&e.length?(e.forEach((function(e){e.active=!1})),this.autoTipList=e,this.autoTipList[0].active=!0,this.$nextTick((function(){var e=t.$refs.autoTip.$el.clientWidth,n=t.$refs.autoTip.$el.clientHeight;t.autoTipStyle.top=t.folder.getRelativeLine(t.nowCursorPos.line)*t.charObj.charHight,t.autoTipStyle.left=t.getExactLeft(t.nowCursorPos),t.autoTipStyle.top+n>Z.getNum(t._top)+t.$refs.scroller.clientHeight&&(t.autoTipStyle.top-=n+t.charObj.charHight),t.autoTipStyle.left+e>t.scrollLeft+t.scrollerArea.width&&(t.autoTipStyle.left-=e),t.autoTipStyle.top+="px",t.autoTipStyle.left+="px"}))):this.setAutoTip.hideTimer=setTimeout((function(){t.autoTipList=null}),60)},getStrWidth:function(e,t,n){return Z.getStrWidth(e,this.charObj.charWidth,this.charObj.fullAngleCharWidth,this.tabSize,t,n)},getStrWidthByLine:function(e,t,n){return this.getStrWidth(this.myContext.htmls[e-1].text,t,n)},getColumnByWidth:function(e,t){var n,i,s,o,r=0,a=e.length;while(r<a){if(n=Math.floor((r+a)/2),i=this.getStrWidth(e,0,n),s=e[n-1]&&this.getStrWidth(e[n-1])/2,o=e[n]&&this.getStrWidth(e[n])/2||s,i>=t&&i-t<s||t>=i&&t-i<o){r=n;break}i>t?a=n:r=n+1}return r},getPosByEvent:function(e){var t=C()(e.target),n=(t.attr("data-line")||t.parent().attr("data-line"))-0,i=t.attr("data-column");if(!n){if(e.target!==this.$refs.content)return null;n=this.myContext.htmls.length}var s=this.myContext.htmls[n-1],o=s.fgTokens||s.tokens;if(i){i-=0;for(var r=0;r<o.length;r++){var a=o[r];if(o[r].startIndex==i){i+=this.getColumnByWidth(s.text.slice(a.startIndex,a.endIndex),e.offsetX);break}}}else i=s.text.length;return{line:n,column:i}},getExactLeft:function(e){var t=this.myContext.htmls[e.line-1];if(!t.tokens||!t.tokens.length)return 0;for(var n=t.fgTokens||t.tokens,i=n[0],s=1;s<n.length;s++){if(!(n[s].startIndex<e.column))break;i=n[s]}var o=C()("#line_"+e.line).children(".my-code").children('span[data-column="'+i.startIndex+'"]');if(!o.length)return 0;var r=t.text.slice(i.startIndex,e.column);return o[0].offsetLeft+this.getStrWidth(r)},getToken:function(e,t){var n=this.myContext.htmls[e-1];if(n&&n.tokens){if(t>n.tokens.peek().startIndex)return n.tokens.peek();for(var i=0;i<n.tokens.length;i++)if(n.tokens[i].startIndex<=t&&n.tokens[i].endIndex>t)return n.tokens[i]}return null},onContextmenu:function(e){var t=this,n=0,i=0,s=C()(this.$refs.editor),o=s.offset();this.menuVisible=!0,this.$nextTick((function(){n=t.$refs.menu.$el.clientWidth,i=t.$refs.menu.$el.clientHeight,i+e.clientY>o.top+t.scrollerArea.height?t.menuStyle.top=e.clientY-o.top-i+"px":t.menuStyle.top=e.clientY-o.top+"px",n+e.clientX>o.left+s[0].clientWidth?t.menuStyle.left=e.clientX-o.left-n+"px":t.menuStyle.left=e.clientX-o.left+"px",t.focus()}))},onClickMenu:function(e){var t=this;switch(e.op){case"cut":case"copy":Z.writeClipboard(this.myContext.getCopyText("cut"===e.op));break;case"paste":this.$refs.textarea.focus(),Z.readClipboard().then((function(e){t.myContext.insertContent(e)}));break}this.menuVisible=!1,this.focus()},onClickAuto:function(e){this.myContext.replaceTip(e),this.autoTipList=null,this.focus()},onToggleFold:function(e){this.folder.getFoldByLine(e)?this.unFold(e):this.foldLine(e)},onContentMdown:function(e){if(3!=e.which){var t=this.getPosByEvent(e),n=null;if(this.mouseStartObj={time:Date.now(),start:t},e.ctrlKey&&"ctrl"===this.cursor.multiKeyCode||e.altKey&&"alt"===this.cursor.multiKeyCode){var i=this.selecter.getRangeWithCursorPos(t);i&&this.selecter.removeRange(i),n=this.cursor.addCursorPos(t)}else n=this.cursor.setCursorPos(t),3!==e.which&&this.searcher.clearSearch();3!=e.which&&(this.fSearcher.clearActive(),this.mouseUpTime&&Date.now()-this.mouseUpTime<200&&(this.mouseStartObj.doubleClick=!0,this.searchWord())),this.mouseStartObj.cursorPos=n,this.searcher.clearSearch(!0),this.focus()}},onErrorMousemove:function(e,t){for(var n=C()("div.my-code[data-line=".concat(t,"]")).children("span.my-token-error"),i=e.clientX-C()(this.$refs.render).offset().left,s=0;s<n.length;s++){var o=n.eq(s),r=o.width(),a=o[0].offsetLeft;if(i>=a&&i<=a+r){c.call(this,e,o.attr("data-key"));break}}function c(e,t){var n=this,i=C()(this.$refs.editor),s=C()(this.$refs.tip.$el),o=i.offset(),r=e.clientY-o.top,a=e.clientX-o.left;this.tipContent=this.errorMap[t],this.$nextTick((function(){r+s[0].clientHeight>n.scrollerArea.height&&(r=n.scrollerArea.height-s[0].clientHeight),n.tipStyle={left:a+10+"px",top:r+10+"px"}}))}},onContentMmove:function(e){if(this.mouseStartObj&&Date.now()-this.mouseStartObj.time>100){var t=this.getPosByEvent(e);if(t&&Z.comparePos(t,this.mouseStartObj.cursorPos)){var n=this.selecter.getRangeWithCursorPos(t);n&&this.selecter.removeRange(n),this.cursor.removeCursor(this.mouseStartObj.cursorPos),this.mouseStartObj.cursorPos=this.cursor.addCursorPos({line:t.line,column:t.column}),this.mouseStartObj.preRange?this.selecter.updateRange(this.mouseStartObj.preRange,{start:this.mouseStartObj.start,end:t}):this.mouseStartObj.preRange=this.selecter.addRange({start:this.mouseStartObj.start,end:t}),this.cursor.removeCursorInRange(this.mouseStartObj.preRange)}}function i(e){var t=C()(e.target),n=t.parent().attr("data-line");this.tipContent="",n&&this.onErrorMousemove(e,n)}i.call(this,e)},onContentMLeave:function(){this.tipContent=""},onDocumentMmove:function(e){var t=this,n=C()(this.$refs.scroller).offset();if(this.mouseStartObj&&Date.now()-this.mouseStartObj.time>100){var i=Math.ceil((this.scrollTop+e.clientY-n.top)/this.charObj.charHight);i=i<1?1:i,i=i>this.maxLine?this.maxLine:i,cancelAnimationFrame(this.selectMoveTimer),e.clientY>n.top+this.scrollerArea.height?s("down",e.clientY-n.top-this.scrollerArea.height):e.clientY<n.top?s("up",n.top-e.clientY):e.clientX<n.left?s("left",n.left-e.clientX,i):e.clientX>n.left+this.scrollerArea.width&&s("right",e.clientX-n.left-this.scrollerArea.width,i)}function s(e,n,i){var s=i||t.folder.getRelativeLine(t.nowCursorPos.line),o=t.nowCursorPos.column,r=0;function a(e,n){var i=s,c=o;switch(e){case"up":r+=n,i=Math.floor(r/t.charObj.charHight),i=s-i,c=0;break;case"down":r+=n,i=Math.floor(r/t.charObj.charHight),i=s+i;break;case"left":r+=n,c=Math.floor(r/t.charObj.charWidth),c=o-c;break;case"right":r+=n,c=Math.floor(r/t.charObj.charWidth),c=o+c;break}i=t.folder.getRealLine(i),i=i<1?1:i>t.maxLine?t.maxLine:i,c="down"===e?t.myContext.htmls[i-1].text.length:c<0?0:c>t.myContext.htmls[i-1].text.length?t.myContext.htmls[i-1].text.length:c,t.mouseStartObj.cursorPos=t.cursor.setCursorPos({line:i,column:c}),t.mouseStartObj.preRange=t.selecter.setRange(t.mouseStartObj.start,{line:i,column:c}),t.selectMoveTimer=requestAnimationFrame((function(){a(e,n)}))}a(e,n)}},onDocumentMouseUp:function(e){cancelAnimationFrame(this.selectMoveTimer),this.mouseStartObj=null,this.mouseUpTime=Date.now(),this.$refs.searchDialog&&this.$refs.searchDialog.directBlur()},onScroll:function(e){this.setStartLine(e.target.scrollTop),this.scrollTop=e.target.scrollTop,this.scrollLeft=e.target.scrollLeft,this.$refs.scroller.scrollLeft=this.scrollLeft},onWheel:function(e){this.$refs.scroller.scrollTop=this.scrollTop+e.deltaY,this.$refs.scroller.scrollLeft=this.scrollLeft+e.deltaX},onCompositionstart:function(){clearTimeout(this.compositionendTimer),this.compositionstart=!0},onCompositionend:function(){var e=this;if(this.compositionstart){var t=this.$refs.textarea.value||"";t&&(this.myContext.insertContent(t),this.autocomplete.search(),this.$refs.textarea.value="")}this.compositionendTimer=setTimeout((function(){e.compositionstart=!1}),100)},onInput:function(){if(!this.compositionstart){var e=this.$refs.textarea.value||"";e&&(this.myContext.insertContent(e),this.autocomplete.search(),this.$refs.textarea.value="")}},onCopy:function(e){var t=window.clipboardData?"Text":"text/plain",n=e.clipboardData||window.clipboardData;n.setData(t,this.myContext.getCopyText())},onCut:function(e){var t=window.clipboardData?"Text":"text/plain",n=e.clipboardData||window.clipboardData;n.setData(t,this.myContext.getCopyText(!0))},onPaste:function(e){var t=window.clipboardData?"Text":"text/plain",n=e.clipboardData||window.clipboardData,i="";i=n.getData(t),this.myContext.insertContent(i)},onFocus:function(){this.showCursor()},onBlur:function(){this.hideCursor()},onKeyDown:function(e){this.shortcut.onKeyDown(e)},onSearch:function(e){this.fSearcher.clearSearch(),this.searchText({config:e})},onSearchNext:function(){this.searchText({direct:"next"})},onSearchPrev:function(){this.searchText({direct:"up"})},onCloseSearch:function(){this.focus(),this.fSelecter.activedRanges.size&&this.searcher.clone(this.fSearcher.getCacheData()),this.fSearcher.clearSearch(),this.searchVisible=!1}}},nt=tt,it=(0,c.Z)(nt,J,Q,!1,null,null,null),st=it.exports,ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-title-bar my-width-100",style:{height:e.height+"px"},on:{contextmenu:function(e){e.stopPropagation(),e.preventDefault()}}},[n("div",{staticClass:"my-height-100 my-center-between"},[n("div",{staticClass:"menu-bar"},[n("div",{staticClass:"bar-item my-hover",on:{mousedown:function(t){return t.stopPropagation(),e.showMemu("fileMenuVisible")}}},[n("span",[e._v("File")]),e.fileMenuVisible?n("Menu",{attrs:{hoverCheck:!0,menuList:e.fileMenuList,styles:{left:0,top:e._top}},on:{change:e.onFileMenuChange}}):e._e()],1),n("div",{staticClass:"bar-item my-hover",on:{mousedown:function(t){return t.stopPropagation(),e.showMemu("editMenuVisible")}}},[n("span",[e._v("Edit")]),e.editMenuVisible?n("Menu",{attrs:{hoverCheck:!0,menuList:e.editMenuList,styles:{left:0,top:e._top}},on:{change:e.onEditMenuChange}}):e._e()],1),n("div",{staticClass:"bar-item my-hover",on:{mousedown:function(t){return t.stopPropagation(),e.showMemu("selectionMenuVisible")}}},[n("span",[e._v("Selection")]),e.selectionMenuVisible?n("Menu",{attrs:{hoverCheck:!0,menuList:e.selectionMenuList,styles:{left:0,top:e._top}},on:{change:e.onSelectionMenuChange}}):e._e()],1),n("div",{staticClass:"bar-item my-hover",on:{mousedown:function(t){return t.stopPropagation(),e.showMemu("preferenceMenuVisible")}}},[n("span",[e._v("Preference")]),e.preferenceMenuVisible?n("Menu",{attrs:{hoverCheck:!0,menuList:e.preferenceMenuList,styles:{left:0,top:e._top}},on:{change:e.onPreferenceMenuChange}}):e._e()],1)]),"app"===e.mode?n("div",{staticClass:"bar-right"},[n("div",{staticClass:"bar-item my-hover",staticStyle:{width:"35px",height:"35px"},on:{click:e.onMinimize}},[n("span",{staticClass:"iconfont icon-zuixiaohua"})]),e.maximize?n("div",{staticClass:"bar-item my-hover",staticStyle:{width:"35px",height:"35px"},on:{click:e.onUnmaximize}},[n("span",{staticClass:"iconfont icon-huanyuan"})]):n("div",{staticClass:"bar-item my-hover",staticStyle:{width:"35px",height:"35px"},on:{click:e.onMaximize}},[n("span",{staticClass:"iconfont icon-zuidahua"})]),n("div",{staticClass:"bar-item my-hover-danger",staticStyle:{width:"35px",height:"35px"},on:{click:e.onClose}},[n("span",{staticClass:"iconfont icon-close",staticStyle:{"font-size":"18px"}})])]):e._e()])])},rt=[],at=function(){function e(t){(0,B.Z)(this,e),this.initProperties(t)}return(0,D.Z)(e,[{key:"initProperties",value:function(e){Z.defineProperties(this,e,["openFile","openFolder"])}},{key:"onKeyDown",value:function(e){if(e.ctrlKey)if(this.pressK)switch(this.pressK=!1,e.keyCode){case 79:e.preventDefault(),this.openFolder();break}else switch(e.keyCode){case 75:e.preventDefault(),this.pressK=!0;break;case 78:e.preventDefault(),this.openFile();break;case 79:e.preventDefault(),this.openFile(null,!0);break}}}]),e}(),ct=window.require||window.parent.require||function(){},lt=ct("@electron/remote"),ut=lt&&lt.getCurrentWindow(),ht={name:"TitleBar",props:{height:{type:Number,default:25}},components:{Menu:L},data:function(){return{fileMenuVisible:!1,editMenuVisible:!1,selectionMenuVisible:!1,preferenceMenuVisible:!1,maximize:!1,mode:lt?"app":"web",fileMenuList:[[{name:"New File",op:"newFile",shortcut:"Ctrl+N"}]],editMenuList:[[{name:"Undo",op:"undo",shortcut:"Ctrl+Z"},{name:"Redo",op:"redo",shortcut:"Ctrl+Y"}],[{name:"Cut",op:"cut",shortcut:"Ctrl+X"},{name:"Copy",op:"copy",shortcut:"Ctrl+C"},{name:"Paste",op:"paste",shortcut:"Ctrl+V"}],[{name:"Delete Line",op:"deleteLine",shortcut:"Ctrl+Shift+K"}],[{name:"Find",op:"find",shortcut:"Ctrl+F"},{name:"Replace",op:"replace",shortcut:"Ctrl+H"}]],selectionMenuList:[[{name:"Select All",op:"selectAll",shortcut:"Ctrl+A"}],[{name:"Copy Line Up",op:"copyLineUp",shortcut:"Ctrl+Shift+D"},{name:"Copy Line Down",op:"copyLineDown",shortcut:"Alt+Shift+Down"},{name:"Move Line Up",op:"moveLineUp",shortcut:"Ctrl+Shift+Up"},{name:"Move Line Down",op:"moveLineDown",shortcut:"Ctrl+Shift+Down"}],[{name:"Add Cursor Above",op:"addCursorAbove",shortcut:"Ctrl+Alt+Up"},{name:"Add Cursor Below",op:"addCursorBelow",shortcut:"Ctrl+Alt+Down"},{name:"Add Cursor to Line Ends",op:"addCursorLineEnds",shortcut:"Ctrl+Shift+L"},{name:"Add Next Occurence",op:"addNextOccurence",shortcut:"Ctrl+D"},{name:"Add Previous Occurence",op:"addPrevOccurence",shortcut:"Shift+D"},{name:"Select All Occurence",op:"selectAllOccurence"}],[{name:"Switch Alt+Click to Multi-Cursor",op:"switchMultiKeyCode",keyCode:"ctrl"}]],preferenceMenuList:[[{name:"Color Theme",op:"changeTheme"},{name:"Icon Theme",op:"changeIconTheme"}]]}},computed:{_top:function(){return this.height+2+"px"},editor:function(){return this.getNowEditor()},context:function(){return this.getNowContext()}},inject:["getNowEditor","getNowContext","openFile","openFolder"],created:function(){var e=this;"app"===this.mode&&this.fileMenuList.push([{name:"Open File",op:"openFile",shortcut:"Ctrl+O"},{name:"Open Folder",op:"openFolder",shortcut:"Ctrl+K Ctrl+O"}]),this.shortcut=new at(this),this.initEventBus(),C()(window).on("keydown",(function(t){e.shortcut.onKeyDown(t)}))},mounted:function(){"app"===this.mode&&(this.maximize=ut.isMaximized())},methods:{initEventBus:function(){var e=this;E.$on("close-menu",(function(){e.fileMenuVisible=!1,e.editMenuVisible=!1,e.selectionMenuVisible=!1,e.preferenceMenuVisible=!1}))},showMemu:function(e){E.$emit("close-menu"),this[e]=!0},onMinimize:function(){ut.minimize()},onMaximize:function(){ut.maximize(),this.maximize=!0},onUnmaximize:function(){ut.unmaximize(),this.maximize=!1},onClose:function(){ut.close()},onFileMenuChange:function(e){switch(e.op){case"newFile":this.openFile();break;case"openFile":this.openFile(null,!0);break;case"openFolder":this.openFolder();break}this.fileMenuVisible=!1},onEditMenuChange:function(e){var t=this;if(this.editor){switch(e.op){case"undo":this.editor.history.undo();break;case"redo":this.editor.history.redo();break;case"cut":Z.writeClipboard(this.context.getCopyText(!0));break;case"copy":Z.writeClipboard(this.context.getCopyText());break;case"paste":Z.readClipboard().then((function(e){t.context.insertContent(e)}));break;case"deleteLine":this.context.deleteLine();break;case"find":this.editor.openSearch();break;case"replace":this.editor.openSearch(!0);break}this.editor.focus(),this.editMenuVisible=!1}else this.editMenuVisible=!1},onSelectionMenuChange:function(e){if(this.editor){switch(e.op){case"selectAll":this.editor.selecter.selectAll();break;case"copyLineUp":this.context.copyLineUp();break;case"copyLineDown":this.context.copyLineDown();break;case"moveLineUp":this.context.moveLineUp();break;case"moveLineDown":this.context.moveLineDown();break;case"addCursorAbove":this.editor.cursor.addCursorAbove();break;case"addCursorBelow":this.editor.cursor.addCursorBelow();break;case"addCursorLineEnds":this.editor.cursor.addCursorLineEnds();break;case"addNextOccurence":this.editor.searchWord("down");break;case"addPrevOccurence":this.editor.searchWord("up");break;case"selectAllOccurence":this.editor.selecter.selectAllOccurence();break;case"switchMultiKeyCode":this.editor.cursor.switchMultiKeyCode(),e.keyCode=this.editor.cursor.multiKeyCode,e.name="Switch ".concat("alt"===e.keyCode?"Ctrl":"Alt","+Click to Multi-Cursor");break}this.editor.focus(),this.selectionMenuVisible=!1}else this.selectionMenuVisible=!1},onPreferenceMenuChange:function(e){switch(e.op){case"changeTheme":this.$emit("change",e);break;case"changeIconTheme":this.$emit("change",e)}this.preferenceMenuVisible=!1}}},dt=ht,ft=(0,c.Z)(dt,ot,rt,!1,null,null,null),mt=ft.exports,pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-status-bar my-width-100",style:{height:e.height+"px"},on:{contextmenu:function(e){e.stopPropagation(),e.preventDefault()}}},[n("div",{staticClass:"my-height-100 my-center-between"},[n("div",{staticClass:"bar-left"},[e.hasEditor?n("div",{staticClass:"bar-item"},[n("span",[e._v("Line "+e._s(e.line)+", Column "+e._s(e.column))])]):e._e()]),n("div",{staticClass:"bar-right"},[e.hasEditor?n("div",{staticClass:"bar-item my-hover",on:{mousedown:function(t){return t.stopPropagation(),e.showTabsize.apply(null,arguments)}}},[n("span",[e._v("Tab Size:"+e._s(e.tabSize))]),n("div",{staticClass:"my-list",staticStyle:{position:"absolute",bottom:"30px"}},[e.tabsizeVisible?n("Menu",{attrs:{menuList:e.tabSizeList,styles:{position:"relative"},value:e.tabSize},on:{change:e.onTabsizeChange}}):e._e()],1)]):e._e(),e.hasEditor?n("div",{staticClass:"bar-item my-hover",on:{mousedown:function(t){return t.stopPropagation(),e.showLanguage.apply(null,arguments)}}},[n("span",[e._v(e._s(e.nowLanguage))])]):e._e()])])])},gt=[],vt={name:"StatusBar",props:{height:{type:Number,default:25},languageList:Array},components:{Menu:L},data:function(){return{line:1,column:0,tabSize:4,language:"",tabsizeVisible:!1,hasEditor:!1,tabSizeList:[],languages:[[]],languageMap:{}}},watch:{languageList:function(){var e={};this.languageList.forEach((function(t){e[t.value]=t.name})),this.languages=[this.languageList],this.languageMap=e}},computed:{nowLanguage:function(){return this.languageMap[this.language]}},created:function(){this.initEventBus();for(var e=1;e<=8;e++)this.tabSizeList.push({name:"Tab Width：".concat(e),value:e})},mounted:function(){},methods:{initEventBus:function(){var e=this;E.$on("tab-change",(function(t){t?(e.language=t.language,e.tabSize=t.tabSize,e.line=t.line,e.column=t.column,e.hasEditor=!0):e.hasEditor=!1})),E.$on("cursor-change",(function(t){e.line=t.line,e.column=t.column})),E.$on("language-change",(function(t){e.language=t})),E.$on("close-menu",(function(t){e.tabsizeVisible=!1}))},showTabsize:function(){var e=this.tabsizeVisible;E.$emit("close-menu"),this.tabsizeVisible=!e},showLanguage:function(){E.$emit("close-menu"),this.$emit("select-langeuage")},onTabsizeChange:function(e){this.tabSize!=e.value&&(E.$emit("tab-size-change",e.value),this.tabSize=e.value),this.tabsizeVisible=!1}}},yt=vt,Ct=(0,c.Z)(yt,pt,gt,!1,null,null,null),kt=Ct.exports,xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"sideBar",staticClass:"my-side-bar",style:{width:e.width+"px"},on:{contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.onContextmenu.apply(null,arguments)},selectstart:function(e){e.preventDefault()}}},[n("div",{staticClass:"my-height-100",staticStyle:{overflow:"hidden"}},[n("div",{staticClass:"side-bar-title my-shadow"},[e._v("EXPLORER")]),n("side-tree",{attrs:{list:e.list}})],1),n("SideBarMenu",{ref:"sideBarMenu"}),n("div",{staticClass:"my-sash-v",on:{mousedown:e.onSashBegin}})],1)},bt=[],wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"wrap",staticClass:"side-tree-warp my-scroll-overlay",on:{scroll:e.onScroll}},[n("div",{staticStyle:{width:"100%",overflow:"hidden"}},[n("div",{staticClass:"side-tree",style:{height:e._scrollHeight}},[n("div",{staticClass:"side-tree-content",style:{top:e._top}},e._l(e.renderList,(function(t){return n("div",{staticClass:"tree-item",on:{click:function(n){return n.stopPropagation(),e.onClickItem(t)}}},[n("div",{staticClass:"tree-item-title my-center-start",class:[t.active?"my-active":""],style:{"padding-left":e._paddingLeft(t)},attrs:{title:t.path},on:{contextmenu:function(e){e.stopPropagation(),e.preventDefault()}}},["dir"===t.type?[t.open?n("span",{staticClass:"left-icon iconfont icon-down1"}):n("span",{staticClass:"left-icon iconfont icon-right"})]:e._e(),n("div",{staticClass:"tree-item-content my-center-start",class:[t.icon]},[n("span",{staticClass:"tree-item-text",staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.name))])])],2)])})),0)])])])},Tt=[],Lt=window.require||window.parent.require||function(){},Pt=null,Et={name:"SideTree",props:{list:{type:Array}},inject:["openFile"],data:function(){return{itemHeight:30,itemPadding:16,openedList:[],renderList:[],startLine:1,maxVisibleLines:100}},computed:{_top:function(){return(this.startLine-1)*this.itemHeight+"px"},_scrollHeight:function(){return this.openedList.length*this.itemHeight+"px"},_paddingLeft:function(){return function(e){return e.deep*this.itemPadding+"px"}}},watch:{list:function(){this.openedList=[],this.renderList=[],this.openedList=this.getRenderList(this.list,0),this.render()}},created:function(){this.openedList=this.getRenderList(this.list,0),this.initEventBus()},mounted:function(){this.maxVisibleLines=Math.ceil(this.$refs.wrap.clientHeight/this.itemHeight)+1,this.render()},methods:{initEventBus:function(){var e=this;E.$on("icon-change",(function(){e.openedList.forEach((function(e){e.icon=""})),e.render()})),E.$on("theme-change",(function(){e.openedList.forEach((function(e){e.icon=""})),e.render()})),E.$on("tab-change",(function(t){var n=t&&t.path;n&&Pt&&Pt.path!==n?(Pt.active=!1,e.focusItem(n)):!n&&Pt&&(Pt.active=!1,Pt=null)}))},render:function(){this.renderList=this.openedList.slice(this.startLine-1,this.startLine-1+this.maxVisibleLines),this.renderList.forEach((function(e){j.nowIconData&&(e.icon=Z.getIconByPath(j.nowIconData,e.path,j.nowTheme.type,e.type,e.open),e.icon=e.icon?"my-file-icon my-file-icon-".concat(e.icon):"")}))},readdir:function(e){var t=this,n=Lt("fs"),i=Lt("path");return new Promise((function(s){var o=[];n.readdir(e,{encoding:"utf8"},(function(r,a){if(r)throw r;a.forEach((function(r,c){var l=i.join(e,r),u=n.statSync(l),h={name:r,path:l,parentPath:e,active:!1,children:[]};u.isFile()?h.type="file":(h.type="dir",h.open=!1),o.push(h),c===a.length-1&&s(t.sortFileList(o))}))}))}))},sortFileList:function(e){return e.sort((function(e,t){return"dir"===e.type&&"file"===t.type?-1:"file"===e.type&&"dir"===t.type||e.name>t.name?1:e.name<t.name?-1:0})),e},getRenderList:function(e,t){var n=[];return i(e,t),n;function i(e,t){e.forEach((function(e){e.deep=t+1,n.push(e),e.open&&e.children.length&&i(e.children,e.deep)}))}},focusItem:function(e){var t=0;function n(e){for(var i=this,s=t;s<this.openedList.length;s++){var o=this.openedList[s];if(o.path===e){var r=this.$refs.wrap,a=r.scrollTop,c=r.clientHeight,l=(s+1)*this.itemHeight;a+c<l?r.scrollTop=l-c:a+this.itemHeight>l&&(r.scrollTop=l-this.itemHeight),o.active||this.onClickItem(o);break}if(e.startsWith(o.path)&&!o.open){t=s+1,this.onClickItem(o).then((function(){n.call(i,e)}));break}}}n.call(this,e)},onClickItem:function(e){var t=this;if(e.active)"dir"===e.type&&(e.open=!e.open,n.call(this,e));else if(Pt&&(Pt.active=!1),e.active=!0,Pt=e,"dir"===e.type){if(e.open=!e.open,!e.loaded)return this.readdir(e.path).then((function(i){e.children=i,e.loaded=!0,i.forEach((function(t){t.deep=e.deep+1})),n.call(t,e)}));n.call(this,e)}else this.openFile(e);return Promise.resolve();function n(e){if(e.children.length){if(e.open){var t=this.openedList.indexOf(e);this.openedList=this.openedList.slice(0,t+1).concat(this.getRenderList(e.children,e.deep)).concat(this.openedList.slice(t+1))}else{var n=this.openedList.indexOf(e)+1,i=n;while(i<this.openedList.length&&this.openedList[i].parentPath!=e.parentPath)i++;this.openedList.splice(n,i-n)}this.render()}}},onScroll:function(e){var t=e.target.scrollTop;this.startLine=Math.floor(t/this.itemHeight)+1,this.render()}}},St=Et,_t=(0,c.Z)(St,wt,Tt,!1,null,null,null),It=_t.exports,Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],ref:"wrap"},[n("Menu",{ref:"menu",attrs:{checkable:!1,menuList:e.menuList,styles:e.menuStyle},on:{change:e.onMenuChange}})],1)},Bt=[],Dt={components:{Menu:L},data:function(){return{list:[],menuList:[],menuVisible:!1,menuStyle:{left:"10px",top:"40px"}}},provide:function(){return{rootList:this.list}},created:function(){this.initEventBus()},methods:{initEventBus:function(){var e=this;E.$on("close-menu",(function(){e.menuVisible=!1})),E.$on("open-side-menu",(function(){e.menuVisible=!0}))},show:function(e){var t=this,n=C()(this.$refs.wrap).parent();this.$nextTick((function(){var i=0;t.$refs.menu.$el.clientWidth,i=t.$refs.menu.$el.clientHeight;var s=n.offset();i+e.clientY>s.top+n.height()?t.menuStyle.top=e.clientY-s.top-i+"px":t.menuStyle.top=e.clientY-s.top+"px",t.menuStyle.left=e.clientX-s.left+"px"}))},onMenuChange:function(e){switch(e.op){}this.menuVisible=!1}}},Ft=Dt,At=(0,c.Z)(Ft,Mt,Bt,!1,null,null,null),Nt=At.exports,Ot={components:{SideTree:It,SideBarMenu:Nt},data:function(){return{width:300,list:[]}},provide:function(){var e=this;return{getRootList:function(){return e.list}}},mounted:function(){this.initEvent()},methods:{initEvent:function(){var e=this;C()(document).on("mousemove",(function(t){if(e.mouseObj){var n=e.width+=t.clientX-e.mouseObj.clientX,i=C()(e.$refs.sideBar).parent().width();n=n<10?10:n,n=n>i-10?i-10:n,e.width=n,e.mouseObj=t}})).on("mouseup",(function(t){e.mouseObj=null}))},onContextmenu:function(e){},onSashBegin:function(e){this.originMouseObj=e,this.mouseObj=e}}},Wt=Ot,$t=(0,c.Z)(Wt,xt,bt,!1,null,null,null),Rt=$t.exports,jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.overlay?n("div",{staticClass:"my-dialog-overlay"}):e._e(),n("div",{staticClass:"my-dialog",style:e.styles,on:{mousedown:function(e){e.stopPropagation()}}},[n("div",{staticClass:"dialog-title"},[n("div",{domProps:{innerHTML:e._s(e.title)}}),n("span",{staticClass:"dialog-close iconfont icon-close",on:{click:e.onClose}})]),n("div",{staticClass:"dialog-content"},[e.icon?n("span",{class:[e.icon],staticStyle:{"margin-right":"5px",width:"30px",height:"30px"}}):e._e(),n("div",[n("div",{domProps:{innerHTML:e._s(e.content)}})])]),n("div",{staticClass:"dialog-btns"},[e._l(e.btns,(function(t){return n("div",{staticClass:"dialog-btn",on:{click:function(n){return e.onClickBtn(t)}}},[e._v(e._s(t.name))])})),n("div",{staticClass:"dialog-btn",on:{click:function(t){return e.onClose()}}},[e._v("取消")])],2)])])},Ht=[],zt={name:"Dialog",props:{title:String,content:String,btns:Array,overlay:Boolean,styles:Object,icon:String,iconColor:String},data:function(){return{}},created:function(){},methods:{onClickBtn:function(e){e.callback()},onClose:function(){this.$emit("close")}}},Vt=zt,Kt=(0,c.Z)(Vt,jt,Ht,!1,null,null,null),Zt=Kt.exports,Ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],ref:"wrap"},[n("Menu",{ref:"menu",attrs:{checkable:!1,menuList:e.menuList,styles:e.menuStyle},on:{change:e.onMenuChange}})],1)},Yt=[],qt={name:"WindowMenu",components:{Menu:L},props:{styles:{type:Object}},data:function(){return{menuList:[],menuVisible:!1,menuStyle:{left:"50%",top:"50%"}}},created:function(){this.initEventBus()},methods:{initEventBus:function(){var e=this;E.$on("close-menu",(function(){e.menuVisible=!1})),E.$on("open-win-menu",(function(){e.menuVisible=!0}))},onMenuChange:function(e){switch(e.op){}this.menuVisible=!1},show:function(e){var t=this;this.menuVisible=!0,this.$nextTick((function(){var n=C()(t.$refs.wrap).parent(),i=n.offset(),s=t.$refs.menu.$el.clientWidth,o=t.$refs.menu.$el.clientHeight;o+e.clientY>i.top+n[0].clientHeight?t.menuStyle.top=e.clientY-i.top-o+"px":t.menuStyle.top=e.clientY-i.top+"px",s+e.clientX>i.left+n[0].clientWidth?t.menuStyle.left=e.clientX-i.left-s+"px":t.menuStyle.left=e.clientX-i.left+"px"}))},hide:function(){this.menuVisible=!1}}},Gt=qt,Xt=(0,c.Z)(Gt,Ut,Yt,!1,null,null,null),Jt=Xt.exports,Qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.visible?n("div",{staticClass:"my-cmd-panel my-list",on:{mousedown:function(e){e.stopPropagation()}}},[n("div",[n("div",{staticClass:"my-cmd-search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],ref:"input",attrs:{type:"text"},domProps:{value:e.searchText},on:{input:function(t){t.target.composing||(e.searchText=t.target.value)}}})]),n("div",[n("Menu",{staticClass:"my-scroll-overlay my-scroll-mini",staticStyle:{position:"relative"},attrs:{checkable:!0,menuList:e.cmdList,value:e.value,spellcheck:"false"},on:{change:e.onChange}})],1)])]):e._e()},en=[],tn=n(2942),nn=n(266),sn=n.n(nn),on=window.require||window.parent.require||function(){},rn=on("path"),an={foreground:"color",background:"background-color",fontStyle:"font-style"},cn=function(){function e(){(0,B.Z)(this,e)}return(0,D.Z)(e,[{key:"loadTheme",value:function(e){var t=this,n={tokenColors:[],colors:{}};return i.call(this,e.path).then((function(){var i="";t.setDefaultColor(n,e.type),i=t.parseCss(n),t.insertCss(i),j.nowTheme={value:e.value,type:e.type,path:e.path},E.$emit("theme-change",e.value)}));function i(e){var t=this;return Z.loadJsonFile(e).then((function(n){if(n.include)return i.call(t,rn.join(e,"../"+n.include)).then((function(){s(n)}));s(n)}))}function s(e){var t;e.tokenColors&&(t=n.tokenColors).push.apply(t,(0,tn.Z)(e.tokenColors)),e.colors&&Object.assign(n.colors,e.colors)}}},{key:"loadIconTheme",value:function(e){if(!e.path)return j.nowIconTheme={value:e.value},j.nowIconData=null,void E.$emit("icon-change");var t=j.languageList,n={};return t.forEach((function(e){e.extensions&&(n[e.value]=e.extensions.map((function(e){return e.slice(1)})))})),i.call(this,e.path);function i(t){var n=this;return Z.loadJsonFile(t).then((function(i){var o=i.fonts||[],r="";for(var a in o.forEach((function(e){var n="@font-face{\nsrc:";e.src.forEach((function(i,s){var o=rn.join(t,"../"+i.path);o=o.replace(/\\/g,"/"),n+="url('my-file://".concat(o,"')"),n+=" format('".concat(i.format,"')"),n+=s<e-i.length-1?", ":""})),n+=";\n",n+="font-family:".concat(e.id,";\n"),n+="font-style:".concat(e.style,";\n"),n+="font-weight:".concat(e.weight,";\n"),n+="}\n",r+=n,r+=".my-file-icon::before{\n",r+="font-family:".concat(e.id,";\n"),r+="font-size:".concat(e.size,";\n"),r+="}\n"})),i.iconDefinitions){if(r+=".my-file-icon-".concat(a,"::before{\n"),a=i.iconDefinitions[a],a.fontCharacter)r+="margin-top:3px;",r+='content:"'.concat(a.fontCharacter,'";\n'),r+="color:".concat(a.fontColor,";\n");else if(a.iconPath){var c=rn.join(t,"../"+a.iconPath);c=c.replace(/\\/g,"/"),r+='content:"";',r+="background-image:url(my-file://".concat(c,")")}r+="}\n"}n.insertFont(r),i.fileNames=i.fileNames||{},i.fileExtensions=i.fileExtensions||{},s(i),j.nowIconTheme={value:e.value,path:e.path},j.nowIconData=i,E.$emit("icon-change",e.value)}))}function s(e){if(e.languageIds&&o(e.languageIds,e.fileExtensions),e.light){for(var t in e.light.fileExtensions=e.light.fileExtensions||{},e.light.fileNames=e.light.fileNames||{},e.light.languageIds&&o(e.light.languageIds,e.light.fileExtensions),e.fileExtensions)e.light.fileExtensions[t]=e.light.fileExtensions[t]||e.fileExtensions[t];for(var n in e.fileNames)e.light.fileNames[n]=e.light.fileNames[n]||e.fileNames[n]}else e.light={fileExtensions:e.fileExtensions,fileNames:e.fileNames}}function o(e,t){var i=function(i){var s=n[i],o=e[i];s&&s.forEach((function(e){t[e]=o}))};for(var s in e)i(s)}}},{key:"parseCss",value:function(e){var t="",n=1,i=[],s=/\./g,o=/\s+/g;if(e.colors){for(var r in t+=":root{\n",e.colors)t+="--my-".concat(r.replace(/\./g,"-"),": ").concat(e.colors[r],";\n");t+="}\n"}return e.tokenColors&&e.tokenColors.forEach((function(e){if(e.scope){var s=[],o=e.scope instanceof Array?e.scope.join(","):e.scope;for(var r in o=o.replace(/\s+/g," "),o=o.split(/\s*\,\s*/),o.forEach((function(e,t){s.push(".my-scope-".concat(n)),i.push({scopeId:n,scope:e,scopes:e.split(" "),level:a(e)}),n++})),s=s.join(","),t+="".concat(s,"{\n"),e.settings)t+="".concat(an[r],":").concat(e.settings[r],";\n");t+="}\n"}})),i.sort((function(e,t){return t.level-e.level})),i.forEach((function(e){e.scopes.length>1?e.regexp=e.scopes.join("(?:\\.[^\\.\\s]+)*?(?:\\s[^\\s]+)*? "):e.regexp=e.scope,e.regexp=new RegExp(e.regexp)})),j.scopeTokenList=i,j.colors=e.colors,t;function a(e){var t=e.match(s),n=e.match(o);return t=t&&t.length||0,n=n&&1e3*n.length||0,t+n}}},{key:"insertCss",value:function(e){j.themeStyle&&j.themeStyle.remove(),j.themeStyle=document.createElement("style"),j.themeStyle.type="text/css",j.themeStyle.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(j.themeStyle)}},{key:"insertFont",value:function(e){j.iconStyle&&j.iconStyle.remove(),j.iconStyle=document.createElement("style"),j.iconStyle.type="text/css",j.iconStyle.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(j.iconStyle)}},{key:"setDefaultColor",value:function(e,t){var n="transparent",i="",s="",o="",r="",a="",c="light"===t||"contrast light"===t,l="contrast light"===t||"contrast dark"===t;function u(){e.colors["foreground"]||(e.colors["editor.foreground"]?e.colors["foreground"]=sn()(e.colors["editor.foreground"]).alpha(.8).css():e.colors["foreground"]=c?"#575757":"rgb(221, 221, 221)"),e.colors["errorForeground"]||(e.colors["errorForeground"]="#ff0000"),e.colors["background"]||(e.colors["editor.background"]?e.colors["background"]=sn()(e.colors["editor.background"]).alpha(.8).css():e.colors["background"]=c?"#fff":l?"#000":"rgba(60,60,60)"),e.colors["focusBorder"]||(e.colors["focusBorder"]=l?c?"#0f4a85":"#f38518":"#0066b8"),e.colors["contrastBorder"]||(e.colors["contrastBorder"]=l?c?"#0f4a85":"#6fc3df":n),e.colors["contrastActiveBorder"]||(e.colors["contrastActiveBorder"]=l?e.colors["focusBorder"]:n),e.colors["widget.shadow"]||(e.colors["widget.shadow"]=l?n:c?"rgba(0,0,0,0.16)":"rgba(0,0,0,0.36)"),e.colors["sash.hoverBorder"]||(e.colors["sash.hoverBorder"]=l?e.colors["contrastActiveBorder"]:e.colors["focusBorder"]),e.colors["selection.background"]||(e.colors["selection.background"]=e.colors["focusBorder"]),s=e.colors["background"],i=e.colors["foreground"],o=e.colors["focusBorder"],r=e.colors["contrastBorder"],a=e.colors["contrastActiveBorder"]}function h(){e.colors["scrollbar.shadow"]||(e.colors["scrollbar.shadow"]=n),e.colors["scrollbarSlider.background"]||(e.colors["scrollbarSlider.background"]=l?sn()(r).alpha(.6).css():c?"rgba(100, 100, 100, 0.4)":"rgba(121, 121, 121, 0.4);"),e.colors["scrollbarSlider.hoverBackground"]||(e.colors["scrollbarSlider.hoverBackground"]=l?sn()(r).alpha(.8).css():c?"rgba(100, 100, 100, 0.7)":"rgba(100, 100, 100, 0.7);"),e.colors["scrollbarSlider.activeBackground"]||(e.colors["scrollbarSlider.activeBackground"]=l?r:c?"rgba(0, 0, 0, 0.6)":"rgba(191, 191, 191, 0.4);")}function d(){e.colors["titleBar.border"]||(e.colors["titleBar.border"]=r),e.colors["titleBar.activeForeground"]||(e.colors["titleBar.activeForeground"]=i),e.colors["titleBar.activeBackground"]||(l?e.colors["titleBar.activeBackground"]=n:c&&(e.colors["titleBar.activeBackground"]="rgb(221, 221, 221)")),e.colors["menubar.selectionForeground"]||(e.colors["menubar.selectionForeground"]=i),e.colors["menubar.selectionBackground"]||(e.colors["menubar.selectionBackground"]=l?n:c?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)"),e.colors["menubar.selectionBorder"]||(e.colors["menubar.selectionBorder"]=l?a:n)}function f(){e.colors["dropdown.background"]||(e.colors["dropdown.background"]=l?s:c?"#eee":"rgba(37,37,38)"),e.colors["dropdown.foreground"]||(e.colors["dropdown.foreground"]=i),e.colors["dropdown.border"]||(e.colors["dropdown.border"]=r)}function m(){e.colors["list.highlightForeground"]||(e.colors["list.highlightForeground"]=l?r:i),e.colors["list.activeSelectionBackground"]||(l?e.colors["list.activeSelectionBackground"]=n:(e.colors["list.activeSelectionBackground"]="#0066b8",e.colors["list.activeSelectionForeground"]="#fff")),e.colors["list.activeSelectionForeground"]||(e.colors["list.activeSelectionForeground"]=l?i:c?"rgba(51, 51, 51)":"rgba(255, 255, 255)"),e.colors["list.hoverForeground"]||(e.colors["list.hoverForeground"]=i),e.colors["list.hoverBackground"]||(e.colors["list.hoverBackground"]=l?n:c?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)"),e.colors["quickInputList.focusBackground"]||(e.colors["list.inactiveFocusBackground"]?e.colors["quickInputList.focusBackground"]=e.colors["list.inactiveFocusBackground"]:l?e.colors["quickInputList.focusBackground"]=n:(e.colors["quickInputList.focusBackground"]="#0066b8",e.colors["quickInputList.focusForeground"]="#fff")),e.colors["quickInputList.focusForeground"]||(e.colors["list.inactiveFocusForeground"]?e.colors["quickInputList.focusForeground"]=e.colors["list.inactiveFocusForeground"]:e.colors["quickInputList.focusForeground"]=e.colors["list.activeSelectionForeground"])}function p(){e.colors["menu.foreground"]||(e.colors["menu.foreground"]=l?i:c?"rgba(51, 51, 51)":"rgba(255, 255, 255)"),e.colors["menu.background"]||(e.colors["menu.background"]=e.colors["dropdown.background"]),e.colors["menu.border"]||(e.colors["menu.border"]=r),e.colors["menu.selectionForeground"]||(e.colors["menu.selectionForeground"]=e.colors["list.activeSelectionForeground"]),e.colors["menu.selectionBackground"]||(e.colors["menu.selectionBackground"]=e.colors["list.activeSelectionBackground"]),e.colors["menu.selectionBorder"]||(e.colors["menu.selectionBorder"]=a),e.colors["menu.separatorBackground"]||(e.colors["menu.separatorBackground"]=l?r:c?"rgba(0,0,0,0.2)":"rgba(255,255,255,0.2)")}function g(){e.colors["statusBar.foreground"]||(e.colors["statusBar.foreground"]=l?i:"#fff"),e.colors["statusBar.background"]||(e.colors["statusBar.background"]=c&&!l?"rgb(0, 122, 204)":n),e.colors["statusBar.border"]||(e.colors["statusBar.border"]=r),e.colors["statusBarItem.hoverBackground"]||(e.colors["statusBarItem.hoverBackground"]=n),e.colors["statusBarItem.activeBackground"]||(e.colors["statusBarItem.activeBackground"]=n)}function v(){e.colors["sideBar.foreground"]||(e.colors["sideBar.foreground"]=i),e.colors["sideBarTitle.foreground"]||(e.colors["sideBarTitle.foreground"]=i),e.colors["sideBar.background"]||(e.colors["sideBar.background"]=l?n:c?"#eee":"rgba(37,37,38)"),e.colors["sideBar.border"]||(e.colors["sideBar.border"]=r)}function y(){e.colors["editor.foreground"]||(e.colors["editor.foreground"]=i),e.colors["editor.background"]||(e.colors["editor.background"]=l?s:c?"#fff":"rgb(30,30,30)"),e.colors["editorLineNumber.foreground"]||(e.colors["editorLineNumber.foreground"]=sn()(e.colors["editor.foreground"]).alpha(.5).css()),e.colors["editorLineNumber.activeForeground"]||(e.colors["editorLineNumber.activeForeground"]=e.colors["editor.foreground"]),e.colors["editorCursor.foreground"]||(e.colors["editorCursor.foreground"]=e.colors["editor.foreground"]),e.colors["editor.selectionForeground"]||l&&(e.colors["editor.selectionForeground"]=i),e.colors["editor.selectionBackground"]||(e.colors["editor.selectionBackground"]=l?o:sn()(o).alpha(.8).css()),e.colors["editor.selectionHighlightBackground"]||(e.colors["editor.selectionHighlightBackground"]=n),e.colors["editor.selectionHighlightBorder"]||(l?e.colors["editor.selectionHighlightBorder"]=a:e.colors["editor.selectionHighlightBackground"]===n&&(e.colors["editor.selectionHighlightBorder"]=o)),e.colors["editor.findMatchBackground"]||(e.colors["editor.findMatchBackground"]=e.colors["editor.selectionBackground"]),e.colors["editor.findMatchBorder"]||(e.colors["editor.findMatchBorder"]=n),e.colors["editor.findMatchHighlightBackground"]||(e.colors["editor.findMatchHighlightBackground"]=e.colors["editor.selectionHighlightBackground"]),e.colors["editor.findMatchHighlightBorder"]||(e.colors["editor.findMatchHighlightBorder"]=e.colors["editor.selectionHighlightBorder"]),e.colors["editor.lineHighlightBackground"]||(e.colors["editor.lineHighlightBackground"]=n),e.colors["editor.lineHighlightBorder"]||(e.colors["editor.lineHighlightBackground"]!==n?e.colors["editor.lineHighlightBorder"]=n:e.colors["editor.lineHighlightBorder"]=l?a:c?"rgba(0,0,0,0.2)":"rgba(255,255,255,0.1)"),e.colors["editorWhitespace.foreground"]||(e.colors["editorWhitespace.foreground"]=l?e.colors["editor.foreground"]:c?"rgba(0,0,0,0.2)":"rgba(255,255,255,0.1)"),e.colors["editorIndentGuide.background"]||(e.colors["editorIndentGuide.background"]=e.colors["editorWhitespace.foreground"]),e.colors["editorBracketMatch.background"]||(e.colors["editorBracketMatch.background"]=n),e.colors["editorBracketMatch.border"]||(e.colors["editorBracketMatch.background"]===n?e.colors["editorBracketMatch.border"]=sn()(e.colors["editor.foreground"]).alpha(.6).css():e.colors["editorBracketMatch.border"]=n)}function C(){e.colors["editorGroupHeader.tabsBackground"]||(e.colors["editorGroupHeader.tabsBackground"]=l?n:e.colors["sideBar.background"]),e.colors["editorGroupHeader.tabsBackground"]||(e.colors["editorGroupHeader.tabsBackground"]=r),e.colors["tab.border"]||(e.colors["tab.border"]=r),e.colors["tab.activeForeground"]||(e.colors["tab.activeForeground"]=l?i:c?"rgba(51, 51, 51)":"#fff"),e.colors["tab.activeBackground"]||(e.colors["tab.activeBackground"]=e.colors["editor.background"]),e.colors["tab.inactiveForeground"]||(e.colors["tab.inactiveForeground"]=l?i:c?"rgba(51, 51, 51, 0.7)":"rgba(255, 255, 255, 0.5)"),e.colors["tab.inactiveBackground"]||(e.colors["tab.inactiveBackground"]=l?n:c?"rgb(236, 236, 236)":"rgb(45, 45, 45)"),e.colors["tab.activeBorder"]||(e.colors["tab.activeBorder"]=n),e.colors["tab.activeBorderTop"]||(e.colors["tab.activeBorderTop"]=n),e.colors["tab.hoverForeground"]||(e.colors["tab.hoverForeground"]=e.colors["tab.inactiveForeground"]),e.colors["tab.hoverBackground"]||(e.colors["tab.hoverBackground"]=n),e.colors["tab.hoverBorder"]||(e.colors["tab.hoverBorder"]=n)}function k(){e.colors["editorWidget.foreground"]||(e.colors["editorWidget.foreground"]=e.colors["editor.foreground"]),e.colors["editorWidget.background"]||(e.colors["editorWidget.background"]=l?s:c?"#eee":"rgb(37,37,38)"),e.colors["editorWidget.border"]||(e.colors["editorWidget.border"]=l?r:n),e.colors["editorSuggestWidget.foreground"]||(e.colors["editorSuggestWidget.foreground"]=e.colors["editorWidget.foreground"]),e.colors["editorSuggestWidget.background"]||(e.colors["editorSuggestWidget.background"]=e.colors["editorWidget.background"]),e.colors["editorSuggestWidget.border"]||(e.colors["editorSuggestWidget.border"]=e.colors["editorWidget.border"]),e.colors["editorSuggestWidget.border"]===n?e.colors["editorSuggestWidget.shadow"]=e.colors["widget.shadow"]:e.colors["editorSuggestWidget.shadow"]=n,e.colors["editorSuggestWidget.selectedForeground"]||(e.colors["editorSuggestWidget.selectedForeground"]=e.colors["editor.foreground"]),e.colors["editorSuggestWidget.selectedBackground"]||(e.colors["editorSuggestWidget.selectedBackground"]=e.colors["quickInputList.focusBackground"]),e.colors["editorSuggestWidget.highlightForeground"]||(e.colors["editorSuggestWidget.highlightForeground"]=e.colors["list.highlightForeground"]),e.colors["editorSuggestWidget.focusHighlightForeground"]||(e.colors["editorSuggestWidget.focusHighlightForeground"]=e.colors["list.highlightForeground"])}function x(){e.colors["input.foreground"]||(e.colors["input.foreground"]=i),e.colors["input.background"]||(e.colors["input.background"]=l?n:c?"#fff":s),e.colors["input.border"]||(e.colors["input.background"]===n?e.colors["input.border"]="#0066b8":e.colors["input.border"]=n),e.colors["inputOption.activeForeground"]||(e.colors["inputOption.activeForeground"]=i),e.colors["inputOption.activeBackground"]||(e.colors["inputOption.activeBackground"]=l?n:sn()(o).alpha(.3).css()),e.colors["inputOption.activeBorder"]||(e.colors["inputOption.activeBorder"]=n),e.colors["inputOption.hoverBackground"]||(e.colors["inputOption.hoverBackground"]=l?n:c?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)")}function b(){e.colors["toolbar.hoverBackground"]||(e.colors["toolbar.hoverBackground"]=l?n:c?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)"),e.colors["toolbar.activeBackground"]||(e.colors["toolbar.activeBackground"]=n),e.colors["toolbar.hoverOutline"]||(e.colors["toolbar.hoverOutline"]=a)}u(),h(),d(),f(),m(),p(),g(),v(),y(),C(),k(),x(),b()}}]),e}(),ln={name:"CmdPanel",components:{Menu:L},data:function(){return{searchText:"",cmdList:[],visible:!1}},watch:{searchText:function(){this.searchMenu()}},created:function(){this.theme=new cn,this.initEventBus()},methods:{initEventBus:function(){var e=this;E.$on("close-menu",(function(){e.visible=!1})),E.$on("open-cmd-menu",(function(t){e.visible=!0,e.searchText="",e.originCmdList=t.cmdList,e.value=t.value,!e.originCmdList[0]||e.originCmdList[0]instanceof Array||(e.originCmdList=[e.originCmdList]),e.searchMenu(),requestAnimationFrame((function(){e.$refs.input.focus()}))}))},searchMenu:function(){var e=this;if(this.searchText){var t=[];this.originCmdList[0].forEach((function(n){var i=Z.fuzzyMatch(e.searchText,n.name,!0);i&&t.push([n,i])})),t=t.sort((function(e,t){return t[1].score-e[1].score})).map((function(e){return e[0]})),this.cmdList=[t]}else this.cmdList=this.originCmdList.slice()},onChange:function(e){switch(e.op){case"changeTheme":this.theme.loadTheme(e);break;case"changeIconTheme":this.theme.loadIconTheme(e);break;case"selectLanguage":E.$emit("language-change",e.value);break}this.visible=!1}}},un=ln,hn=(0,c.Z)(un,Qt,en,!1,null,null,null),dn=hn.exports,fn=window.require||window.parent.require||function(){},mn=fn("fs"),pn=fn("path"),gn=fn("@electron/remote"),vn=Fe.contexts,yn={components:{Editor:st,EditorBar:X,TitleBar:mt,StatusBar:kt,SideBar:Rt,Dialog:Zt,WindowMenu:Jt,CmdPanel:dn},data:function(){return{extensionsPath:pn.join(j.dirname,"main/extensions"),languageList:[],statusHeight:30,topBarHeight:35,nowId:null,idCount:1,titleCount:1,editorList:[],dialogTilte:"",dialogContent:"",dialogVisible:!1,dialogBtns:[],dialogIcon:"",dialogIconColor:"",mode:gn?"app":"mode"}},computed:{_topBarHeight:function(){return this.topBarHeight+"px"},_statusHeight:function(){return this.statusHeight+"px"}},provide:function(){var e=this;return{getNowEditor:function(){return e.getNowEditor()},getNowContext:function(){return e.getNowContext()},openFile:function(t,n){e.openFile(t,n)},openFolder:function(){e.openFolder()}}},created:function(){var e=this;if(window.globalData=j,"app"===this.mode){var t=gn.getCurrentWindow();t.on("blur",(function(){E.$emit("close-menu")}))}this.theme=new cn,this.loadExtensions().then((function(t){var n=t.languages,i=t.themes,s=t.iconThemes,o=t.scopeFileList;n.push({name:"Plain Text",value:"",checked:!0}),j.languageList=n.slice(),j.scopeFileList=o.slice(),j.themes=i.slice(),j.iconThemes=s.slice(),e.languageList=n,e.checkLanguage(),e.theme.loadTheme(j.nowTheme),e.theme.loadIconTheme(j.nowIconTheme)})),this.initEventBus()},mounted:function(){window.test=this,this.openFile()},methods:{initEventBus:function(){var e=this,t=function(t){e.editorList.forEach((function(e){if(t){var n=Z.getIconByPath(j.nowIconData,e.path,j.nowTheme.type);e.icon=n?"my-file-icon my-file-icon-".concat(n):""}else e.icon=""})),e.editorList.splice()};E.$on("icon-change",t),E.$on("theme-change",t)},onContextmenu:function(e){},onWindMouseDown:function(){E.$emit("close-menu")},onChangeTab:function(e){var t=this.getTabById(e);t.active?this.getNowEditor().focus():(this.editorList.forEach((function(e){e.active=!1})),t.active=!0,this.nowId=e,this.changeStatus())},onCloseTab:function(e){var t=this;if(this.nowId){var n=this.getTabById(e||this.nowId),i=this.editorList.indexOf(n);n.saved?s.call(this):this.showDialog({content:"文件尚未保存，是否先保存文件？",cancel:!0,icon:"my-icon-warn",iconColor:"rgba(255,196,0)",btns:[{name:"保存",callback:function(){"app"===t.mode?t.onSaveFile(e).then((function(){s.call(t),t.onDialogClose()})):(s.call(t),t.onDialogClose())}},{name:"不保存",callback:function(){s.call(t),t.onDialogClose()}}]})}function s(){this.editorList.splice(i,1),vn[e]=null,n.active?(n.active=!1,n=this.editorList[i]||this.editorList[i-1],n?this.onChangeTab(n.id):(this.nowId=null,E.$emit("tab-change",null))):this.getNowEditor().focus()}},onCloseAll:function(){var e=this;this.editorList=this.editorList.filter((function(e){return!e.saved})),this.editorList.forEach((function(t){e.onCloseTab(t.id)})),this.nowId=null},onCloseSaved:function(){var e=this;this.editorList.slice().forEach((function(t){t.saved&&e.onCloseTab(t.id)}))},onCloseToLeft:function(e){var t=null;e=e||this.nowId;while(t=this.editorList[0]){if(t.id===e)break;this.onCloseTab(t.id)}},onCloseToRight:function(e){var t=null;e=e||this.nowId;while(t=this.editorList.peek()){if(t.id===e)break;this.onCloseTab(t.id)}},onMenuChange:function(e){var t=null;switch(e.op){case"changeTheme":t=j.themes.map((function(e){return e.map((function(e){return Object.assign({op:"changeTheme"},e)}))})),E.$emit("open-cmd-menu",{cmdList:t,value:j.nowTheme.value});break;case"changeIconTheme":t=j.iconThemes.map((function(e){return Object.assign({op:"changeIconTheme"},e)})),t.push({name:"None",value:"none",op:"changeIconTheme"}),E.$emit("open-cmd-menu",{cmdList:t,value:j.nowIconTheme.value});break}},onSelectLanguage:function(){var e=j.languageList.map((function(e){return{op:"selectLanguage",name:e.name+(e.language?"（".concat(e.language,"）"):""),value:e.value}}));E.$emit("open-cmd-menu",{cmdList:e,value:this.nowId&&this.getNowEditor().language})},onFileChange:function(e){var t=this.getTabById(e);t.saved=!1},onSaveFile:function(e){var t=this,n=this.getTabById(e);if("web"===this.mode)return Promise.resolve();if(!n.saved){if(n.path)return this.writeFile(n.path,vn[e].getAllText()),n.saved=!0,Promise.resolve();var i=gn.getCurrentWindow(),s={title:"请选择要保存的文件名",buttonLabel:"保存"};return gn.dialog.showSaveDialog(i,s).then((function(i){if(i.canceled||!i.filePath)return Promise.reject();n.path=i.filePath,n.name=n.path.match(/[^\\\/]+$/)[0],t.writeFile(n.path,vn[e].getAllText()),n.saved=!0}))}},onDialogClose:function(){this.dialogVisible=!1},openFolder:function(){var e=this;this.choseFolder().then((function(t){t&&(e.$refs.sideBar.list=t,e.editorList=[],e.nowId=null)}))},choseFolder:function(){var e=gn.getCurrentWindow(),t={title:"选择文件夹",properties:["openDirectory","multiSelections"]};return gn.dialog.showOpenDialog(e,t).then((function(e){var t=[];if(!e.canceled&&e.filePaths)return e.filePaths.forEach((function(e){var n={name:e.match(/[^\\\/]+$/)[0],path:e,type:"dir",active:!1,open:!1,children:[]};t.push(Object.assign({},n))})),t})).catch((function(e){console.log(e)}))},openFile:function(e,t){var n=this,i=e&&this.getTabByPath(e.path);if(i)a.call(this);else{var s=-1,o=e&&e.name||"Untitled".concat(this.titleCount++);if(this.editorList.length&&(i=this.getTabById(this.nowId),s=this.editorList.indexOf(i)),t)this.choseFile().then((function(e){e&&(i=e[0],n.editorList=n.editorList.slice(0,s).concat(e).concat(n.editorList.slice(s)),a.call(n))}));else{if(i={id:this.idCount++,name:o,path:e&&e.path||"",icon:e&&e.icon||"",saved:!0,active:!1},!i.icon){var r=Z.getIconByPath(j.nowIconData,"",j.nowTheme.type);i.icon=r?"my-file-icon my-file-icon-".concat(r):""}this.editorList.splice(s+1,0,i),a.call(this)}}function a(){var e=this;this.$nextTick((function(){i&&i.path&&!i.loaded&&mn.readFile(i.path,{encoding:"utf8"},(function(t,n){if(t)throw t;e.getContext(i.id).insertContent(n),i.saved=!0,i.loaded=!0})),e.onChangeTab(i.id),e.checkLanguage()}))}},choseFile:function(){var e=this,t=gn.getCurrentWindow(),n={title:"选择文件",properties:["openFile","multiSelections"]};return gn.dialog.showOpenDialog(t,n).then((function(t){var n=[];if(!t.canceled&&t.filePaths)return t.filePaths.forEach((function(t){var i=Z.getIconByPath(j.nowIconData,t,j.nowTheme.type);i=i?"my-file-icon my-file-icon-".concat(i):"";var s={id:e.idCount++,name:t.match(/[^\\\/]+$/)[0],path:t,icon:i,saved:!0,active:!1};n.push(Object.assign({},s))})),n})).catch((function(e){console.log(e)}))},sortFileList:function(){this.list.sort((function(e,t){return e.type===t.type?e.name===t.name?0:e.name>t.name?1:-1:"dir"===e.type?-1:1}))},showDialog:function(e){this.dialogTilte=e.title||"",this.dialogContent=e.content||"",this.dialogBtns=e.btns,this.dialogVisible=!0,this.dialogIconColor=e.iconColor||"",this.dialogIcon=e.icon||""},writeFile:function(e,t){mn.writeFileSync(e,t,{encoding:"utf-8"})},changeStatus:function(){var e=this,t=this.changeStatus.id||1;this.changeStatus.id=t,this.$nextTick((function(){if(e.changeStatus.id===t){var n=e.getNowEditor(),i=e.getTabById(e.nowId);E.$emit("tab-change",{path:i.path,language:n.language,tabSize:n.tabSize,line:n.nowCursorPos?n.nowCursorPos.line:"?",column:n.nowCursorPos?n.nowCursorPos.column:"?"})}}))},checkLanguage:function(){var e=this;if(this.nowId){var t=this.getTabById(this.nowId),n=/\.[^\.]+$/.exec(t.name);if(!n)return;for(var i=function(t){var i=e.languageList[t];if(i.extensions&&i.extensions.indexOf(n[0])>-1)return e.$nextTick((function(){E.$emit("language-change",i.value)})),"break"},s=0;s<this.languageList.length;s++){var o=i(s);if("break"===o)break}}},loadExtensions:function(){var e=this,t=[],n=[],i=[[],[],[],[]],s=[],o={};return new Promise((function(l){mn.readdir(e.extensionsPath,{encoding:"utf8"},(function(u,h){if(u)throw u;h.forEach((function(t,n){var i=pn.join(e.extensionsPath,t),s=pn.join(i,"./package.json"),l=pn.join(i,"./package.nls.json");if(mn.existsSync(l)){var u=mn.readFileSync(l,"utf-8");try{o=JSON.parse((0,H.Z)(u))}catch(m){console.log(m)}}if(mn.existsSync(s)){var h=mn.readFileSync(s,"utf-8");try{var d=JSON.parse((0,H.Z)(h)),f=d.contributes;r(f,i),a(f,i),c(f,i)}catch(m){console.log(m)}}})),i=i.filter((function(e){return e.length})),l({languages:t,scopeFileList:n,themes:i,iconThemes:s})}))}));function r(e,i){var s=e.grammars,o=e.languages||[];o.map((function(e){for(var o=0;o<s.length;o++){var r=s[o];if(n.push({scopeName:r.scopeName,path:pn.join(i,r.path),configPath:e.configuration?pn.join(i,e.configuration):""}),e.id===r.language){var a=e.aliases&&e.aliases[0];a=a||r.language,t.push({name:a,value:r.language,language:r.language,scopeName:r.scopeName,path:pn.join(i,r.path),configPath:e.configuration?pn.join(i,e.configuration):"",extensions:e.extensions});break}}}))}function a(e,t){var n=e.themes||[];n.map((function(e){var n="light",s=0,o=l(e.label);switch(e.uiTheme){case"vs-dark":n="dark",s=1;break;case"hc-light":n="contrast light",s=2;break;case"hc-black":n="contrast dark",s=3;break}i[s].push({name:e.id||o,value:o||e.id,type:n,path:pn.join(t,e.path)})}))}function c(e,t){var n=e.iconThemes||[];n.map((function(e){var n=l(e.label);s.push({name:n||e.id,value:e.id||n,path:pn.join(t,e.path)})}))}function l(e){return e=e||"","%"===e[0]&&"%"===e[e.length-1]&&(e=o[e.slice(1,-1)]||e),e}},getTabById:function(e){for(var t=0;t<this.editorList.length;t++)if(this.editorList[t].id===e)return this.editorList[t]},getTabByPath:function(e){for(var t=0;t<this.editorList.length;t++)if(this.editorList[t].path===e)return this.editorList[t]},getEditor:function(e){var t=this.$refs["editor".concat(e)];return t&&t[0]},getNowEditor:function(){return this.getEditor(this.nowId)},getContext:function(e){return vn[e]},getNowContext:function(){return this.getContext(this.nowId)}}},Cn=yn,kn=(0,c.Z)(Cn,d,f,!1,null,null,null),xn=kn.exports;i.Z.use(h.Z);var bn=new h.Z({routes:[{path:"/",name:"Window",component:xn,meta:{title:"my-editor"}},{path:"*",redirect:"/"}]}),wn=bn,Tn=n(4459),Ln=n.n(Tn);i.Z.config.productionTip=!1,i.Z.prototype.$http=Ln().create({timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json; charset=utf-8"}}),new i.Z({router:wn,render:function(e){return e(u)}}).$mount("#app")}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,i,s,o){if(!i){var r=1/0;for(u=0;u<e.length;u++){i=e[u][0],s=e[u][1],o=e[u][2];for(var a=!0,c=0;c<i.length;c++)(!1&o||r>=o)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(a=!1,o<r&&(r=o));if(a){e.splice(u--,1);var l=s();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[i,s,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,o,r=i[0],a=i[1],c=i[2],l=0;if(r.some((function(t){return 0!==e[t]}))){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(c)var u=c(n)}for(t&&t(i);l<r.length;l++)o=r[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},i=self["webpackChunkmy_editor"]=self["webpackChunkmy_editor"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(7647)}));i=n.O(i)})();
//# sourceMappingURL=app-legacy.8dcb4502.js.map