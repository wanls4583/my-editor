(function(e){function t(t){for(var n,o,a=t[0],l=t[1],h=t[2],c=0,p=[];c<a.length;c++)o=a[c],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,h||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],n=!0,a=1;a<i.length;a++){var l=i[a];0!==s[l]&&(n=!1)}n&&(r.splice(t--,1),e=o(o.s=i[0]))}return e}var n={},s={app:0},r=[];function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var h=0;h<a.length;h++)t(a[h]);var u=l;r.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("keep-alive",[i("router-view")],1)],1)},r=[],o={name:"App"},a=o,l=i("2877"),h=Object(l["a"])(a,s,r,!1,null,null,null),u=h.exports,c=i("ac56"),p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"editor",staticClass:"my-editor-wrap",style:{"padding-bottom":e._statusHeight},on:{contextmenu:function(t){return t.preventDefault(),e.onContextmenu.apply(null,arguments)},mousedown:e.onClickEditor,selectstart:function(e){e.preventDefault()},wheel:function(t){return t.preventDefault(),e.onWheel.apply(null,arguments)}}},[i("div",{staticClass:"my-editor-nums",style:{top:e._numTop}},[i("div",{staticClass:"my-editor-num",staticStyle:{visibility:"hidden"}},[e._v(e._s(e.maxLine))]),e._l(e.renderHtmls,(function(t){return i("div",{key:t.num,staticClass:"my-editor-num",class:{"my-editor-num-active":e._activeLine(t.num)},style:{height:e._lineHeight,"line-height":e._lineHeight}},[i("span",{staticClass:"my-editor-icon my-editor-center",class:[e.errorMap[t.num]?"my-editor-icon-error":""],on:{mouseleave:e.onIconMouseLeave,mouseover:function(i){return e.onIconMouseOver(t.num,i)}}}),i("span",[e._v(e._s(t.num))]),t.fold?i("span",{staticClass:"my-editor-fold my-editor-center",class:["open"==t.fold?"my-editor-fold-open":"my-editor-fold-close"],on:{click:function(i){return e.onToggleFold(t.num)}}}):e._e()])}))],2),i("div",{staticClass:"my-editor-content-wrap",style:{"box-shadow":e._leftShadow}},[i("div",{ref:"scroller",staticClass:"my-editor-content-scroller",on:{mousedown:e.onScrollerMdown}},[i("div",{ref:"content",staticClass:"my-editor-content",style:{top:e._top,minWidth:e._contentMinWidth},on:{selectend:function(t){return t.preventDefault(),e.onSelectend.apply(null,arguments)}}},[e._l(e.renderHtmls,(function(t){return i("div",{key:t.num,staticClass:"my-editor-line",class:{active:e._activeLine(t.num)},style:{height:e._lineHeight,"line-height":e._lineHeight},attrs:{"data-line":t.num,id:"line_"+t.num}},[i("div",{staticClass:"my-editor-code",class:[t.selected?"my-editor-select-bg my-editor-select-active":"","close"==t.fold?"fold-close":""],attrs:{"data-line":t.num},domProps:{innerHTML:e._s(t.html)}}),e._l(t.selectStarts,(function(e){return i("div",{staticClass:"my-editor-line-bg my-editor-select-bg",class:{"my-editor-select-active":e.active},style:{left:e.left+"px",width:e.width+"px"}})})),e._l(t.selectEnds,(function(e){return i("div",{staticClass:"my-editor-line-bg my-editor-select-bg my-editor-select-active",style:{left:e.left+"px",width:e.width+"px"}})})),e._l(t.tabNum,(function(t){return i("span",{staticClass:"my-editor-tab-line",style:{left:e._tabLineLeft(t)}})}))],2)})),e._l(e.multiCursorPos,(function(t){return i("div",{staticClass:"my-editor-cursor",style:{height:e._lineHeight,top:t.top,left:t.left,visibility:e._cursorVisible}})}))],2)]),i("div",{ref:"hScroller",staticClass:"my-editor-h-scroller-wrap",on:{mousedown:function(e){e.stopPropagation()},mouseup:function(e){e.stopPropagation()},scroll:e.onHscroll}},[i("div",{staticClass:"my-editor-h-scroller",style:{width:e._hScrollWidth}})]),i("div",{ref:"vScroller",staticClass:"my-editor-v-scroller-wrap",on:{mousedown:function(e){e.stopPropagation()},mouseup:function(e){e.stopPropagation()},scroll:e.onVscroll}},[i("div",{staticClass:"my-editor-v-scroller",style:{height:e.scrollerHeight}})]),i("textarea",{ref:"textarea",staticClass:"my-editor-textarea",style:{top:e._textAreaPos.top,left:e._textAreaPos.left},on:{blur:e.onBlur,compositionend:e.onCompositionend,compositionstart:e.onCompositionstart,copy:function(t){return t.preventDefault(),e.onCopy.apply(null,arguments)},cut:function(t){return t.preventDefault(),e.onCut.apply(null,arguments)},focus:e.onFocus,input:e.onInput,keydown:e.onKeyDown,paste:function(t){return t.preventDefault(),e.onPaste.apply(null,arguments)}}})]),i("status-bar",{ref:"statusBar",attrs:{column:e.nowCursorPos.column+1,height:e.statusHeight,language:e.language,line:e.nowCursorPos.line,tabSize:e.tabSize},on:{"update:language":function(t){e.language=t},"update:tabSize":function(t){e.tabSize=t},"update:tab-size":function(t){e.tabSize=t}}}),i("panel",{directives:[{name:"show",rawName:"v-show",value:e.menuVisble,expression:"menuVisble"}],ref:"menu",attrs:{checkable:!1,menuList:e.menuList,styles:e.menuStyle},on:{change:e.onClickMenu}}),i("tip",{directives:[{name:"show",rawName:"v-show",value:e.tipContent,expression:"tipContent"}],attrs:{content:e.tipContent,styles:e.tipStyle}})],1)},d=[],f=i("ade3"),m=(i("4e82"),i("fb6a"),i("d81d"),i("ac1f"),i("5319"),i("841c"),i("a434"),i("53ca")),v=i("d4ec"),k=i("bee2"),g=(i("4d63"),i("c607"),i("2c3e"),i("25f0"),i("99af"),i("a15b"),i("1276"),i("466d"),i("b0c0"),i("4de4"),i("d3b7"),"[\\$_a-zA-Z][\\$_a-zA-Z0-9]*?"),x=function(e){var t=e.value;return"end"!==e.side||"\\"!==t[0]||t.length%2!==0},y={},b={start:/`/,end:/\\*?`/,token:"js-string",plainToken:"js-string",foldName:"js-string",valid:x,childRule:{rules:[{start:/\$\{/,end:/\}/,foldName:"js-string-expr",level:1,childRule:y}]}},C={start:/(?<=^|[\(\{\[\;\,\:\?\!\+\-\*\%\=\>\<\&\|]\s*?)\//,end:/(?<=(?:\\[\s\S]|[^\\])+?)\/(?:i|m|g|im|mi|ig|gi|mg|gm|img|igm|mig|mgi|gim|gmi)?|$/i,childRule:{rules:[{regex:/\\b/,token:"js-regex-ctrl"},{regex:/\\[\s\S]/,token:"js-regex-escape"},{regex:/\?\=|\?\<\=|\?\!|\?\<\!/,token:"js-regex"},{regex:/\*|\^|\$|\?/,token:"js-regex-ctrl"},{start:/\[/,end:/(?<!\\)\]/,token:"js-regex-bracket",childRule:{rules:[{regex:/\^/,token:"js-regex-ctrl",valid:function(e){var t=e.text,i=e.index;return"["===t[i-1]&&"\\"!==t[i-2]}}]}}]},token:"js-regex"},w=[b,{start:/'/,end:/\\*?'|[^\\]$|^$/,token:"js-string",foldName:"js-single-string",valid:x},{start:/"/,end:/\\*?"|[^\\]$|^$/,token:"js-string",foldName:"js-double-string",valid:x},{start:/\/\*/,end:/\*\//,token:"js-comment",foldName:"js-comment"},{regex:/\/\/[\s\S]*$/,token:"js-comment"},C,{regex:/\bvar\b|\blet\b|\bconst\b/,token:"js-type"},{regex:/\bcontinue\b|\bbreak\b|\bswitch\b|\bcase\b|\bdo\b|\bwhile\b|\belse\b|\bfor\b|\bif\b|\bnew\b|\breturn\b|\bfrom\b|\btypeof|\beach\b|\bin\b|\bimport\b|\bexport\b|\bdefault\b|\bwith\b|\bthrow\b|\btry\b|\bcatch\b|\bfinally\b/,token:"js-key"},{regex:/\bclass\b/,token:"js-class"},{regex:/\b[A-Z][\\$_a-zA-Z0-9]*?(?=\.)/,token:"js-function-class"},{regex:/\bfunction\b/,token:"js-function"},{regex:new RegExp("(".concat(g,")\\s*?(?=\\([^\\(\\)]*?\\)\\s*?\\{)")),token:"js-function-name"},{regex:new RegExp("(?<=\\bfunction\\s+?)".concat(g)),token:"js-function-name"},{regex:new RegExp("(?<=\\bnew\\s+?)".concat(g,"(?=\\s*?\\()")),token:"js-new-class"},{regex:/(\{)|(\[)|(\()/,token:["js-lbraces","js-lbracket","js-lparen"],foldType:-1,foldName:["js-braces","js-bracket","js-paren"]},{regex:/(\})|(\])|(\))/,token:["js-rbraces","js-rbracket","js-rparen"],foldType:1,foldName:["js-braces","js-bracket","js-paren"]},{regex:/(?<=\.)(?:prototype\b|toString\b|valueOf\b|toLocaleString\b|hasOwnProperty\b|isPrototypeOf\b|propertyIsEnumerable\b)/,token:"js-local"},{regex:/\bwindow\b|\bdocument\b|\bmodule\b|\bexports\b/,token:"js-local"},{regex:/\bthis\b|\bself\b/,token:"js-this"},{regex:/\+|\-|\*|\/|\=|\!|>|<|\&|\||\?/,token:"js-oprator"},{regex:new RegExp("\\b\\d+\\b|\\b0[xX][a-zA-Z0-9]*?\\b|\\bundefined\\b|\\bnull\\b|\\btrue\\b|\\bfalse\\b|\\bNaN\\b"),token:"js-number"},{regex:new RegExp("(".concat(g,")(?=\\()")),token:"js-function-exec"},{regex:new RegExp("(?<=\\s*?class\\s*?)".concat(g,"(?=\\s*?\\{)")),token:"js-class-name"}];y.rules=w;var T={rules:w},S={start:/\/\*/,end:/\*\//,token:"css-comment",foldName:"css-comment"},E={start:/\{/,end:/\}/,token:["css-lbraces","css-rbraces"],foldName:"css-braces",childRule:{rules:[S,null,{regex:/;/,token:"css-split"},{regex:/:/,token:"css-value-start"},{regex:/[a-zA-Z][^;\:\s\}]*?(?=\s*?\:)/,token:"css-property"},{regex:/(?<=\:\s*?)[^;\:\}]+?(?=;|}|$)/,token:"css-value"},{regex:/(?:\d+(?:\.\d*)?|\.\d+)%/,token:"css-percent"}]}};E.childRule.rules[1]=E;var P={rules:[S,E,{regex:/[#\.]?[^\s\,\:\{]+/,token:function(e){return"."==e[0]?"css-selector-class":"#"==e[0]?"css-selector-id":"css-selector-tag"}},{regex:/(?<=\:)[^\s\,\:]+/,token:"css-pseudo"}]},M=[{regex:/(?<=\:(?:\s*?\w+?\s*?){0,})\d+/,token:"html-style-number"},{regex:/(?<=\:\s*?\d+)px\b/,token:"html-style-px"},{regex:/(?<=(?:\;|'|")\s*?)[^\<\>\:\;'"]+/,token:"html-style-name"},{regex:/(?<=\:\s*?)[^\<\>\:\;'"]+/,token:"html-style-value"}],I=[{start:/(?<=style\s*?\=\s*?)'/,end:/'/,token:"xml-attr-value",level:1,childRule:{rules:M}},{start:/(?<=style\s*?\=\s*?)"/,end:/"/,token:"xml-attr-value",level:1,childRule:{rules:M}},{start:/(?<=\=\s*?)"/,end:/"/,level:1,token:"xml-attr-value"},{start:/(?<=\=\s*?)'/,end:/'/,level:1,token:"xml-attr-value"},{regex:/(?<=\<\/?)\w+\b/,token:"xml-tag-name",foldName:N,foldType:j},{regex:/(?<=\=)\s*?[^\<\>\s\'\"]+\b/,token:"xml-attr-value"},{regex:/\b[^'"=\s\>\<]+\b/,token:"xml-attr-name"}],L={start:/\<(?=script\b)/,end:/\>/,token:A,childRule:{rules:I}},R={start:/\<\/(?=script\>)/,end:/\>/,token:A,childRule:{rules:[{regex:/(?<=\<\/?)\w+\b/,token:"xml-tag-name",foldName:N,foldType:j}]}},O={start:/\<(?=style\b)/,end:/\>/,token:A,childRule:{rules:I}},D={start:/\<\/(?=style\s*?\>)/,end:/\>/,token:A,childRule:{rules:[{regex:/(?<=\<\/?)\w+\b/,token:"xml-tag-name",foldName:N,foldType:j}]}};function A(e){return"start"==e.side?"/"==e.value[1]?"xml-end-tag-open":"xml-tag-open":"end"===e.side?"xml-tag-close":void 0}function N(e){return/hr|br|meta|img|link|input/i.exec(e.value)?"":e.value}function j(e){return"/"==e.text[e.index-1]?1:-1}var F={rules:[{start:L,end:R,childRule:T},{start:O,end:D,childRule:P},{start:/\<\/?(?=\w+\b)/,end:/\/?\>/,token:A,childRule:{rules:I}},{start:/\<\!\-\-/,end:/\-\-\>/,token:"xml-comment",foldName:"xml-comment"}]},_=(i("a9e3"),i("4ec9"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("c65b")),B=i.n(_),W=function(){function e(){Object(v["a"])(this,e)}return Object(k["a"])(e,null,[{key:"readClipboard",value:function(){return window.clipboardData?new Promise((function(e){e(clipboardData.getData("Text"))})):navigator.clipboard?navigator.clipboard.readText():void 0}},{key:"writeClipboard",value:function(e){window.clipboardData?clipboardData.setData("Text",e):navigator.clipboard&&navigator.clipboard.writeText(e)}},{key:"getNum",value:function(e){e=String(e),e=e.replace(/[^0123456789\.]/g,"");var t=/^\d+(\.\d*)?$/,i=t.exec(e),n=i&&i[0]||"";return n&&(n=Number(i[0])),n}},{key:"space",value:function(e){for(var t="",i=0;i<e;i++)t+=" ";return t}},{key:"sortNum",value:function(e){e.sort((function(e,t){return Number(e)-Number(t)}))}},{key:"getCharWidth",value:function(t){var i="------------------------------------------------------------------------------------",n="一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一",s="char-width-"+e.getUUID(),r="char-width-"+e.getUUID(),o=B()('<div class="my-editor-line">\n        <div class="my-editor-code"><span id="'.concat(s,'">').concat(i,'</span><span id="').concat(r,'">').concat(n,"</span></div>\n        </div>"));B()(t).append(o);var a=B()("#"+s)[0],l=a.scrollWidth/i.length,h=a.clientHeight,u=window.getComputedStyle?window.getComputedStyle(a,null).fontSize:a.currentStyle.fontSize,c=B()("#"+r)[0].scrollWidth/n.length;return o.remove(),{charWidth:l,fullAngleCharWidth:c,charHight:h,fontSize:u}}},{key:"getStrWidth",value:function(e,t,i,n,s,r){n=n||4,"undefined"!=typeof s&&(e=e.substr(s)),"undefined"!=typeof r&&(e=e.substring(0,r-s));var o=e.match(this.fullAngleReg),a=e.length*t,l=e.match(/\t/g);return l=l&&l.length||0,o=o&&o.length||0,o&&(o-=l,a=o*i+(e.length-o)*t,a+=l*t*(n-1)),a}},{key:"getStrExactWidth",value:function(t,i,n){if(e.getStrExactWidth.count=e.getStrExactWidth.count||0,e.getStrExactWidth.count++,!t)return 0;var s="str-width-"+e.getUUID(),r=B()('<div class="my-editor-line my-editor-temp-text" style="visibility:hidden">\n        <div class="my-editor-code" id="'.concat(s,'">').concat(l(t),"</div>\n        </div>"));B()(n).append(r);var o=B()("#"+s)[0],a=o.clientWidth;return e.getStrExactWidth.count>5?B()(".my-editor-temp-text").remove():(clearTimeout(e.getStrExactWidth.timer),e.getStrExactWidth.timer=setTimeout((function(){B()(".my-editor-temp-text").remove()}),500)),a;function l(t){for(var n=Math.floor(t.length/100),s=[],r=0;r<n;r++){var o=100*r;s.push(e.htmlTrans(t.slice(o,o+100)))}return n*=100,n<t.length&&s.push(e.htmlTrans(t.slice(n))),"<span>".concat(s.join("</span><span>").replace(/\t/g,e.space(i||4)),"</span>")}}},{key:"htmlTrans",value:function(e){return e=e.replace(/\&\#/g,"&amp;#"),e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{key:"deepAssign",value:function(e,t,i){return n(e,t,i,new Map);function n(e,t,i,s){for(var r in i=i||[],t){var o=t[r];if(!(i.indexOf(r)>-1))if("object"!==Object(m["a"])(o)||o instanceof RegExp||null===o||o.nodeName&&o.nodeType)e[r]=o;else if(s.has(o))e[r]=s.get(o);else{var a=null;o instanceof Array?(a=e[r]||[],s.set(o,a),e[r]=n(a,o,i,new Map(s))):(a=e[r]||{},s.set(o,a),e[r]=n(a,o,i,new Map(s)))}}return e}}},{key:"getUUID",value:function(e){e=e||16;for(var t="",i=0;i<e;i++)t+=(16*Math.random()|0).toString(16);return t}},{key:"comparePos",value:function(e,t){return e.line>t.line||e.line==t.line&&e.column>t.column?1:e.line==t.line&&e.column==t.column?0:-1}},{key:"createWorker",value:function(e){var t=new Blob([e]),i=window.URL.createObjectURL(t),n=new Worker(i);return n}},{key:"defineProperties",value:function(e,t,i){var n={};i.map((function(e){n[e]={get:function(){return"function"==typeof t[e]?t[e].bind(t):t[e]}}})),Object.defineProperties(e,n)}}]),e}();Array.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},Array.prototype.empty=function(){return this.length=0,this},String.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},W.fullAngleReg=/[\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF\uFFF9-\uFFFC]|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,W.keyCode={DELETE:46,BACKSPACE:8},W.command={DELETE:"delete",INSERT:"insert",MOVEUP:"moveLineUp",MOVEDOWN:"moveLineDown",COPY_UP:"copyLineUp",COPY_DOWN:"copyLineDown",DELETE_UP:"delteLineUp",DELETE_DOWN:"delteLineDown"},W.constData={PAIR_START:-1,PAIR_START_END:0,PAIR_END:1,FOLD_OPEN:1,FOLD_CLOSE:-1,DEFAULT:"default"};var H=W,z=function(){function e(t,i){Object(v["a"])(this,e),this.currentLine=1,this.languageMap=[],this.initProperties(t,i),this.initLanguage(t.language)}return Object(k["a"])(e,[{key:"initLanguage",value:function(e){switch(this.language=e,clearTimeout(this.tokenizeLines.timer),e){case"JavaScript":this.initRules(T);break;case"HTML":this.initRules(F);break;case"CSS":this.initRules(P);break;default:this.language="plain"}}},{key:"initProperties",value:function(e,t){H.defineProperties(this,e,["startLine","maxVisibleLines","maxLine","renderLine"]),H.defineProperties(this,t,["htmls"])}},{key:"initRules",value:function(e){var t=this;if(this.languageMap[this.language]){var i=this.languageMap[this.language];return this.rules=i.rules,this.ruleIdMap=i.ruleIdMap,void(this.regexMap=i.regexMap)}this.ruleId=1,this.ruleIdMap={},this.regexMap={},this.rules=H.deepAssign({},e),this.rules.rules.map((function(e){t.setRuleId(e)})),this.languageMap[this.language]={rules:this.rules,ruleIdMap:this.ruleIdMap,regexMap:this.regexMap}}},{key:"setRuleId",value:function(e){var t=this;e.ruleId=this.ruleId++,e.level=e.level||0,e.token=e.token||"",this.ruleIdMap[e.ruleId]=e,"object"!==Object(m["a"])(e.start)||e.start instanceof RegExp||(this.setRuleId(e.start),e.start.startBy=e.ruleId),"object"!==Object(m["a"])(e.end)||e.end instanceof RegExp||(this.setRuleId(e.end),e.end.endBy=e.ruleId),e.childRule&&e.childRule.rules&&(e.childRule.rules.map((function(e){!e.ruleId&&t.setRuleId(e)})),e.rules=e.childRule.rules)}},{key:"getCombRegex",value:function(e){var t=this;e=e||[];var i=e+""||"0",n=[],s={},r=[],o=0,a=null;if(this.regexMap[i])return this.regexMap[i];if(e.length>1){var l=[];while(o<e.length-1)a=this.ruleIdMap[e[o+1]],a.startBy!==e[o]&&a.endBy!==e[o]?(l.push(e[o]),o++):o++;l.push(e[o]),e=l}o=e.length-1,a=e.length&&this.ruleIdMap[e.peek()]||this.rules;while(o>=0&&this.ruleIdMap[e[o]].level>=a.level)r.push(this.getEndRegex(this.ruleIdMap[e[o]])),o--;return r.reverse(),a.rules&&a.rules.map((function(e){r.push(t.getStartRegex(e))})),r.map((function(e){var t=-1===e.side?"start":"end";s[e.ruleId]&&s[e.ruleId]===t||(n.push("?<".concat(t,"_").concat(e.ruleId,">").concat(e.regex.source)),s[e.ruleId]=t)})),this.regexMap[i]=new RegExp("(".concat(n.join(")|("),")"),"g"),this.regexMap[i]}},{key:"getStartRegex",value:function(e){return e.regex instanceof RegExp?{ruleId:e.ruleId,regex:e.regex,side:-1}:e.start instanceof RegExp?{ruleId:e.ruleId,regex:e.start,side:-1}:e.start.startBy?this.getStartRegex(e.start):void 0}},{key:"getEndRegex",value:function(e,t){return e.regex instanceof RegExp?{ruleId:e.ruleId,regex:e.regex,side:t||1}:e.end instanceof RegExp?{ruleId:e.ruleId,regex:e.end,side:t||1}:e.end.endBy?this.getStartRegex(e.end,-1):void 0}},{key:"onInsertContentBefore",value:function(e){this.onInsertContentBefore.nowLine=e}},{key:"onInsertContentAfter",value:function(e){e=this.onInsertContentBefore.nowLine,"plain"!=this.language&&(e<=this.currentLine?this.tokenizeLines(e):this.tokenizeVisibleLins())}},{key:"onDeleteContentBefore",value:function(e){}},{key:"onDeleteContentAfter",value:function(e){"plain"!=this.language&&(e<=this.currentLine?this.tokenizeLines(e):this.tokenizeVisibleLins())}},{key:"onScroll",value:function(){"plain"!=this.language&&this.tokenizeVisibleLins()}},{key:"tokenizeVisibleLins",value:function(){var e=this.currentLine;this.tokenizeLines(this.startLine),this.currentLine=e}},{key:"tokenizeLines",value:function(e,t){var i=this,n=0,s=Date.now();t=t||this.maxLine;while(e<=t){var r=this.htmls[e-1];if(!r.tokens){var o=this.tokenizeLine(e);if(r.tokens=o.tokens,r.folds=o.folds,r.html=o.tokens.map((function(e){var t=i.ruleIdMap[e.ruleId];return t&&"function"===typeof t.value?t.value(e.value):'<span class="'.concat(e.type.split(".").join(" "),'" data-column="').concat(e.column,'">').concat(H.htmlTrans(e.value),"</span>")})).join(""),this.renderLine(r.lineId),r.states+""!=o.states+""&&(r.states=o.states,r=this.htmls[e],r&&(r.tokens=null)),n++,n%10==0&&Date.now()-s>=20){e++;break}}e++}this.currentLine=e,e<=t&&(this.tokenizeLines.timer=setTimeout((function(){i.tokenizeLines(e,t)}),20))}},{key:"tokenizeLine",value:function(e){var t=null,i=null,n=0,s=0,r=[],o=(e>1&&this.htmls[e-2].states||[]).slice(0),a=this.htmls[e-1],l=this.getRegex(o),h={tokens:[],folds:[]};if(a.text.length>1e4)return{tokens:this.splitLongToken([{type:"plain",column:0,value:a.text}]),folds:[],states:o};while(t=l.exec(a.text)){var u=null,c=null,p=!0,d="";for(var f in t.groups)if(void 0!=t.groups[f]){if(d=f.split("_")[0],f=f.split("_")[1]-0,i=this.ruleIdMap[f],s<t.index){var m=a.text.slice(s,t.index);h.tokens.push({value:m,column:s,type:this.getTokenType({rule:this.ruleIdMap[o.peek()],index:s,value:m,text:a.text})}),s=t.index}if("function"===typeof i.valid&&(p=i.valid({index:t.index,text:a.text,value:t[0],side:d}),!p))break;c=this.getFold(i,t,o,h,a.text),u=this.getToken(i,t,o,r,h,a.text,d),h.tokens.push(u),c&&h.folds.push(c),s=t.index+t[0].length;break}if(!t[0])break;p&&(n=l.lastIndex,l.lastIndex=0,l=this.getRegex(o,i.ruleId),l.lastIndex=n)}if(!h.tokens.length&&o.length)h.tokens.push({value:a.text,column:0,type:this.getTokenType({rule:this.ruleIdMap[o.peek()],value:a.text,text:a.text})});else if(s<a.text.length){var v=a.text.slice(s);h.tokens.push({value:v,column:s,type:this.getTokenType({rule:this.ruleIdMap[o.peek()],index:s,value:v,text:a.text})})}return l.lastIndex=0,{tokens:this.splitLongToken(h.tokens),folds:h.folds,states:o}}},{key:"splitLongToken",value:function(e){var t=[];return e.map((function(e){if(e.value.length>100){for(var i=e.column,n=Math.floor(e.value.length/100),s=0;s<n;s++){var r=100*s;t.push({column:r+i,value:e.value.slice(r,r+100),type:e.type})}n*=100,n<e.value.length&&t.push({column:n+i,value:e.value.slice(n),type:e.type})}else t.push(e)})),t}},{key:"getToken",value:function(e,t,i,n,s,r,o){var a=t[0],l={ruleId:e.ruleId,value:a,column:t.index};if(e.start&&e.end)if("end"===o){while(i.peek()!=e.ruleId)i.pop();if(i.pop(),!e.rules)if(n.indexOf(e.ruleId)>-1){var h="";l=s.tokens.pop(),h=l.value,l.ruleId!==e.ruleId&&(l=s.tokens.pop(),h=l.value+h),l.value=h+a}else s.tokens.pop(),l.value=r.slice(0,t.index+a.length),l.column=0}else i.push(e.ruleId),n.push(e.ruleId);return l.type=this.getTokenType({rule:e,index:t.index,value:l.value,text:r,match:t,side:o}),l}},{key:"getTokenType",value:function(e){var t=e.rule,i=e.index||0,n=e.value||e.text,s=e.text,r=e.match,o=e.side||(t&&t.start&&t.end?"start":""),a="";if(!t)return"plain";if("function"==typeof t.token)a=t.token({value:n,index:i,text:s,side:o});else if(t.token instanceof Array)if(t.start&&t.end)a="start"==o?t.token[0]:t.token[1];else{var l=r&&this.getChildExpIndex(r)||-1;a=l>-1?t.token[l]:t.token.join(".")}else a=t.token;return a}},{key:"getFold",value:function(e,t,i,n,s){var r=t[0],o="",a=null;if(e.start&&e.end?(o="start",i.indexOf(e.ruleId)>-1&&(o="end"),e.foldName&&(a={start:t.index,end:t.index+r.length,value:r})):e.foldName&&e.foldType&&(a={start:t.index,end:t.index+r.length,value:r}),a){var l=this.getFoldName(e,t,s,o);if(!l)return null;a.name=l,a.type=this.getFoldType(e,t,s,o),1==a.type&&(a=h(n,a))}return a;function h(e,t){var i=e.folds;if(i)for(var n=i.length-1;n>=0;n--)if(i[n].name==t.name&&-1==i[n].type){e.folds=i.slice(0,n),t=null;break}return t}}},{key:"getFoldName",value:function(e,t,i,n){var s="";if(e.foldName instanceof Array)if(e.start&&e.end)s="start"==n?e.foldName[0]:e.foldName[1];else{var r=this.getChildExpIndex(t);r=-1==r?0:r,s=e.foldName[r]}else s="function"===typeof e.foldName?e.foldName({value:t[0],text:i,index:t.index,side:n}):e.foldName;return s}},{key:"getFoldType",value:function(e,t,i,n){var s="";if(e.foldType instanceof Array)if(e.start&&e.end)s="start"==n?e.foldType[0]:e.foldType[1];else{var r=this.getChildExpIndex(t);r=-1==r?0:r,s=e.foldType[r]}else s="function"===typeof e.foldType?e.foldType({value:t[0],text:i,index:t.index,side:n}):e.start&&e.end?"start"==n?-1:1:e.foldType;return s}},{key:"getChildExpIndex",value:function(e){if(void 0!==e.childExpIndex)return e.childExpIndex;var t=e.slice(1),i=t.filter((function(e){return e})).length>1;if(i){for(var n=0;n<t.length;n++)if(void 0!=t[n]){t=t.slice(n+1);break}for(var s=0;s<t.length;s++)if(void 0!=t[s])return e.childExpIndex=s,s}return e.childExpIndex=-1,-1}},{key:"getRegex",value:function(e,t){var i=this.ruleIdMap[t];while(i&&-1==e.indexOf(i.ruleId)&&i.endBy){while(e.peek()!=i.endBy)e.pop();e.pop(),i=this.ruleIdMap[i.endBy]}return i&&-1==e.indexOf(i.ruleId)&&i.startBy&&e.push(i.startBy),this.getCombRegex(e)}}]),e}(),U=function(){Array.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},Array.prototype._isArray=!0,String.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]};var e=["if","in","do","var","for","new","try","let","this","else","case","void","with","enum","while","break","catch","throw","const","yield","class","super","return","typeof","delete","switch","export","import","default","finally","extends","function","continue","debugger","instanceof","async","await"],t=["=",">>>=",">>=","<<=","+=","-=","*=","/=","%=","&=","|=","^="],i=["+","-","*","/","%","&","|","^","&&","||","===","==","!=","!==",">",">=","<","<=",">>",">>>","<<","instanceof","in"],n=["+","-","~","!","typeof","delete","void"],s=["{","}","[","]","(",")"],r={space:/^\s+/,number:/^(?:\d+(?:\.\d*)?|\.\d+?|0x[a-z0-9]+?)(?:e[\+\-]?\d+(?:\.\d*)?)?\b/i,identifier:/^[a-zA-Z_$][a-zA-Z0-9_$]*/,comment:/\*\//,string1:/\\*'/,string2:/\\*"/,string3:/(\\*`)|(\$\{)/,regex:/^\/(?:\\[\s\S]|[^\\])+?\//,other:/^[^\s+\-\*\/%&\|\^\=\!\>\<\~\{\}\(\)]+/},o={i:!0,m:!0,g:!0,gi:!0,gm:!0,im:!0,gim:!0},a=100;function l(e,t){this.type=e,this.label=t,this._isTokenType=!0}function h(e){this.type=e}function u(e,t,i){e=e||{},this.type=t,this.param=i,this.line=e.line,this.column=e.column,this.value=e.value,this.error=this.toString()}function c(){this.init()}function p(e){this.lexer=e,this.cacheList=[],this.backs=[],this.parseList=[],this.preToken=null,u.errors=[]}l.prototype.toString=function(){return this.label},l.NUMBER=new l(1,"number"),l.BOOLEAN=new l(2,"boolean"),l.STRING=new l(3,"string"),l.IDENTIFIER=new l(4,"identifier"),l.KEYWORD=new l(5,"keyword"),l.OPERATOR=new l(6,"operator"),l.BRACKET=new l(7,"bracket"),l.PUNCTUATOR=new l(8,"punctuator"),l.REGEXP=new l(9,"regexp"),l.OTHER=new l(10,"other"),h.UNEXPECTED=new h(1),h.EXPECTED=new h(2),h.MISS=new h(3),h.UNMATCH=new h(4),u.prototype.toString=function(){var e="",t=this.param instanceof Array?this.param:[this.param];switch(t="".concat(1===t.length?"a ":"","'").concat(t.join("'、'"),"'"),this.type){case h.UNEXPECTED:e="unexpected '".concat(this.value,"'");break;case h.EXPECTED:e="expected ".concat(t),this.value&&(e+=" and instead saw '".concat(this.value,"'"));break;case h.MISS:e="missing ".concat(t),this.value&&(e+=" before '".concat(this.value,"'"));break;case h.UNMATCH:e="unmatched '".concat(this.value,"'");break}return e},u.push=function(e){u.errors.push(e)},u.expectedIdentifier=function(e){u.push(new u(e,h.EXPECTED,l.IDENTIFIER))},u.expectedSemicolon=function(e){u.push(new u(e,h.MISS,";"))},u.expected=function(e,t){u.push(new u(e,h.EXPECTED,t))},u.unexpected=function(e){u.push(new u(e,h.UNEXPECTED))},u.unmatch=function(e){u.push(new u(e,h.UNMATCH))},c.prototype.init=function(){var r=this;u.errors=[],this.lines=[""],this.line=1,this.column=0,this.input="",this.assignOperatorMap={},this.unitOperatorMap={},this.binaryOperatorMap={},this.keywordsMap=new Map,this.bracketsMap=new Map,t.map((function(e){r.assignOperatorMap[e]=!0})),n.map((function(e){r.unitOperatorMap[e]=!0})),i.map((function(e){r.binaryOperatorMap[e]=!0})),e.map((function(e){r.keywordsMap.set(e,!0)})),s.map((function(e){r.bracketsMap.set(e,!0)}))},c.prototype.reset=function(e){this.lines=e.texts,this.line=e.line||1,this.column=e.column||0,this.input=this.lines[this.line-1].slice(this.column)},c.prototype.skip=function(e){this.input=e?this.input.slice(e):this.input,this.column+=e},c.prototype.skipLine=function(e){this.line+=e,this.column=0,this.input=this.lines[this.line-1]||""},c.prototype.hasNext=function(){return!(u.errors.length>a)&&(this.line<this.lines.length||this.line==this.lines.length&&this.lines.peek().length>this.column)},c.prototype.isVariable=function(e){return e.type==l.IDENTIFIER||"this"==e.value},c.prototype.isValue=function(e){return this.isScalar(e)||this.isVariable(e)},c.prototype.isScalar=function(e){return e.type==l.NUMBER||e.type==l.STRING||e.type==l.BOOLEAN||e.type==l.REGEXP},c.prototype.isDotAble=function(e){return e.type===l.IDENTIFIER||e.type===l.KEYWORD},c.prototype.isPostOp=function(e){return"++"===e.value||"--"===e.value},c.prototype.isPreOp=function(e){return"++"===e.value||"--"===e.value},c.prototype.isAssignOperator=function(e){return this.assignOperatorMap[e.value]},c.prototype.isUnitOperator=function(e){return this.unitOperatorMap[e.value]},c.prototype.isBinaryOperator=function(e){return this.binaryOperatorMap[e.value]},c.prototype.isKeyWord=function(e){return this.keywordsMap.has(e)},c.prototype.isBracket=function(e){return this.bracketsMap.has(e)},c.prototype.isTokenType=function(e){return e._isTokenType},c.prototype.craeteToken=function(e,t){var i=this.line,n=this.column;return i>this.lines.length&&(i=this.lines.length,n=this.lines.peek().length),{type:t,line:i,column:n,value:e}},c.prototype.scanSpace=function(){var e=null;while(!this.input.length&&this.line<this.lines.length)this.skipLine(1);e=r.space.exec(this.input),e&&(this.skip(e.index+e[0].length),e.index>=this.input.length-1&&this.scanSpace())},c.prototype.scanComment=function(){var e=null,t=null,i=null,n=null;if(this.scanSpace(),t=this.input[0],i=this.input[1],"/"===t&&"/"==i)this.skipLine(1),this.scanComment();else if("/"===t&&"*"===i){n=this.craeteToken("/*"),this.skip(2);while(this.hasNext()&&!(e=r.comment.exec(this.input)))this.skipLine(1);e?this.skip(e.index+e[0].length):u.unmatch(n)}},c.prototype.scanString=function(){var e=this,t=null,i=null,n=null;if("'"===this.input[0])return n=this.craeteToken("'",l.STRING),this.skip(1),t=s(r.string1),i=this.craeteToken("'",l.STRING),t||(u.unmatch(n),this.skipLine(1)),i;if('"'===this.input[0])return n=this.craeteToken('"',l.STRING),this.skip(1),t=s(r.string2),i=this.craeteToken('"',l.STRING),t||(u.unmatch(n),this.skipLine(1)),i;if("`"===this.input[0]){n=this.craeteToken("`",l.STRING),this.skip(1);while(this.hasNext())if(t=r.string3.exec(this.input),t&&t[2])o(t);else{if(t&&t[0].length%2!==0){this.skip(t.index+t[0].length);break}this.skipLine(1)}i=this.craeteToken("`",l.STRING),t&&t[0].length%2===1||u.unmatch(n)}return i;function s(i){return(t=i.exec(e.input))?(e.skip(t.index+t[0].length),t[0].length%2!==0||s(i)):"\\"===e.input.peek()&&(e.skipLine(1),s(i))}function o(t){var i=e.parser.preToken,n=e.parser.backs.slice(0),s=e.parser.parseList.slice(0);e.skip(t.index+t[2].length),e.parser.preToken=null,e.parser.backs=[],e.parser.parseList=[],e.parser.parseExprStmt(),e.parser.peekMatch("}"),e.parser.preToken=i,e.parser.backs=n,e.parser.parseList=s}},c.prototype.scanNunmber=function(){var e=null,t=null;return(e=r.number.exec(this.input))&&(t=this.craeteToken(e[0],l.NUMBER),this.skip(e.index+e[0].length)),t},c.prototype.scanIdentifier=function(){var e=null,t=null;return(e=r.identifier.exec(this.input))&&(t=this.craeteToken(e[0],this.isKeyWord(e[0])?l.KEYWORD:l.IDENTIFIER),"true"!==t.value&&"false"!==t.value||(t.type=l.BOOLEAN),"null"===t.value&&(t.type=l.NUMBER),this.skip(e.index+e[0].length)),t},c.prototype.scanBracket=function(){var e=null,t=this.input[0];return this.isBracket(t)&&(e=this.craeteToken(t,l.BRACKET),this.skip(1)),e},c.prototype.scanOperator=function(){var e=this.input[0],t=this.input[1],i=this.input[2],n=this.input[3],s=null;return"."==e&&"."===t&&"."===i?s=this.craeteToken("...",l.OPERATOR):">"===e&&">"===t&&">"===i&&"="===n?s=this.craeteToken(">>>=",l.OPERATOR):"="===e&&"="===t&&"="===i?s=this.craeteToken("===",l.OPERATOR):"!"===e&&"="===t&&"="===i?s=this.craeteToken("!==",l.OPERATOR):">"===e&&">"===t&&">"===i?s=this.craeteToken(">>>",l.OPERATOR):"<"===e&&"<"===t&&"="===i?s=this.craeteToken("<<=",l.OPERATOR):">"===e&&">"===t&&"="===i?s=this.craeteToken(">>=",l.OPERATOR):"="===e&&">"===t?s=this.craeteToken("=>",l.OPERATOR):e===t&&"+-<>&|*".indexOf(e)>=0?s="*"===e&&"="===i?this.craeteToken(e+t+i,l.OPERATOR):this.craeteToken(e+t,l.OPERATOR):"<>=!+-*%&|^/".indexOf(e)>=0?s="="===t?this.craeteToken(e+t,l.OPERATOR):this.craeteToken(e,l.OPERATOR):"?:.;,~".indexOf(e)>-1&&(s=this.craeteToken(e,l.OPERATOR)),s&&this.skip(s.value.length),s},c.prototype.scanOther=function(){var e=null,t=null;return(e=r.other.exec(this.input))&&(t=this.craeteToken(e[0],l.OTHER),this.skip(e.index+e[0].length)),t},c.prototype.next=function(){var e=null,t=this;return this.scanComment(),this.hasNext()&&(e=this.scanIdentifier()||this.scanBracket()||this.scanNunmber()||this.scanString()||i(),!e)?(e=this.scanOther(),e&&u.unexpected(e),this.next()):(this.preToken=e,e);function i(){var e=null;if("/"!==t.input[0]||t.preToken&&t.preToken.type!==l.OPERATOR&&"{"!==t.preToken.value&&"["!==t.preToken.value&&"("!==t.preToken.value&&"return"!==t.preToken.value)e=t.scanOperator();else{var i=r.regex.exec(t.input);if(i)e=t.craeteToken(i[0],l.REGEXP),t.skip(i.index+i[0].length);else if(e=t.craeteToken(t.input,l.REGEXP),t.skipLine(1),"/"!==e.value.peek()){var n=Object.assign({},e);n.value="/",u.unmatch(n)}}return e}},p.prototype.reset=function(e){this.backs=[],this.parseList=[],this.preToken=null,this.recovery(e),u.errors=[]},p.prototype.cache=function(){this.cacheList.length&&this.cacheList.peek().line==this.lexer.line&&this.cacheList.pop(),this.preToken&&this.cacheList.push({line:this.preToken.line,column:this.preToken.column,parseList:this.parseList.slice(0)})},p.prototype.recovery=function(e){var t=0,i=e.split("\n")||[""],n=!1;while(t<i.length&&t<this.lexer.lines.length&&i[t]===this.lexer.lines[t])t++;if(t>0){for(var s=-1,r=0;r<this.cacheList.length;r++){if(!(this.cacheList[r].line<=t))break;s=r}if(s>-1){var o=this.cacheList[s];this.parseList=o.parseList,this.cacheList=this.cacheList.slice(0,s+1),this.lexer.reset({texts:i,line:o.line,column:o.column}),this.next(),n=!0}}n||(this.cacheList=[],this.lexer.reset({texts:i}))},p.prototype.match=function(e,t){for(var i=!1,n=0;n<t.length;n++)if(this.lexer.isTokenType(t[n])){if(t[n]===e.type){i=!0;break}}else if(t[n]===e.value){i=!0;break}return i},p.prototype.next=function(e){var t=null;e=e||1;while(e>0)t=this.backs.length?this.backs.shift():this.lexer.next(),this.pre2Token=this.preToken,this.preToken=t||this.preToken,e--;return this.puted=!1,t},p.prototype.nextMatch=function(e){var t=this.next()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i||(t.value&&this.match(this.peek(),e)?u.unexpected(t):u.expected(t,e)),i},p.prototype.peek=function(e){var t=null;if(e=e||1,this.backs.length&&(t=this.backs[e-1]),!t){e-=this.backs.length;while(e>0)e--,t=this.lexer.next(),t&&this.backs.push(t)}return t||{}},p.prototype.peekMatch=function(e){var t=this.peek()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i?this.next():t.value&&this.match(this.peek(),e)?u.unexpected(t):u.expected(t,e),i},p.prototype.hasNext=function(){var e=this.peek();return e.value},p.prototype.putBack=function(){this.preToken&&!this.puted&&(this.backs.unshift(this.preToken),this.preToken=this.pre2Token,this.puted=!0)},p.prototype.skipSemicolon=function(e){e=e||1/0;while(";"===this.peek().value&&e>0)this.next(),e--},p.prototype.parse=function(){var e=this,t=0,i=Date.now();while(this.hasNext())if(this.parseStmt(),!u.errors.length&&this.cache(),++t%10===0&&Date.now()-i>200){this.parseTimer=setTimeout((function(){e.parseStmt()}),10);break}},p.prototype.parseStmt=function(e){var t=this.peek();if(e){if(";"===t.value)return}else this.preToken&&this.preToken.line==t.line&&"{"!=this.preToken.value&&"}"!=this.preToken.value&&";"!=t.value&&u.expectedSemicolon(t);switch(this.skipSemicolon(),t=this.peek(),t.type===l.IDENTIFIER&&":"===this.peek(2).value&&(this.next(2),t=this.peek()),t.value){case"var":case"let":case"const":this.parseDeclareStmt();break;case"{":":"===this.peek(3).value?this.parseObjectStmt():this.parseBlockStmt();break;case"import":this.parseImportStmt();break;case"export":this.parseExportStmt();break;case"if":this.parseIfStmt();break;case"switch":this.parseSwitchStmt();break;case"with":this.parseWithStmt();break;case"while":this.parseWhileStmt();break;case"do":this.parseDoStmt();break;case"try":this.parseTryStmt();break;case"for":this.parseForStmt();break;case"class":this.parseClassStmt();break;case"continue":case"break":this.parseControlStmt();break;case"return":this.parseReturnStmt();break;case"throw":this.parseThrowStmt();break;case"function":this.parseFunctionStmt(!0);break;default:this.parseExprStmt();break}},p.prototype.parseBlockStmt=function(e){var t=this.peek();this.peekMatch("{");while(this.hasNext()){this.skipSemicolon();var i=this.peek();if("}"===i.value||e&&e.indexOf(i.value)>-1)break;this.parseStmt(!0)}this.peekMatch("}")||"{"!==t.value||u.unmatch(t)},p.prototype.parseObjectStmt=function(){var e=this.peek(),t=null;this.peekMatch("{");while(this.hasNext()&&"}"!=this.peek().value){if("..."===this.peek().value)this.next(),"{"===this.peek().value?this.parseObjectStmt():this.nextMatch(l.IDENTIFIER);else{if("["===this.peek().value)this.next(),this.parseExpr(),this.peekMatch("]");else if(this.peek().type===l.OPERATOR)u.unexpected(this.next());else{if(!this.hasNext())break;this.next()}t=this.peek(),":"===t.value||"]"===this.preToken.value?(this.peekMatch(":"),this.parseExpr()):(this.preToken.type!==l.IDENTIFIER&&u.expected(t,":"),"("===t.value?(this.parseFunArgsStmt(),this.parseBlockStmt()):"("===this.peek(2).value&&("get"!==this.preToken.value&&"static"!==this.preToken.value&&u.expected(this.preToken,["get","static"]),this.nextMatch(l.IDENTIFIER),this.parseFunArgsStmt(),this.parseBlockStmt()))}if("}"!=this.peek().value&&!this.peekMatch(","))break}this.peekMatch("}")||"{"!==e.value||u.unmatch(e)},p.prototype.parseDeclareStmt=function(){var e=this;this.nextMatch(["var","let","const"]),i(),"="===this.peek().value&&t();while(this.hasNext()&&","===this.peek().value)this.next(),i(),"="===this.peek().value&&t();function t(){e.next(),e.parseExpr()}function i(){var t=e.peek();if("{"===t.value||"["===t.value){var i=e.next(),n="{"===t.value?"}":"]";e.nextMatch(l.IDENTIFIER);while(e.hasNext()&&e.peek().value!==n)if(e.peekMatch(","),!e.peekMatch(l.IDENTIFIER))break;e.peekMatch(n)||u.unmatch(i)}else e.nextMatch(l.IDENTIFIER)}},p.prototype.parseAssignStmt=function(e){e=e||"=",this.nextMatch(e);while(this.hasNext()){if("="===this.peek(2).value){!this.lexer.isVariable(this.next())&&u.expected(l.IDENTIFIER),this.parseAssignStmt("=");break}if(this.parseExpr(),","!==this.peek().value)break;this.next()}},p.prototype.parseImportStmt=function(){var e=null;if(this.nextMatch("import"),e=this.peek(),e.type===l.STRING)this.next();else{if("{"===e.value){this.next(),this.nextMatch(l.IDENTIFIER);while(this.hasNext()&&"}"!=this.peek().value){if(this.peekMatch(","),!this.peekMatch(l.IDENTIFIER))break;"as"===this.peek().value&&(this.next(),this.nextMatch(l.IDENTIFIER))}this.peekMatch("}")||u.unmatch(e)}else"*"===e.value?(this.next(),this.nextMatch("as"),this.nextMatch(l.IDENTIFIER)):this.nextMatch(l.IDENTIFIER);this.nextMatch("from"),this.nextMatch(l.STRING)}},p.prototype.parseExportStmt=function(){var e=null;if(this.nextMatch("export"),e=this.peek(),"function"===e.value)this.next(),this.parseFunctionStmt();else if("default"===e.value)this.next(),e=this.peek(),"function"==e.value?this.parseFunctionStmt():"class"===e.value?this.parseClassStmt():this.parseExprStmt();else if("{"===e.value){this.next(),this.nextMatch(l.IDENTIFIER);while(this.hasNext()&&"}"!=this.peek().value){if(this.peekMatch(","),!this.peekMatch(l.IDENTIFIER))break;"as"===this.peek().value&&(this.next(),this.nextMatch(l.IDENTIFIER))}this.peekMatch("}")||u.unmatch(e),"from"===this.peek().value&&(this.next(),this.nextMatch(l.STRING))}else"*"===e.value?(this.next(),"as"===this.peek().value&&(this.nextMatch("as"),this.nextMatch(l.IDENTIFIER)),this.nextMatch("from"),this.nextMatch(l.STRING)):this.parseDeclareStmt()},p.prototype.parseIfStmt=function(){var e=this,t=null;function i(){e.peekMatch("("),e.parseExprStmt(),e.peekMatch(")")}function n(){if("{"!==e.peek().value)return e.parseStmt(!0),!0;e.parseBlockStmt(["else"])}this.nextMatch("if"),this.parseList.push("if"),i(),t=n()&&";"===this.peek().value?this.peek(2):this.peek(),"else"===t.value&&(";"===this.next().value&&this.next(),"if"===this.peek().value?this.parseIfStmt():n()),this.parseList.pop()},p.prototype.parseSwitchStmt=function(){var e=null,t=null;this.parseList.push("switch"),this.nextMatch("switch"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),e=this.peek(),this.peekMatch("{");while(this.hasNext()&&"}"!=this.peek().value){"default"===this.peek().value?this.nextMatch("default"):(this.nextMatch("case"),this.parseExprStmt()),this.peekMatch(":");while(this.hasNext()){if(this.skipSemicolon(),t=this.peek(),"}"===t.value||"break"===t.value||"case"===t.value||"default"===t.value)break;this.parseStmt(!0)}if("break"===this.peek().value){var i={"}":!0,case:!0,default:!0};if(this.next(),this.skipSemicolon(),t=this.peek(),!i[t.value]){u.expected(t,["case","default"]);while(this.hasNext()&&!i[this.peek().value])this.next()}}}this.peekMatch("}")||"{"!==e.value||u.unmatch(e),this.parseList.pop()},p.prototype.parseWithStmt=function(){this.nextMatch("with"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),this.parseBlockStmt()},p.prototype.parseWhileStmt=function(){this.parseList.push("while"),this.nextMatch("while"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),"{"===this.peek().value?this.parseBlockStmt():this.parseStmt(!0),this.parseList.pop()},p.prototype.parseDoStmt=function(){this.parseList.push("do"),this.nextMatch("do"),"{"===this.peek().value?this.parseBlockStmt():(this.parseStmt(!0),this.skipSemicolon(1)),this.nextMatch("while"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),this.parseList.pop()},p.prototype.parseTryStmt=function(){var e=null;this.nextMatch("try"),this.parseBlockStmt(),e=this.peek(),"catch"!==e.value&&"finally"!==e.value?u.expected(e,["catch","finally"]):("catch"===e.value&&(this.nextMatch("catch"),this.peekMatch("("),this.nextMatch(l.IDENTIFIER),this.peekMatch(")"),this.parseBlockStmt()),"finally"===this.peek().value&&(this.next(),this.parseBlockStmt()))},p.prototype.parseForStmt=function(){this.parseList.push("for"),this.nextMatch("for"),this.peekMatch("("),"in"===this.peek(2).value||"of"===this.peek(2).value||"in"===this.peek(3).value||"of"===this.peek(3).value?("in"!==this.peek(3).value&&"of"!==this.peek(3).value||this.nextMatch(["var","let","const"]),this.nextMatch(l.IDENTIFIER),this.nextMatch(["in","of"]),this.parseExprStmt()):(["var","let","const"].indexOf(this.peek().value)>-1?this.parseDeclareStmt():";"!=this.peek().value&&this.parseExprStmt(),this.nextMatch(";"),";"!=this.peek().value&&this.parseExprStmt(),this.nextMatch(";"),")"!=this.peek().value&&this.parseExprStmt()),this.peekMatch(")"),"{"===this.peek().value?this.parseBlockStmt():this.parseStmt(!0),this.parseList.pop()},p.prototype.parseFunctionStmt=function(e){this.nextMatch("function"),(this.peek().type===l.IDENTIFIER||e)&&this.nextMatch(l.IDENTIFIER),this.parseFunArgsStmt(),this.parseBlockStmt()},p.prototype.parseClassStmt=function(){var e=null,t=!this.preToken||-1==["(","=","default"].indexOf(this.preToken.value);this.nextMatch("class"),(this.peek().type===l.IDENTIFIER||t)&&this.nextMatch(l.IDENTIFIER),"extends"===this.peek().value&&(this.next(),this.nextMatch(l.IDENTIFIER)),e=this.peek(),this.peekMatch("{");while(this.hasNext()&&"}"!=this.peek().value)"="===this.peek(2).value?(this.nextMatch(l.IDENTIFIER),this.parseAssignStmt("=")):("static"!==this.peek().value&&"get"!==this.peek().value||this.next(),this.nextMatch(l.IDENTIFIER),this.parseFunArgsStmt(),this.parseBlockStmt());this.peekMatch("}")||"{"!==e.value||u.unmatch(e)},p.prototype.parseFunArgsStmt=function(){var e=this;this.peekMatch("("),")"!=this.peek().value&&this.nextMatch(l.IDENTIFIER),"="===this.peek().value&&t();while(this.hasNext()&&","===this.peek().value)this.next(),this.nextMatch(l.IDENTIFIER),"="===this.peek().value&&t();function t(){e.next(),e.parseExpr()}this.peekMatch(")")},p.prototype.parseControlStmt=function(){var e=this.next();this.checkIn(["for","while","do","if"])?this.peek().type===l.IDENTIFIER&&this.next():u.unexpected(e)},p.prototype.parseReturnStmt=function(){var e=null;this.nextMatch("return"),e=this.peek(),";"!==e.value&&"}"!==e.value&&e.line===this.preToken.line&&this.parseExprStmt()},p.prototype.parseThrowStmt=function(){var e=null;this.nextMatch("throw"),e=this.peek(),e.line!==this.preToken.line?u.expected(e,"expression"):this.parseExprStmt()},p.prototype.checkIn=function(e){e=e instanceof Array?e:[e];for(var t=this.parseList.length;t>=0;t--)if(e.indexOf(this.parseList[t])>-1)return!0;return!1},p.prototype.parseRegex=function(){if(this.next(),this.peek().type===l.IDENTIFIER){var e=this.peek().value.toLowerCase();o[e.split("").sort().join("")]&&this.next()}},p.prototype.parseExprStmt=function(){while(this.hasNext()){if(this.parseExpr(),","!=this.peek().value)break;this.next()}},p.prototype.parseExpr=function(){this.peek();var e=null;if(this.hasNext())while(1){var t=this.parseLeftHand();if(t.end)break;if(e=this.peek(),"."===e.value&&this.preToken.type!==l.NUMBER&&(this.parseDot(),e=this.peek(),t.assignAble=!0),"["===e.value&&this.preToken.type!==l.NUMBER&&(this.parseProperty(),e=this.peek(),t.assignAble=!0),this.lexer.isPostOp(e)&&(!t.assignAble&&u.expectedIdentifier(e),t.assignAble=!1,this.next(),e=this.peek()),"?"!==e.value){if(this.lexer.isAssignOperator(e)&&t.assignAble){this.parseAssignStmt(this.peek().value);break}if(!this.lexer.isBinaryOperator(e))break;if(this.next(),!this.hasNext()){u.unexpected(this.preToken);break}}else this.nextMatch("?"),this.parseExpr(),this.peekMatch(":")}else u.expected(null,"expression")},p.prototype.parseLeftHand=function(){var e=this.preToken,t=this.next(),i=null,n=!1,s=!1,r=!1,o=!1;if(this.lexer.isUnitOperator(t)){if("!"===t.value||"delete"===t.value||"void"===t.value){var a=t.value;while(t&&t.value===a)
//!!!...
e=t,t=this.next()}else e=t,t=this.next();o=!0}return t&&this.lexer.isPreOp(t)&&(e=t,t=this.next(),t&&!this.lexer.isVariable(t)&&u.expectedIdentifier(t),r=!0),i=this.peek(),t?"function"===t.value?(this.putBack(),this.parseFunctionStmt(),"("===this.peek().value&&this.parseCallArgs()):"("===t.value?(this.putBack(),this.parseParen(),n=!0):"["===t.value?(this.putBack(),this.parseArray()):"new"===t.value?(this.putBack(),this.parseNew()):"{"==t.value?(this.putBack(),this.parseObjectStmt()):t.type===l.REGEXP?(this.putBack(),this.parseRegex()):"("!==i.value||r?"=>"!==i.value||r||o||!this.lexer.isVariable(t)?r||o||!this.lexer.isVariable(t)?this.lexer.isValue(t)||(u.expectedIdentifier(t),s=!0):n=!0:(this.parseArrorwFunction(e&&":"===e.value),s=!0):this.parseCallArgs():(u.expectedIdentifier(),s=!0),{assignAble:n,end:s}},p.prototype.parseParen=function(){var e=1,t=this.peek(),i=this.preToken;this.nextMatch("(");var n=this.peek();while(n.value&&")"!=n.value)e++,n=this.peek(e);")"===n.value&&"=>"===this.peek(e+1).value?(this.putBack(),this.parseFunArgsStmt(),this.parseArrorwFunction(i&&":"===i.value)):(this.parseExprStmt(),!this.peekMatch(")")&&u.unmatch(t),"("===this.peek().value&&this.parseCallArgs())},p.prototype.parseArray=function(){var e=null;this.nextMatch("[");while(this.hasNext()&&"]"!==this.peek().value){if("..."===this.peek().value&&this.next(),this.parseExpr(),e=this.peek(),","!==e.value)break;this.next()}this.nextMatch("]")},p.prototype.parseNew=function(){this.nextMatch("new"),"("===this.peek().value?this.parseParen():this.nextMatch([l.IDENTIFIER,l.KEYWORD]),"("===this.peek().value&&this.parseCallArgs()},p.prototype.parseArrorwFunction=function(e){this.nextMatch("=>"),"{"===this.peek().value?this.parseBlockStmt():e?this.parseExpr():this.parseExprStmt()},p.prototype.parseCallArgs=function(){if(this.peekMatch("("),")"!==this.peek().value)while(this.hasNext()){if("..."===this.peek().value?(this.next(),"{"===this.peek().value?this.parseObjectStmt():this.nextMatch(l.IDENTIFIER)):this.parseExpr(),")"===this.peek().value)break;this.peekMatch(",")}this.peekMatch(")"),"("===this.peek().value&&this.parseCallArgs()},p.prototype.parseDot=function(){var e=null;this.preToken.type!==l.NUMBER&&this.preToken.type!==l.BOOLEAN?(this.nextMatch("."),e=this.peek(),this.lexer.isDotAble(e)?(this.next(),e=this.peek(),"("===e.value&&this.parseCallArgs(),e=this.peek(),"["===e.value?this.parseProperty():"."===e.value&&this.parseDot()):u.expected(e,l.IDENTIFIER)):u.unexpected(this.next())},p.prototype.parseProperty=function(){var e=null;this.nextMatch("["),this.parseExprStmt(),this.nextMatch("]"),e=this.peek(),"("===e.value&&this.parseCallArgs(),e=this.peek(),"["===e.value?this.parseProperty():"."===e.value&&this.parseDot()};var d=new c,f=new p(d);return d.parser=f,{parse:function(e){var t=null;return clearTimeout(f.parseTimer),f.reset(e),f.parse(),t=u.errors.map((function(e){var t=e.line,i=e.column;return(!e.line||e.line>d.lines.length)&&(t=d.lines.length,i=d.lines.peek().length),{line:t,column:i,error:e.error}})).sort((function(e,t){return e.line===t.line?e.column-t.column:e.line-t.line})),console.log(t),t}}},V=function(){Array.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},Array.prototype._isArray=!0,String.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]};var e=["{","}","[","]","(",")"],t={space:/^\s+/,tag:/^@?[a-zA-Z_\-][a-zA-Z0-9_\-]*/,propertyName:/^[\*]?[a-zA-Z_$][a-zA-Z0-9_\-$]*/,numValue:/^(?:\d+(?:\.\d*)?|\.\d+)(?:[sS%]|px|PX)?/,propertyValue:/^[+\-]?[a-zA-Z0-9_\-$%]+|^#[a-zA-Z0-9]+/,punctuator:/^[\+\-\*\~\,\:\;\.\#\=\!]/,comment:/\*\//,string1:/\\*'/,string2:/\\*"/,other:/^[\s\S]/},i=100;function n(e,t){this.type=e,this.label=t,this._isTokenType=!0}function s(e){this.type=e}function r(e,t,i){e=e||{},this.type=t,this.param=i,this.line=e.line,this.column=e.column,this.value=e.value,this.error=this.toString()}function o(){this.init()}function a(e){this.lexer=e,this.cacheList=[],this.backs=[],this.parseList=[],this.preToken=null,r.errors=[]}n.prototype.toString=function(){return this.label},n.STRING=new n(2,"string"),n.SELECTOR=new n(3,"selector"),n.PROPERTY=new n(4,"property"),n.VALUE=new n(5,"value"),n.NUM_VALUE=new n(6,"numValue"),n.BRACKET=new n(7,"bracket"),n.PUNCTUATOR=new n(8,"punctuator"),n.OTHER=new n(10,"other"),s.UNEXPECTED=new s(1),s.EXPECTED=new s(2),s.MISS=new s(3),s.UNMATCH=new s(4),r.prototype.toString=function(){var e="",t=this.param instanceof Array?this.param:[this.param];switch(t="".concat(1===t.length?"a ":"","'").concat(t.join("'、'"),"'"),this.type){case s.UNEXPECTED:e="unexpected '".concat(this.value,"'");break;case s.EXPECTED:e="expected ".concat(t),this.value&&(e+=" and instead saw '".concat(this.value,"'"));break;case s.MISS:e="missing ".concat(t),this.value&&(e+=" before '".concat(this.value,"'"));break;case s.UNMATCH:e="unmatched '".concat(this.value,"'");break}return e},r.push=function(e){r.errors.push(e)},r.expected=function(e,t){r.push(new r(e,s.EXPECTED,t))},r.unexpected=function(e){r.push(new r(e,s.UNEXPECTED))},r.unmatch=function(e){r.push(new r(e,s.UNMATCH))},o.prototype.init=function(){var t=this;r.errors=[],this.lines=[""],this.line=1,this.column=0,this.input="",this.bracketsMap=new Map,e.map((function(e){t.bracketsMap.set(e,!0)}))},o.prototype.reset=function(e){this.lines=e.texts,this.line=e.line||1,this.column=e.column||0,this.input=this.lines[this.line-1].slice(this.column)},o.prototype.skip=function(e){this.input=e?this.input.slice(e):this.input,this.column+=e},o.prototype.skipLine=function(e){this.line+=e,this.column=0,this.input=this.lines[this.line-1]||""},o.prototype.hasNext=function(){return!(r.errors.length>i)&&(this.line<this.lines.length||this.line==this.lines.length&&this.lines.peek().length>this.column)},o.prototype.isBracket=function(e){return this.bracketsMap.has(e)},o.prototype.isTokenType=function(e){return e._isTokenType},o.prototype.isProp=function(e){return e.type===n.SELECTOR||e.type===n.PROPERTY},o.prototype.isValue=function(e){return e.type===n.VALUE||e.type===n.NUM_VALUE||e.type===n.SELECTOR||e.type===n.PROPERTY||e.type===n.STRING},o.prototype.craeteToken=function(e,t){var i=this.line,n=this.column;return i>this.lines.length&&(i=this.lines.length,n=this.lines.peek().length),{type:t,line:i,column:n,value:e}},o.prototype.scanSpace=function(){var e=null;while(!this.input.length&&this.line<this.lines.length)this.skipLine(1);e=t.space.exec(this.input),e&&(this.skip(e.index+e[0].length),e.index>=this.input.length-1&&this.scanSpace())},o.prototype.scanComment=function(){var e=null,i=null,n=null,s=null;if(this.scanSpace(),i=this.input[0],n=this.input[1],"/"===i&&"*"===n){s=this.craeteToken("/*"),this.skip(2);while(this.hasNext()&&!(e=t.comment.exec(this.input)))this.skipLine(1);e?this.skip(e.index+e[0].length):r.unmatch(s)}},o.prototype.scanString=function(){var e=this,i=null,s=null,o=null;return"'"===this.input[0]?(o=this.craeteToken("'",n.STRING),this.skip(1),i=a(t.string1),s=this.craeteToken("'",n.STRING),i||(r.unmatch(o),this.skipLine(1)),s):'"'===this.input[0]?(o=this.craeteToken('"',n.STRING),this.skip(1),i=a(t.string2),s=this.craeteToken('"',n.STRING),i||(r.unmatch(o),this.skipLine(1)),s):s;function a(t){return!!e.hasNext()&&((i=t.exec(e.input))?(e.skip(i.index+i[0].length),i[0].length%2!==0||a(t)):(e.skipLine(1),a(t)))}},o.prototype.scanIdentifier=function(){var e=null,i=null;return(e=t.tag.exec(this.input))?(i=this.craeteToken(e[0],n.SELECTOR),this.skip(e.index+e[0].length)):(e=t.propertyName.exec(this.input))?(i=this.craeteToken(e[0],n.PROPERTY),this.skip(e.index+e[0].length)):(e=t.numValue.exec(this.input))?(i=this.craeteToken(e[0],n.NUM_VALUE),this.skip(e.index+e[0].length)):(e=t.propertyValue.exec(this.input))&&(i=this.craeteToken(e[0],n.VALUE),this.skip(e.index+e[0].length)),i},o.prototype.scanBracket=function(){var e=null,t=this.input[0];return this.isBracket(t)&&(e=this.craeteToken(t,n.BRACKET),this.skip(1)),e},o.prototype.scanPunctuator=function(){var e=null;return(exec=t.punctuator.exec(this.input))&&(e=this.craeteToken(exec[0],n.PUNCTUATOR),this.skip(exec.index+exec[0].length)),e},o.prototype.scanOther=function(){var e=null,i=null;return(e=t.other.exec(this.input))&&(i=this.craeteToken(e[0],n.OTHER),this.skip(e.index+e[0].length)),i},o.prototype.next=function(){var e=null;return this.scanComment(),this.hasNext()&&(e=this.scanIdentifier()||this.scanBracket()||this.scanString()||this.scanPunctuator(),!e)?(e=this.scanOther(),e&&r.unexpected(e),this.next()):(this.preToken=e,e)},a.prototype.reset=function(e){this.backs=[],this.parseList=[],this.preToken=null,this.recovery(e),r.errors=[]},a.prototype.cache=function(){this.cacheList.length&&this.cacheList.peek().line==this.lexer.line&&this.cacheList.pop(),this.preToken&&this.cacheList.push({line:this.preToken.line,column:this.preToken.column,parseList:this.parseList.slice(0)})},a.prototype.recovery=function(e){var t=0,i=e.split("\n")||[""],n=!1;while(t<i.length&&t<this.lexer.lines.length&&i[t]===this.lexer.lines[t])t++;if(t>0){for(var s=-1,r=0;r<this.cacheList.length;r++){if(!(this.cacheList[r].line<=t))break;s=r}if(s>-1){var o=this.cacheList[s];this.parseList=o.parseList,this.cacheList=this.cacheList.slice(0,s+1),this.lexer.reset({texts:i,line:o.line,column:o.column}),this.next(),n=!0}}n||(this.cacheList=[],this.lexer.reset({texts:i}))},a.prototype.match=function(e,t){for(var i=!1,n=0;n<t.length;n++)if(this.lexer.isTokenType(t[n])){if(t[n]===e.type){i=!0;break}}else if(t[n]===e.value){i=!0;break}return i},a.prototype.next=function(e){var t=null;e=e||1;while(e>0)t=this.backs.length?this.backs.shift():this.lexer.next(),this.pre2Token=this.preToken,this.preToken=t||this.preToken,e--;return this.puted=!1,t},a.prototype.nextMatch=function(e){var t=this.next()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i||(t.value&&this.match(this.peek(),e)?r.unexpected(t):r.expected(t,e)),i},a.prototype.peek=function(e){var t=null;if(e=e||1,this.backs.length&&(t=this.backs[e-1]),!t){e-=this.backs.length;while(e>0)e--,t=this.lexer.next(),t&&this.backs.push(t)}return t||{}},a.prototype.peekMatch=function(e){var t=this.peek()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i?this.next():t.value&&this.match(this.peek(),e)?r.unexpected(t):r.expected(t,e),i},a.prototype.hasNext=function(){var e=this.peek();return e.value},a.prototype.putBack=function(){this.preToken&&!this.puted&&(this.backs.unshift(this.preToken),this.preToken=this.pre2Token,this.puted=!0)},a.prototype.skipSemicolon=function(e){e=e||1/0;while(";"===this.peek().value&&e>0)this.next(),e--},a.prototype.parse=function(){var e=this,t=0,i=Date.now();while(this.hasNext())if(this.parseStmt(),!r.errors.length&&this.cache(),++t%10===0&&Date.now()-i>200){this.parseTimer=setTimeout((function(){e.parseStmt()}),10);break}},a.prototype.parseStmt=function(){var e=this.peek();"@import"!==e.value?"@charset"!==e.value?"@keyframes"!==e.value&&"@-webkit-keyframes"!==e.value?"@media"!==e.value?(this.parseSelector(),"{"===this.peek().value&&this.parseBlock()):this.parseMedia():this.parseKeyFrames():this.parseCharset():this.parseImport()},a.prototype.parseImport=function(){this.nextMatch("@import"),this.nextMatch(n.STRING),["all","print","screen","speech"].indexOf(this.peek().value)>-1&&this.parseMedia(!0),this.peekMatch(";")},a.prototype.parseCharset=function(){this.nextMatch("@charset"),this.nextMatch(n.STRING),this.peekMatch(";")},a.prototype.parseMedia=function(e){var t=null;!e&&this.nextMatch("@media"),t=this.peek(),"not"!==t.value&&"only"!==t.value||this.next(),this.nextMatch(["all","print","screen","speech"]);while(this.hasNext()){if(t=this.peek(),"and"!==t.value&&"or"!==t.value)break;this.next(),this.nextMatch("("),t=this.next()||{},this.lexer.isProp(t)||r.expected(t,n.PROPERTY),")"!=this.peek().value&&(this.peekMatch(":"),t=this.next()||{},this.lexer.isValue(t)||r.expected(t,n.VALUE),this.peekMatch(")"))}e||(this.peekMatch("{"),this.parseStmt(),this.peekMatch("}"))},a.prototype.parseKeyFrames=function(){var e=null;this.nextMatch(["@keyframes","@-webkit-keyframes"]),e=this.next(),e.type!==n.SELECTOR&&r.expected(e,"name"),this.peekMatch("{");while(this.hasNext()){if("}"===this.peek().value)break;this.nextMatch(n.NUM_VALUE),this.parseBlock()}this.peekMatch("}")},a.prototype.parseSelector=function(){var e=this.next()||{};"."===e.value||"#"===e.value?this.nextMatch(n.SELECTOR):"["===e.value?(this.nextMatch(n.SELECTOR),"]"!==this.peek().value?(this.nextMatch("="),e=this.peek(),this.lexer.isValue(e)?this.next():r.expected(e,"value"),this.peekMatch("]")):this.next()):":"===e.value?(":"===this.peek().value&&this.next(),this.nextMatch(n.SELECTOR),"("===this.peek().value&&(this.next(),this.parseSelector(),this.peekMatch(")"))):"*"!==e.value&&(this.putBack(),this.nextMatch(n.SELECTOR)),this.hasNext()&&"{"!==this.peek().value&&(e=this.peek(),("+"===e.value||"~"===e.value||","===e.value)&&this.next(),this.parseSelector())},a.prototype.parseBlock=function(){var e=this;this.nextMatch("{");while(this.hasNext()){if("}"===this.peek().value)break;t(),this.peekMatch(":"),i(),"}"!==this.peek().value&&this.peekMatch(";")}function t(){var t=e.next();t.type!==n.SELECTOR&&t.type!==n.PROPERTY&&r.expected(n.PROPERTY)}function i(){var t=!1;while(e.hasNext()){var s=e.peek();if(";"===s.value||"}"===s.value||")"===s.value)break;if(s=e.next(),e.lexer.isValue(s))t=!0;else if("("===s.value){var o=1;while(e.hasNext()&&o){var a=e.next()||{};")"===a.value?o--:"("===a.value&&o++}o&&e.peekMatch(")")}else{if(t&&","===s.value){i();break}if(t&&"!"===s.value){e.peekMatch("important");break}r.expected(s,n.VALUE)}}return t||r.expected(null,n.VALUE),t}this.peekMatch("}")};var l=new o,h=new a(l);return l.parser=h,{parse:function(e){var t=null;return clearTimeout(h.parseTimer),h.reset(e),h.parse(),t=r.errors.map((function(e){var t=e.line,i=e.column;return(!e.line||e.line>l.lines.length)&&(t=l.lines.length,i=l.lines.peek().length),{line:t,column:i,error:e.error}})).sort((function(e,t){return e.line===t.line?e.column-t.column:e.line-t.line})),console.log(t),t}}};function $(){var e={js:/(?<!\<[^\>]*?['"][^\>]*?)(\<script(?:\s[^\>]*?)?\>)([\s\S]*?)\<\/script\>/,css:/(?<!\<[^\>]*?['"][^\>]*?)(\<style(?:\s[^\>]*?)?\>)([\s\S]*?)\<\/style\>/,enter:/\n/g,column:/\n([^\n]+)$/,comment:/\<\!--[\s\S]*?--\>/};function t(){}t.prototype.reset=function(e){this.text=e,this.comments=[]},t.prototype.parseComentRange=function(){var t=null,i={line:1,column:0,index:0},n=this.text,s=null,r=null;while(t=e.comment.exec(n))this.setLineColumn(n.slice(0,t.index),i),i.index+=t.index,s=Object.assign({},i),this.setLineColumn(t[0],i),i.index+=t[0].length,r=Object.assign({},i),n=this.text.slice(i.index),this.comments.push({start:s,end:r})},t.prototype.setLineColumn=function(t,i){var n=t.match(e.enter);if(n=n&&n.length||0,i.line+=n,n){var s=e.column.exec(t);i.column=s&&s[1].length||0}else i.column+=t.length},t.prototype.parse=function(){return this.parseComentRange(),i.parseJs().concat(i.parseCss())},t.prototype.parseJs=function(){var t=jsParser().parse;return this._parse(e.js,t)},t.prototype.parseCss=function(){var t=cssParser().parse;return this._parse(e.css,t)},t.prototype._parse=function(e,t){var i=null,n={line:1,column:0,index:0},s=this.text,r=[];while(i=e.exec(s))if(this.setLineColumn(s.slice(0,i.index),n),n.index+=i.index,this.checkInComment(n)){if(this.setLineColumn(i[1],n),n.index+=i[1].length,i[2]){var o=t(i[2]);o.map((function(e){1==e.line&&(e.column+=n.column),e.line+=n.line-1})),r=r.concat(o)}this.setLineColumn(i[0].slice(i[1].length),n),n.index+=i[0].slice(i[1].length).length,s=this.text.slice(n.index)}else s=this.text.slice(n.index);return r},t.prototype.checkInComment=function(e){for(var t=0;t<this.comments.length;t++){var i=this.comments[t];if(n(i.start,e)<0&&n(i.end,e)>0)return e.line=i.end.line,e.column=i.end.column,e.index=i.end.index,!1}return!0;function n(e,t){return e.line===t.line?e.column-t.column:e.line-t.line}};var i=new t;return{parse:function(e){var t=null;return i.reset(e),t=i.parse(),t.sort((function(e,t){return e.line===t.line?e.column-t.column:e.line-t.line})),t}}}var X=new Function("function jsParser()".concat(U.toString().replace(/^[^\)]+?\)/,""),"\nfunction cssParser()").concat(V.toString().replace(/^[^\)]+?\)/,""),"\nfunction htmlParser()").concat($.toString().replace(/^[^\)]+?\)/,""),"\nreturn htmlParser();\n")),Y=function(){function e(t,i){Object(v["a"])(this,e),this.parseId=1,this.initProperties(t,i),this.initLanguage(t.language)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){H.defineProperties(this,t,["htmls"]),H.defineProperties(this,e,["setErrorMap"])}},{key:"initLanguage",value:function(e){var t=this;if(this.language!==e){switch(this.language=e,this.worker&&this.worker.terminate(),this.worker=null,this.setErrorMap({}),e){case"HTML":this.worker=this.createWorker(X);break;case"JavaScript":this.worker=this.createWorker(U);break;case"CSS":this.worker=this.createWorker(V);break}this.worker&&(this.worker.onmessage=function(e){var i=e.data.parseId,n=e.data.errors,s=0,r={};if(t.parseId==i){while(s<n.length){var o=n[s].line,a=[];while(s<n.length&&n[s].line===o)a.push(n[s].error),s++;o=o||t.htmls.length,r[o]=a.join("<br>")}t.setErrorMap(r)}},this.parse())}}},{key:"createWorker",value:function(e){var t=e.toString().replace(/^[^\)]+?\)/,""),i="function fun()".concat(t,"\n            let parser = fun();\n            self.onmessage = function(e) {\n                var parseId = e.data.parseId;\n                var errors = parser.parse(e.data.text);\n                self.postMessage({\n                    errors: errors,\n                    parseId: parseId\n                });\n            }");return H.createWorker(i)}},{key:"onInsertContentBefore",value:function(e){}},{key:"onInsertContentAfter",value:function(e){var t=this;this.worker&&(clearTimeout(this.parseTimer),this.parseTimer=setTimeout((function(){t.parse()}),300))}},{key:"onDeleteContentBefore",value:function(e){}},{key:"onDeleteContentAfter",value:function(e){var t=this;this.worker&&(clearTimeout(this.parseTimer),this.parseTimer=setTimeout((function(){t.parse()}),300))}},{key:"parse",value:function(){var e=this.htmls.map((function(e){return e.text})).join("\n");this.parseId++,this.worker.postMessage({text:e,parseId:this.parseId})}}]),e}(),K=function(){function e(t,i){Object(v["a"])(this,e),this.editorFunObj={},this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){H.defineProperties(this.editorFunObj,e,["unFold"]),H.defineProperties(this,e,["selecter","multiCursorPos"]),H.defineProperties(this,t,["htmls","selectedRanges","folds","foldMap"])}},{key:"onInsertContentBefore",value:function(e){var t=this,i=e.line;if(this.onInsertContentBefore.preCursorPos=e,this.folds.length){var n=this.findFoldIndex(i),s=[];while(n<this.folds.length&&this.folds[n].start.line<i&&this.folds[n].end.line>i)s.push(this.folds[n].start.line),n++;s.map((function(e){t.editorFunObj.unFold(e)}))}}},{key:"onInsertContentAfter",value:function(e){var t=this,i=this.onInsertContentBefore.preCursorPos;this.folds.slice().reverse().map((function(n){n.start.line>i.line?e.line-i.line>0&&(t.foldMap.delete(n.start.line),n.start.line+=e.line-i.line,n.end.line+=e.line-i.line,t.foldMap.set(n.start.line,n)):n.start.line===i.line&&e.line-i.line>0&&t.unFold(n.start.line)}))}},{key:"onDeleteContentBefore",value:function(e){var t=this;this.onDeleteContentBefore.preCursorPos=e,this.onDeleteContentBefore.maxLine=this.htmls.length,this.selectedRanges.map((function(e){if(t.selecter.checkSelectedActive(e))for(var i=e.start,n=e.end,s=i.line;s<=n.line;s++)t.editorFunObj.unFold(s)}))}},{key:"onDeleteContentAfter",value:function(e){var t=this,i=e.line,n=this.onDeleteContentBefore.preCursorPos,s=this.onDeleteContentBefore.maxLine-this.htmls.length;if(this.folds.length){var r=this.findFoldIndex(i),o=[];while(r<this.folds.length&&this.folds[r].start.line<i&&this.folds[r].end.line>i)o.push(this.folds[r].start.line),r++;o.map((function(e){t.editorFunObj.unFold(e)}))}this.folds.slice().reverse().map((function(e){e.start.line>n.line?s>0&&(1===s&&n.line===i&&e.start.line===n.line+1?t.unFold(e.start.line):(t.foldMap.delete(e.start.line),e.start.line-=s,e.end.line-=s,t.foldMap.set(e.start.line,e))):e.start.line===n.line&&s>0&&t.unFold(e.start.line)}))}},{key:"findFoldIndex",value:function(e){var t=0,i=this.folds.length-1;while(t<i){var n=Math.floor((t+i)/2),s=this.folds[n];s.start.line<e?s.end.line<=e?t=n+1:i=n:s.start.line==e?t=n+1:i=n-1}return t}},{key:"foldLine",value:function(e){var t=e,i=this.getRangeFold(e);if(i){for(var n=i.start.line;n<i.end.line;n++)this.foldMap.has(n)&&this.foldMap.get(n).end.line>i.end.line&&this.unFold(n);this.foldMap.set(t,i),this.folds.push(i),this.folds.sort((function(e,t){return e.start.line-t.start.line}))}return i}},{key:"unFold",value:function(e){var t=0,i=this.folds.length;if(!this.foldMap.has(e))return!1;while(t<=i){var n=Math.floor((t+i)/2);if(this.folds[n].start.line==e){this.folds.splice(n,1);break}this.folds[n].start.line>e?i=n-1:t=n+1}return this.foldMap.delete(e),!0}},{key:"getRangeFold",value:function(e,t){var i=[],n=e,s=this.htmls[n-1],r=null;if(e++,s.folds&&s.folds.length)for(var o=0;o<s.folds.length;o++){var a=s.folds[o];-1==a.type&&(i.length&&i.peek().name!=a.name||i.push(a))}while(i.length&&e<=this.htmls.length&&(!t||e-n<=1)){if(s=this.htmls[e-1],s.folds&&s.folds.length)for(var l=0;l<s.folds.length;l++){var h=s.folds[l];if(-1==h.type)i.peek().name==h.name&&i.push(h);else if(i.peek().name==h.name){if(1==i.length){if(t)return e-n>1;r={start:{line:n,start:i.peek().start},end:{line:e,end:h.end},name:h.name},i.pop();break}i.pop()}}e++}return t?e-n>1:r}},{key:"getRealLine",value:function(e){var t=0,i=1,n=1;while(t<this.folds.length&&i<e){var s=this.folds[t];if(!(i+s.start.line-n<e))break;i+=s.start.line+1-n,n=s.end.line,t++;while(t<this.folds.length&&this.folds[t].end.line<=s.end.line)t++}return n+=e-i,n}},{key:"getRelativeLine",value:function(e){var t=e,i=0;while(i<this.folds.length){var n=this.folds[i];if(!(e>=n.end.line))break;t-=n.end.line-n.start.line-1,i++;while(i<this.folds.length&&this.folds[i].end.line<=n.end.line)i++}return t}}]),e}(),G=function(){function e(t,i){Object(v["a"])(this,e),this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){H.defineProperties(this,e,["selecter","nowCursorPos"]),H.defineProperties(this,t,["htmls"])}},{key:"search",value:function(e,t){var i=this.checkCache(e);if(i)return i;var n=null,s=null,r=null,o=null,a=null,l=null,h=[],u=null,c=this,p=1,d=0,f=this.htmls.map((function(e){return e.text})).join("\n"),m=e.split(/\n/),v=e.replace(/\\|\.|\*|\+|\-|\?|\(|\)|\[|\]|{|\}|\^|\$|\~|\!/g,"\\$&");v=(t.wholeWord?"\\b":"")+v+(t.wholeWord?"\\b":""),t=t||{},n=new RegExp("[^\n]*?("+v+")|[^\n]*?\n",t.ignoreCase?"img":"mg");while(s=n.exec(f))s[1]?(r&&r[1]&&r.index+r[0].length!==s.index&&(p++,d=0),o={line:p,column:d+s[0].length-m[0].length},a={line:p+m.length-1,column:m.length>1?m.peek().length:d+s[0].length},d=a.column,u={start:o,end:a},!l&&H.comparePos(a,c.nowCursorPos)>=0&&(l=u,h.index=h.length),h.push(u)):(p++,d=0),r=s;return!l&&h.length&&(h.index=0,l=h[0]),this.cache(e,h),{list:h,result:l}}},{key:"checkCache",value:function(e){if(!this.cacheData||this.cacheData.str!==e)return null;var t=this.cacheData.resultCaches,i=this.cacheData.resultIndexMap,n=t.index+1,s=null;return n==t.length&&(n=0),i[n]||(s=t[n],t.index=n,i[n]=!0),{list:t,result:s}}},{key:"hasCache",value:function(){return!!this.cacheData}},{key:"cache",value:function(e,t){var i={};i[t.index]=!0,this.cacheData={str:e,resultCaches:t,resultIndexMap:i}}},{key:"clearCache",value:function(){this.cacheData=null}}]),e}(),Z=i("2909"),J=function(){function e(t,i){Object(v["a"])(this,e),this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){H.defineProperties(this,e,["renderSelectedBg","cursor","multiCursorPos"]),H.defineProperties(this,t,["htmls","selectedRanges"]),this.setContextData=function(e,i){t.setData(e,i)}}},{key:"select",value:function(e,t){var i=this;this.multiCursorPos.map((function(n){var s=i.checkCursorSelected(n);if(s)i.cursor.moveCursor(n,e,t),H.comparePos(n,s.start)<0||H.comparePos(n,s.end)<=0&&"right"===e?(s.start.line=n.line,s.start.column=n.column):(s.end.line=n.line,s.end.column=n.column);else{var r=Object.assign({},n);n=i.cursor.moveCursor(n,e,t),i.addSelectedRange(r,n)}})),this.filterSelectedRanges(),this.renderSelectedBg()}},{key:"addSelectedRange",value:function(e,t){var i=H.comparePos(e,t);if(i>0){var n=e;e=t,t=n}else if(!i)return;this.selectedRanges.push({start:Object.assign({},e),end:Object.assign({},t)})}},{key:"setSelectedRange",value:function(e,t){var i=H.comparePos(e,t);if(i>0){var n=e;e=t,t=n}else if(!i)return;this.clearRange(),this.selectedRanges.empty(),this.selectedRanges.push({start:e,end:t})}},{key:"checkCursorSelected",value:function(e){for(var t=0;t<this.selectedRanges.length;t++){var i=this.selectedRanges[t];if(H.comparePos(e,i.start)>=0&&H.comparePos(e,i.end)<=0)return i}return!1}},{key:"checkSelectedActive",value:function(e){var t=this.cursor.multiCursorPosLineMap.get(e.start.line)||[],i=e.start,n=e.end;if(n.line>i.line){for(var s=0;s<t.length;s++){var r=t[s];if(0===H.comparePos(r,e.start))return r}t=this.cursor.multiCursorPosLineMap.get(e.end.line)||[];for(var o=0;o<t.length;o++){var a=t[o];if(0===H.comparePos(a,e.end))return a}}else for(var l=0;l<t.length;l++){var h=t[l];if(0===H.comparePos(h,e.start)||0===H.comparePos(h,e.end))return h}return!1}},{key:"clearRange",value:function(e){if(e){e.line&&e.column&&(e=this.checkCursorSelected(e));var t=this.selectedRanges.filter((function(t){return!(H.comparePos(t.start,e.start)>=0&&H.comparePos(t.end,e.end)<=0)}));this.setContextData("selectedRanges",t)}else this.selectedRanges.empty()}},{key:"filterSelectedRanges",value:function(){var e,t=this.checkCursorSelected(this.selectedRanges[0].start),i=new Map,n=this.selectedRanges[0];t=t?"left":"right";for(var s=1;s<this.selectedRanges.length;s++){var r=this.selectedRanges[s];H.comparePos(n.end,r)>=0?(n.end=r.end,r.del=!0,"left"===t?i.set(r.start.line+","+r.start.column,!0):i.set(r.end.line+","+r.end.column,!0)):n=r}var o=this.selectedRanges.slice();if(this.selectedRanges.empty(),(e=this.selectedRanges.empty()).push.apply(e,Object(Z["a"])(o.filter((function(e){return!e.del&&H.comparePos(e.start,e.end)<0})))),i.size){var a,l=this.multiCursorPos.slice();(a=this.multiCursorPos.empty()).push.apply(a,Object(Z["a"])(l.filter((function(e){return!i.has(e.line+","+e.column)}))))}}}]),e}(),q=i("b85c"),Q={word:/[a-zA-Z0-9_]/,dWord:H.fullAngleReg,space:/\s/},ee=function(){function e(t,i){Object(v["a"])(this,e),this.initProperties(t,i),this.multiCursorPosLineMap=new Map}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){H.defineProperties(this,e,["nowCursorPos","multiCursorPos","setCursorRealPos","setNowCursorPos","getColumnByWidth","getStrWidth"]),H.defineProperties(this,t,["htmls","selectedRanges"])}},{key:"clearCursorPos",value:function(e){if(e){var t=this.multiCursorPos.indexOf(e);t>-1&&(this.multiCursorPosLineMap.delete(e.line),this.multiCursorPos.splice(t,1),e.del=!0)}else this.multiCursorPos.map((function(e){e.del=!0})),this.multiCursorPos.empty(),this.multiCursorPosLineMap.clear(),this.setNowCursorPos(null)}},{key:"hasCursorPos",value:function(e){var t=this.multiCursorPosLineMap.get(e.line)||[];return t.indexOf(e)>-1}},{key:"updateCursorPos",value:function(e,t,i,n){if(this.hasCursorPos(e)){var s=e.line,r=null;n&&this.updateAfterPos(e,t,i),e.line=t,e.column=i,e.line!==s&&this.setCursorPosLineMap();var o=this.multiCursorPosLineMap.get(e.line)||[],a=o.indexOf(e);this.setCursorRealPos(e),o[a-1]&&0===H.comparePos(o[a-1],e)?(r=o[a-1],o.splice(a-1,1)):o[a+1]&&0===H.comparePos(o[a+1],e)&&(r=o[a+1],o.splice(a+1,1)),r&&(a=this.multiCursorPos.indexOf(r),this.multiCursorPos.splice(a,1))}}},{key:"updateAfterPos",value:function(e,t,i){function n(n){n!=e&&(n.line>e.line?n.line+=t-e.line:n.line===e.line&&n.column>e.column&&(n.line+=t-e.line,n.column+=i-e.column))}this.multiCursorPos.map((function(e){n(e)})),this.selectedRanges.map((function(e){n(e.start),n(e.end)})),e.line!=t&&this.setCursorPosLineMap()}},{key:"addCursorPos",value:function(e){var t,i=this.multiCursorPosLineMap.get(e.line)||[],n=Object(q["a"])(i);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(0===H.comparePos(e,s))return this.setNowCursorPos(s),s}}catch(r){n.e(r)}finally{n.f()}return e={line:e.line,column:e.column},this.multiCursorPos.push(e),this.multiCursorPos.sort((function(e,t){return e.line==t.line?e.column-t.column:e.line-t.line})),this.setCursorPosLineMap(),this.setNowCursorPos(e),this.setCursorRealPos(e),e}},{key:"setCursorPos",value:function(e){if(e={line:e.line,column:e.column},1==this.multiCursorPos.length){var t=this.multiCursorPos[0];if(0===H.comparePos(t,e))return}this.multiCursorPos.empty(),this.multiCursorPos.push(e),this.setCursorPosLineMap(),this.setNowCursorPos(e),this.setCursorRealPos(e)}},{key:"setCursorPosLineMap",value:function(){var e=this;this.multiCursorPosLineMap=new Map,this.multiCursorPos.map((function(t){e.multiCursorPosLineMap.has(t.line)||e.multiCursorPosLineMap.set(t.line,[]),e.multiCursorPosLineMap.get(t.line).push(t)}))}},{key:"moveCursor",value:function(e,t,i){var n=this.htmls[e.line-1].text,s=e.line,r=e.column;if("up"===t){if(s>1){var o=this.getStrWidth(n,0,r);s--,n=this.htmls[s-1].text,r=this.getColumnByWidth(n,o)}}else if("down"===t){if(s<this.htmls.length){var a=this.getStrWidth(n,0,r);s++,n=this.htmls[s-1].text,r=this.getColumnByWidth(n,a)}}else if("left"===t){while(0===r&&s>1)s--,n=this.htmls[s-1].text,r=n.length;if(0===r)return this.updateCursorPos(e,s,r),{line:s,column:r};if(i){var l=null;while(r&&n[r-1].match(Q.space))r--;if(0==r)return this.updateCursorPos(e,s,r),{line:s,column:r};if(n[r-1].match(Q.word)?l=Q.word:n[r-1].match(Q.dWord)&&(l=Q.dWord),l)while(r&&n[r-1].match(l))r--;else while(r&&!n[r-1].match(Q.space)&&!n[r-1].match(Q.word)&&!n[r-1].match(Q.dWord))r--}else e.line===s&&r--}else{while(r===n.length&&s<this.htmls.length)s++,r=0,n=this.htmls[s-1].text;if(r==n.length)return this.updateCursorPos(e,s,r),{line:s,column:r};if(i){var h=null;while(r<n.length&&n[r].match(Q.space))r++;if(r==n.length)return this.updateCursorPos(e,s,r),{line:s,column:r};if(n[r].match(Q.word)?h=Q.word:n[r].match(Q.dWord)&&(h=Q.dWord),h)while(r<n.length&&n[r].match(h))r++;else while(r<n.length&&!n[r].match(Q.space)&&!n[r].match(Q.word)&&!n[r].match(Q.dWord))r++}else e.line===s&&r++}return this.updateCursorPos(e,s,r),{line:s,column:r}}}]),e}(),te=function(){function e(t,i){Object(v["a"])(this,e),this.history=[],this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){H.defineProperties(this,e,["cursor"]),H.defineProperties(this,t,["insertContent","deleteContent","moveLineUp","moveLineDown","copyLineUp","copyLineDown","deleteLineUp","deleteLineDown"])}},{key:"undo",value:function(){if(this.history.index>0){var e=this.history[this.history.index-1];this.doCommand(e),this.history.index--}}},{key:"redo",value:function(){if(this.history.index<this.history.length){var e=this.history[this.history.index];this.history.index++,this.doCommand(e)}}},{key:"doCommand",value:function(e){var t=e.type||(e instanceof Array?e[0].type:e.type);switch(this.cursor.clearCursorPos(),t){case H.command.DELETE:if(e instanceof Array){var i=e.map((function(e){return{start:e.preCursorPos,end:e.cursorPos}}));this.deleteContent(H.keyCode.BACKSPACE,i,!0)}else this.deleteContent(H.keyCode.BACKSPACE,{start:e.preCursorPos,end:e.cursorPos},!0);break;case H.command.INSERT:if(e instanceof Array){var n=[],s=[];e.slice().reverse().map((function(e){n.push(e.text),s.push(e.cursorPos)})),this.insertContent(n,s,{keyCode:e[0].keyCode})}else this.insertContent(e.text,Object.assign({},e.cursorPos),{keyCode:e.keyCode});break;case H.command.MOVEUP:this.moveLineUp(e.cursorPos,!0);break;case H.command.MOVEDOWN:this.moveLineDown(e.cursorPos,!0);break;case H.command.COPY_DOWN:this.copyLineDown(e.cursorPos,!0);break;case H.command.DELETE_DOWN:this.deleteLineDown(e.cursorPos,!0);break;case H.command.COPY_UP:this.copyLineUp(e.cursorPos,!0);break;case H.command.DELETE_UP:this.deleteLineUp(e.cursorPos,!0);break}}},{key:"pushHistory",value:function(e){while(this.history.length>this.history.index)this.history.pop();var t=this,i=this.history[this.history.index-1];if(e=this.sortComand(e),i instanceof Array&&e instanceof Array&&i.length===e.length&&Date.now()-this.pushHistoryTime<2e3)if(s(i)&&s(e)&&r(i[0],e[0]))for(var n=0;n<i.length;n++)o(i[n],e[n]);else this.history.push(e);else r(i,e)?o(i,e):this.history.push(e);function s(e){for(var t=1;t<e.length;t++)if(e[t].type!==e[t-1].type)return!1;return!0}function r(e,i){if(e&&e.type==i.type&&(e.type==H.command.DELETE||e.type===H.command.INSERT)&&i.preCursorPos.line==i.cursorPos.line&&0==H.comparePos(e.cursorPos,i.preCursorPos)&&Date.now()-t.pushHistoryTime<2e3)return!0}function o(e,t){e.type===H.command.DELETE?(e.cursorPos.line+=t.cursorPos.line-t.preCursorPos.line,e.cursorPos.column+=t.cursorPos.column-t.preCursorPos.column):(e.cursorPos=t.cursorPos,t.keyCode===H.keyCode.DELETE?e.text=e.text+t.text:e.text=t.text+e.text)}this.history.index=this.history.length,this.pushHistoryTime=Date.now()}},{key:"updateHistory",value:function(e){var t=this,i=this.history.index;e instanceof Array?e.map((function(e,n){e.keyCode=t.history[i-1][n].keyCode})):e.keyCode=this.history[i-1].keyCode,this.history[i-1]=this.sortComand(e)}},{key:"sortComand",value:function(e){return e instanceof Array&&e.sort((function(e,t){return e=e.cursorPos,t=t.cursorPos,e.line===t.line?e.column-t.column:e.line-t.line})),e}}]),e}(),ie=(i("e6e1"),{word:/[a-zA-Z0-9_]/,dWord:H.fullAngleReg,space:/\s/}),ne=function(){function e(t){Object(v["a"])(this,e),this.lineId=Number.MIN_SAFE_INTEGER,this.htmls=[],this.folds=[],this.selectedRanges=[],this.lineIdMap=new Map,this.renderedIdMap=new Map,this.renderedLineMap=new Map,this.foldMap=new Map,this.initProperties(t)}return Object(k["a"])(e,[{key:"initProperties",value:function(e){H.defineProperties(this,e,["nowCursorPos","multiCursorPos","maxLine","maxWidthObj","cursor","history","tokenizer","lint","folder","selecter","render","unFold","renderSelectedBg","setMaxWidth","setLineWidth","setNowCursorPos","setCursorRealPos","getStrWidth"]),this.setEditorData=function(t,i){e.setData(t,i)}}},{key:"setData",value:function(e,t){"function"!==typeof this[e]&&(this[e]=t)}},{key:"insertContent",value:function(e,t,i){var n=this,s=[];if(!t)for(var r=0;r<this.selectedRanges.length;r++){var o=this.selectedRanges[r];if(this.selecter.checkSelectedActive(o)){this.deleteContent();break}}if(t)if(e instanceof Array)e.map((function(r,o){var a=n.cursor.addCursorPos(t[o]),l=n._insertContent(e[o],a);s.push(l),i&&i.keyCode===H.keyCode.DELETE&&n.cursor.updateCursorPos(a,t[o].line,t[o].column)}));else{var a=this.cursor.addCursorPos(t);s=this._insertContent(e,a),i&&i.keyCode===H.keyCode.DELETE&&this.cursor.updateCursorPos(a,t.line,t.column)}else if(this.multiCursorPos.length>1){var l=e instanceof Array?e:e.split(/\r\n|\n/),h=this.multiCursorPos.slice().reverse();l.length===this.multiCursorPos.length?h.map((function(e,t){var i=n._insertContent(l[t],e);s.push(i)})):h.map((function(t){var i=n._insertContent(e,t);s.push(i)}))}else s=this._insertContent(e,this.multiCursorPos[0]);this.selecter.clearRange(),this.renderSelectedBg(),i?this.history.updateHistory(s):this.history.pushHistory(s)}},{key:"_insertContent",value:function(e,t){var i=this,n=this.htmls[t.line-1].text,s={line:t.line,column:t.column},r=t.column,o=t.line,a=o,l=r;this.tokenizer.onInsertContentBefore(o),this.lint.onInsertContentBefore(o),this.folder.onInsertContentBefore(Object.assign({},s)),e=e.split(/\r\n|\n/),e=e.map((function(e){return e={lineId:i.lineId++,text:e,html:"",width:0,tokens:null,folds:null,states:null},i.lineIdMap.set(e.lineId,e),e})),e.length>1?(l=e[e.length-1].text.length,e[0].text=n.slice(0,r)+e[0].text,e[e.length-1].text=e[e.length-1].text+n.slice(r),this.htmls=this.htmls.slice(0,t.line-1).concat(e).concat(this.htmls.slice(t.line))):(l+=e[0].text.length,e[0].text=n.slice(0,r)+e[0].text+n.slice(t.column),this.htmls.splice(t.line-1,1,e[0])),a+=e.length-1,this.setEditorData("maxLine",this.htmls.length),this.folder.onInsertContentAfter({line:a,column:l}),this.lint.onInsertContentAfter(a),this.render(),this.tokenizer.onInsertContentAfter(a),this.setLineWidth(e),this.foldMap.has(o)&&e.length>1&&this.unFold(o),this.cursor.updateCursorPos(t,a,l,!0);var h={type:H.command.DELETE,cursorPos:{line:a,column:l},preCursorPos:{line:o,column:r}};return h}},{key:"deleteContent",value:function(e,t,i){var n=this,s=[],r=null;t?(t=t instanceof Array?t:[t],t.map((function(t){n.selecter.addSelectedRange(t.start,t.end),r=n.cursor.addCursorPos(t.end);var i=n._deleteContent(r,e);i.text&&s.push(i)}))):this.multiCursorPos.map((function(t){var i=n._deleteContent(t,e);i.text&&s.push(i)})),this.setNowCursorPos(this.multiCursorPos[0]),this.selecter.clearRange(),this.renderSelectedBg(),s=s.length>1?s:s[0],i?this.history.updateHistory(s):s&&this.history.pushHistory(s)}},{key:"_deleteContent",value:function(e,t){var i=this,n=null;e.start&&e.end?(n=e,e=n.end):n=this.selecter.checkCursorSelected(e);var s=null,r=this.htmls[e.line-1],o=r.text,a="",l=[],h={line:e.line,column:e.column},u=e.line,c=e.column;if(this.tokenizer.onDeleteContentBefore(e.line),this.lint.onDeleteContentBefore(e.line),this.folder.onDeleteContentBefore(Object.assign({},e)),n){var p=n.end,d=this.htmls[p.line-1];s=n.start,r=this.htmls[s.line-1],h={line:p.line,column:p.column},o=r.text,a=this.getRangeText(n.start,n.end),1==s.line&&p.line==this.maxLine?(l=[this.maxWidthObj.lineId],this.lineIdMap.clear()):l=this.htmls.slice(s.line-1,p.line).map((function(e){return i.lineIdMap.delete(e.lineId),e.lineId})),this.lineIdMap.set(r.lineId,r),s.line==p.line?(o=o.slice(0,s.column)+o.slice(p.column),r.text=o):(o=o.slice(0,s.column),r.text=o,o=d.text,o=o.slice(p.column),r.text+=o,this.htmls.splice(s.line,p.line-s.line)),u=s.line,c=s.column,this.selecter.clearRange(n)}else if(H.keyCode.DELETE==t)e.column==o.length?e.line<this.htmls.length&&(this.lineIdMap.delete(this.htmls[e.line].lineId),o=r.text+this.htmls[e.line].text,this.htmls.splice(e.line,1),a="\n",this.multiCursorPos.map((function(t){t.line>e.line&&(t.line===e.line+1&&(t.command+=e.column),t.line--)}))):(a=o[e.column],o=o.slice(0,e.column)+o.slice(e.column+1),this.multiCursorPos.map((function(t){t.line===e.line&&t.column>e.column&&t.column--}))),r.text=o;else{if(0==e.column){if(e.line>1){var f=this.htmls[e.line-2].text.length;this.lineIdMap.delete(this.htmls[e.line-2].lineId),o=this.htmls[e.line-2].text+o,this.htmls.splice(e.line-2,1),a="\n",u=e.line-1,c=f}}else a=o[e.column-1],o=o.slice(0,e.column-1)+o.slice(e.column),c=e.column-1;r.text=o}r.width=this.getStrWidth(r.text),r.tokens=null,r.folds=null,r.states=null,this.setEditorData("maxLine",this.htmls.length),this.folder.onDeleteContentAfter({line:u,column:c}),this.lint.onDeleteContentAfter(u),this.render(),this.tokenizer.onDeleteContentAfter(u),this.cursor.updateCursorPos(e,u,c,!0),r.width>=this.maxWidthObj.width?this.setEditorData("maxWidthObj",{lineId:r.lineId,text:r.text,width:r.width}):l.indexOf(this.maxWidthObj.lineId)>-1&&this.setMaxWidth();var m={type:H.command.INSERT,cursorPos:{line:e.line,column:e.column},preCursorPos:{line:h.line,column:h.column},keyCode:t,text:a};return m}},{key:"moveLineUp",value:function(e,t){var i=this,n=this,s=[],r=[],o=null;e?s=e instanceof Array?e:[e]:n.multiCursorPos.map((function(e){(!o||e.line-o.line>1)&&(e.line>1&&s.push(e),o=e)})),s.map((function(e){e=i.cursor.addCursorPos(e),l(e),r.push({line:e.line,column:e.column})}));var a={type:H.command.MOVEDOWN,cursorPos:r};function l(e){var t=n.htmls[e.line-2].text,i=n.htmls[e.line-1].text,s={line:e.line-1,column:0};n._deleteContent({start:s,end:{line:e.line,column:i.length}}),n._insertContent(i+"\n"+t,s),n.cursor.updateCursorPos(e,e.line-1,e.column)}t?this.history.updateHistory(a):this.history.pushHistory(a)}},{key:"moveLineDown",value:function(e,t){var i=this,n=this,s=[],r=[],o=null;e?s=e instanceof Array?e:[e]:n.multiCursorPos.map((function(e){(!o||e.line-o.line>1)&&(e.line>1&&s.push(e),o=e)})),s.map((function(e){e=i.cursor.addCursorPos(e),l(e),r.push({line:e.line,column:e.column})}));var a={type:H.command.MOVEUP,cursorPos:r};function l(e){var t=n.htmls[e.line].text,i=n.htmls[e.line-1].text,s={line:e.line,column:0};n._deleteContent({start:s,end:{line:e.line+1,column:t.length}}),n._insertContent(t+"\n"+i,s),n.cursor.updateCursorPos(e,e.line+1,e.column)}t?this.history.updateHistory(a):this.history.pushHistory(a)}},{key:"copyLine",value:function(e,t,i){var n=this,s={},r=[],o=[];i=i||"up",e?r=e instanceof Array?e:[e]:this.multiCursorPos.map((function(e){s[e.line]||r.push(e)})),r.slice().reverse().map((function(e){var t=n.htmls[e.line-1].text;e=n.cursor.addCursorPos(e),o.push(e),n._insertContent("\n"+t,{line:e.line,column:t.length}),n.cursor.updateAfterPos({line:e.line+("up"===i?1:0),column:0},e.line+("up"===i?2:1),0)})),o=o.map((function(e){return{line:e.line,column:e.column}})).reverse(),this.setCursorRealPos(),this.renderSelectedBg();var a={type:"up"===i?H.command.DELETE_DOWN:H.command.DELETE_UP,cursorPos:o};t?this.history.updateHistory(a):this.history.pushHistory(a)}},{key:"copyLineUp",value:function(e,t){this.copyLine(e,t,"up")}},{key:"copyLineDown",value:function(e,t){this.copyLine(e,t,"down")}},{key:"deleteLine",value:function(e,t,i){var n=this,s={},r=[],o=[];i=i||"down",e?r=e instanceof Array?e:[e]:this.multiCursorPos.reverse().slice().map((function(e){s[e.line]||r.push(e)})),r.slice().reverse().map((function(e){var t=n.htmls[e.line-("down"===i?1:2)].text,s=n.htmls[e.line-("down"===i?0:1)].text;e=n.cursor.addCursorPos(e),o.push(e),n._deleteContent({start:{line:e.line+("down"===i?0:-1),column:t.length},end:{line:e.line+("down"===i?1:0),column:s.length}}),n.cursor.updateAfterPos({line:e.line+("down"===i?1:0),column:0},e.line+("down"===i?0:-1),0)})),o=o.map((function(e){return{line:e.line,column:e.column}})).reverse(),this.setCursorRealPos(),this.renderSelectedBg();var a={type:"down"===i?H.command.COPY_UP:H.command.COPY_DOWN,cursorPos:o};t?this.history.updateHistory(a):this.history.pushHistory(a)}},{key:"deleteLineUp",value:function(e,t){this.deleteLine(e,t,"up")}},{key:"deleteLineDown",value:function(e,t){this.deleteLine(e,t,"down")}},{key:"getRangeText",value:function(e,t){var i=this.htmls[e.line-1].text;if(e.line!=t.line){var n=[];i=i.slice(e.column),n=this.htmls.slice(e.line,t.line-1),n=n.map((function(e){return e.text})),i+=n.length?"\n"+n.join("\n"):"",i+="\n"+this.htmls[t.line-1].text.slice(0,t.column)}else i=i.slice(e.column,t.column);return i}},{key:"getCopyText",value:function(e){var t=this,i="";return this.multiCursorPos.map((function(n){var s="",r=t.selecter.checkCursorSelected(n);r?(s=t.getRangeText(r.start,r.end),e&&t.deleteContent()):(s=t.htmls[n.line-1].text,e&&(s&&t.selecter.addSelectedRange({line:n.line,column:0},{line:n.line,column:s.length}),s&&t.deleteContent())),i+="\n"+s})),i.slice(1)}},{key:"getToSearchObj",value:function(){if(this.getToSearchObj.searchObj)return this.getToSearchObj.searchObj;var e=this.selecter.checkCursorSelected(this.nowCursorPos),t=!1,i="";if(e)i=this.getRangeText(e.start,e.end);else{var n=this.htmls[this.nowCursorPos.line-1].text,s="",r=this.nowCursorPos.column,o=ie.word;r&&n[r-1].match(ie.dWord)&&(o=ie.dWord);while(r>0&&n[r-1].match(o))s=n[r-1]+s,r--;r=this.nowCursorPos.column;while(r<n.length&&n[r].match(o))s+=n[r],r++;t=!0,i=s}return this.getToSearchObj.searchObj={text:i,wholeWord:t},this.getToSearchObj.searchObj}}]),e}(),se=function(){function e(t,i){Object(v["a"])(this,e),this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){H.defineProperties(this,e,["multiCursorPos","cursor","selecter","history","search","renderSelectedBg"]),H.defineProperties(this,t,["htmls","insertContent","deleteContent","moveLineUp","moveLineDown","copyLineUp","copyLineDown"]),this.setEditorData=function(t,i){e.setData(t,i)}}},{key:"onKeyDown",value:function(e){var t=this;if(e.ctrlKey&&e.shiftKey){switch(e.preventDefault(),e.keyCode){case 37:this.selecter.select("left",!0);break;case 38:this.moveLineUp();break;case 39:this.selecter.select("right",!0);break;case 40:this.moveLineDown();break;case 68:this.copyLineUp();break}return!1}if(e.altKey&&e.shiftKey)switch(e.preventDefault(),e.keyCode){case 40:this.copyLineDown();break}else if(e.ctrlKey)switch(e.keyCode){case 37:n("left",!0),this.selecter.clearRange(),this.renderSelectedBg();break;case 39:n("right",!0),this.selecter.clearRange(),this.renderSelectedBg();break;case 65:e.preventDefault();var i={line:this.htmls.length,column:this.htmls.peek().text.length};this.selecter.setSelectedRange({line:1,column:0},i),this.setEditorData("forceCursorView",!1),this.cursor.setCursorPos(i),this.renderSelectedBg();break;case 68:e.preventDefault(),this.search();break;case 90:case 122:e.preventDefault(),this.history.undo();break;case 89:case 121:e.preventDefault(),this.history.redo();break}else if(e.shiftKey)switch(e.keyCode){case 37:this.selecter.select("left");break;case 38:this.selecter.select("up");break;case 39:this.selecter.select("right");break;case 40:this.selecter.select("down");break}else switch(e.keyCode){case 9:e.preventDefault(),this.insertContent("\t");break;case 37:n("left"),this.selecter.clearRange(),this.renderSelectedBg();break;case 38:n("up"),this.selecter.clearRange(),this.renderSelectedBg();break;case 39:n("right"),this.selecter.clearRange(),this.renderSelectedBg();break;case 40:n("down"),this.selecter.clearRange(),this.renderSelectedBg();break;case H.keyCode.DELETE:this.deleteContent(H.keyCode.DELETE);break;case H.keyCode.BACKSPACE:this.deleteContent(H.keyCode.BACKSPACE);break}function n(e,i){t.selecter.checkCursorSelected(t.nowCursorPos)||t.multiCursorPos.map((function(n){t.cursor.moveCursor(n,e,i)}))}}}]),e}(),re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-editor-status-bar",style:{height:e.height+"px"},on:{contextmenu:function(e){e.stopPropagation(),e.preventDefault()}}},[i("div",{staticClass:"my-editor-status-left"},[i("div",{staticClass:"my-editor-status-item"},[i("span",[e._v("Line "+e._s(e.line)+", Column "+e._s(e.column))])])]),i("div",{staticClass:"my-editor-status-right"},[i("div",{staticClass:"my-editor-status-item clickable",on:{mousedown:function(t){return t.stopPropagation(),e.showTabsize.apply(null,arguments)}}},[i("span",[e._v("Tab Size:"+e._s(e._tabSize))]),i("panel",{directives:[{name:"show",rawName:"v-show",value:e.tabsizeVisible,expression:"tabsizeVisible"}],attrs:{menuList:e.tabSizeList,styles:{right:0,bottom:e.height+"px"}},on:{change:e.onTabsizeChange}})],1),i("div",{staticClass:"my-editor-status-item clickable",on:{mousedown:function(t){return t.stopPropagation(),e.showLanguage.apply(null,arguments)}}},[i("span",[e._v(e._s(e._language))]),i("panel",{directives:[{name:"show",rawName:"v-show",value:e.languageVisible,expression:"languageVisible"}],attrs:{menuList:e.languageList,styles:{right:0,bottom:e.height+"px"}},on:{change:e.onLnaguageChange}})],1)])])},oe=[],ae=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-editor-panel",style:e.styles,on:{mousedown:function(e){e.stopPropagation()}}},e._l(e.menuList,(function(t){return i("div",{staticClass:"my-editor-menu-group"},e._l(t,(function(n){return i("div",{staticClass:"my-editor-menu-item",class:{checked:e.checkable&&n.checked,disabled:n.disabled},on:{mousedown:function(i){return e.onClick(n,t)}}},[i("div",{staticClass:"my-editor-menu-content"},[e._v(e._s(n.name))]),n.shortcut?i("div",{staticClass:"my-editor-menu-shortcut"},[e._v(e._s(n.shortcut))]):e._e()])})),0)})),0)},le=[],he={name:"Panel",props:{menuList:{type:Array,default:[]},styles:{type:Object},checkable:{type:Boolean,default:!0}},data:function(){return{}},created:function(){},methods:{onClick:function(e,t){e.disabled||(t.map((function(e){e.checked=!1})),e.checked=!0,this.$emit("change",e))}}},ue=he,ce=Object(l["a"])(ue,ae,le,!1,null,null,null),pe=ce.exports,de={name:"StatusBar",props:{height:{type:Number,default:25},line:{type:Number,default:1},column:{type:Number,default:1},language:{type:String,default:"JavaScript"},tabSize:{type:Number,default:4}},components:{Panel:pe},data:function(){return{_tabSize:0,_language:"",tabsizeVisible:!1,languageVisible:!1,tabSizeList:[[]],languageList:[[{name:"JavaScript"},{name:"HTML"},{name:"CSS"}]]}},created:function(){for(var e=1;e<=8;e++)this.tabSizeList[0].push({name:"Tab Width：".concat(e),size:e});this._tabSize=this.tabSize,this._language=this.language,this.setDefault()},methods:{setDefault:function(){var e=this;this.tabSizeList[0].map((function(t){t.checked=t.size==e._tabSize})),this.languageList[0].map((function(t){t.checked=t.name==e._language}))},showTabsize:function(){var e=this.tabsizeVisible;this.closeAllPanel(),this.tabsizeVisible=!e},showLanguage:function(){var e=this.languageVisible;this.closeAllPanel(),this.languageVisible=!e},closeAllPanel:function(){this.languageVisible=!1,this.tabsizeVisible=!1},onTabsizeChange:function(e){this._tabSize!=e.size&&(this._tabSize=e.size,this.$emit("update:tabSize",e.size)),this.tabsizeVisible=!1},onLnaguageChange:function(e){this._language!=e.name&&(this._language=e.name,this.$emit("update:language",e.name)),this.languageVisible=!1}}},fe=de,me=Object(l["a"])(fe,re,oe,!1,null,null,null),ve=me.exports,ke=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-editor-tip",style:e.styles,on:{mousedown:function(e){e.stopPropagation()}}},[i("div",{domProps:{innerHTML:e._s(e.content)}})])},ge=[],xe={name:"Tip",props:{content:String,styles:{type:Object}},data:function(){return{}},created:function(){},methods:{}},ye=xe,be=Object(l["a"])(ye,ke,ge,!1,null,null,null),Ce=be.exports,we=null,Te={name:"Home",components:{StatusBar:ve,Panel:pe,Tip:Ce},data:function(){return Object(f["a"])({charObj:{charWidth:7.15,fullAngleCharWidth:15,charHight:19},nowCursorPos:{line:1,column:0,top:0,left:0},multiCursorPos:[],cursorVisible:!0,cursorFocus:!0,language:"HTML",statusHeight:23,tabSize:4,renderHtmls:[],startLine:1,startToEndToken:null,top:0,scrollLeft:0,scrollTop:0,maxVisibleLines:1,maxLine:1,scrollerHeight:"auto",scrollerArea:{},maxWidthObj:{lineId:null,text:"",width:0},menuList:[[{name:"Cut",op:"cut",shortcut:"Ctrl+X"},{name:"Copy",op:"copy",shortcut:"Ctrl+C"},{name:"Paste",op:"paste",shortcut:"Ctrl+V"}]],menuStyle:{top:"0px",left:"0px","min-width":"200px"},tipStyle:{top:"0px",left:"0px"},errorMap:{},menuVisble:!1,tipContent:!1},"tipContent","")},computed:{_numTop:function(){return this.top-this.charObj.charHight+"px"},_leftShadow:function(){return this.scrollLeft?"17px 0 16px -16px rgba(0, 0, 0, 0.8) inset":"none"},_top:function(){return this.top+"px"},_lineHeight:function(){return this.charObj.charHight+"px"},_statusHeight:function(){return this.statusHeight+4+"px"},_cursorVisible:function(){return this.cursorVisible&&this.cursorFocus?"visible":"hidden"},_hScrollWidth:function(){return this._contentMinWidth},_contentMinWidth:function(){var e=0;return this.$content&&(e=H.getStrExactWidth(this.maxWidthObj.text,this.tabSize,this.$content),e+=this.charObj.fullAngleCharWidth),e=this.scrollerArea.width>e?this.scrollerArea.width:e,e+"px"},_textAreaPos:function(){var e=0,t=this.top;if(this.multiCursorPos.length){var i=this.multiCursorPos.slice().sort((function(e,t){return e.top-t.top}))[0];e=H.getNum(i.left),t=H.getNum(i.top)+this.top,e-=this.scrollLeft,e=e<this.charObj.charWidth?this.charObj.charWidth:e,e=e>this.scrollerArea.width-this.charObj.charWidth?this.scrollerArea.width-this.charObj.charWidth:e,t+=this.charObj.charHight,t>this.scrollerArea.height-2*this.charObj.charHight&&(t=this.scrollerArea.height-2*this.charObj.charHight)}return{top:t+"px",left:e+"px"}},_tabLineLeft:function(){var e=this;return function(t){return(t-1)*e.tabSize*e.charObj.charWidth+"px"}},_activeLine:function(){var e=this;return function(t){return 1===e.multiCursorPos.length&&e.nowCursorPos.line==t}},space:function(){return H.space(this.tabSize)}},watch:{language:function(e){we.htmls.map((function(e){e.tokens=null,e.folds=null,e.states=null,e.html=""})),this.render(),this.tokenizer.initLanguage(e),this.tokenizer.tokenizeVisibleLins(),this.tokenizer.tokenizeLines(1),this.lint.initLanguage(e)},tabSize:function(e){this.render(),this.maxWidthObj={lineId:null,text:"",width:0},this.setLineWidth(we.htmls)},maxLine:function(e){this.setScrollerHeight()}},created:function(){window.editor=this,window.context=we,this.initData(),this.initEvent()},mounted:function(){this.$editor=this.$refs.editor,this.$scroller=this.$refs.scroller,this.$content=this.$refs.content,this.$textarea=this.$refs.textarea,this.$vScroller=this.$refs.vScroller,this.$hScroller=this.$refs.hScroller,this.charObj=H.getCharWidth(this.$content),this.maxVisibleLines=Math.ceil(this.$scroller.clientHeight/this.charObj.charHight)+1,this.render(),this.focus()},methods:{initData:function(){we=new ne(this),we.htmls.push({lineId:we.lineId++,text:"",html:"",width:0,tokens:[],folds:[],states:[]}),we.lineIdMap.set(we.htmls[0].lineId,we.htmls[0]),this.maxWidthObj.lineId=we.htmls[0].lineId,this.tokenizer=new z(this,we),this.lint=new Y(this,we),this.folder=new K(this,we),this.history=new te(this,we),this.searcher=new G(this,we),this.selecter=new J(this,we),this.shortcut=new se(this,we),this.cursor=new ee(this,we),this.cursor.addCursorPos(this.nowCursorPos)},initEvent:function(){var e=this;B()(document).on("mousemove",(function(t){e.onScrollerMmove(t)})),B()(document).on("mouseup",(function(t){e.onScrollerMup(t)}))},showCursor:function(){var e=this;if(this.cursorFocus=!0,this.multiCursorPos.length){if(!this.showCursor.show){this.showCursor.show=!0,this.cursorVisible=!0;var t=function t(){clearTimeout(e.curserTimer),e.curserTimer=setTimeout((function(){e.cursorVisible=!e.cursorVisible,t()}),500)};t()}}else this.showCursor.show=!1},hideCursor:function(){clearTimeout(this.curserTimer),this.showCursor.show=!1,this.cursorFocus=!1},focus:function(){var e=this;this.$textarea.focus(),setTimeout((function(){setTimeout((function(){e.$textarea.focus()}),100)}),100)},render:function(){var e=this;this.renderLine(),this.renderSelectedBg(),this.$nextTick((function(){e.scrollerArea={height:e.$scroller.clientHeight,width:e.$scroller.clientWidth}}))},renderLine:function(e){var t=this;if(e){if(we.renderedIdMap.has(e)){var i=we.lineIdMap.get(e),n=we.renderedIdMap.get(e);Object.assign(n,u(i,n.num))}}else{we.renderedIdMap.clear(),we.renderedLineMap.clear(),this.renderHtmls=[];for(var s=0,r=this.startLine;s<this.maxVisibleLines&&r<=we.htmls.length;s++){var o=we.htmls[r-1],a=o.lineId,l=u(o,r);if(this.renderHtmls.push(l),we.renderedIdMap.set(a,l),we.renderedLineMap.set(r,l),we.foldMap.has(r)){var h=we.foldMap.get(r);r=h.end.line}else r++}}function u(e,i){var n=!1,s=/^\s+/.exec(e.text),r=0,o="",a=[],l=[];s&&(r=/\t+/.exec(s[0]),r=r&&r[0].length||0,r+=Math.ceil((s[0].length-r)/t.tabSize)),we.foldMap.has(i)?o="close":t.folder.getRangeFold(i,!0)&&(o="open");var h=e.html||H.htmlTrans(e.text);return h=h.replace(/\t/g,t.space),{html:h,num:i,tabNum:r,selectStarts:a,selectEnds:l,selected:n,fold:o}}},renderSelectedBg:function(){var e=this;this.renderHtmls.length||requestAnimationFrame((function(){e.renderSelectedBg()})),this.renderHtmls.map((function(e){e.selected=!1,e.selectStarts=[],e.selectEnds=[]})),we.selectedRanges.length&&we.selectedRanges.map((function(t){e._renderSelectedBg(t)}))},_renderSelectedBg:function(e){var t=this.renderHtmls[0].num,i=this.renderHtmls.peek().num,n=e.start,s=e.end,r=we.htmls[n.line-1].text,o=!1;n.left=this.getStrWidth(r,0,n.column),n.line==s.line?n.width=this.getStrWidth(r,n.column,s.column):(n.width=this.getStrWidth(r,n.column),s.left=0,r=we.htmls[s.line-1].text,s.width=this.getStrWidth(r,0,s.column)),e.start=n,e.end=s,t=t>n.line+1?t:n.line+1,i=i<s.line-1?i:s.line-1;for(var a=t;a<=i;a++)we.renderedLineMap.get(a).selected=!0;we.renderedLineMap.has(n.line)&&(o=this.selecter.checkSelectedActive(e),we.renderedLineMap.get(n.line).selectStarts.push({left:n.left,width:n.width,active:o})),s.line>n.line&&we.renderedLineMap.has(s.line)&&we.renderedLineMap.get(s.line).selectEnds.push({left:s.left,width:s.width,active:o||this.selecter.checkSelectedActive(e)})},foldLine:function(e){var t=this,i=this.folder.foldLine(e);this.focus(),i&&(this.multiCursorPos.map((function(n){if(n.line>e&&n.line<i.end.line){var s=we.htmls[e-1];t.cursor.updateCursorPos(n,e,s.text.length)}})),this.forceCursorView=!1,this.setCursorRealPos(),this.setScrollerHeight(),this.render())},unFold:function(e){this.focus(),this.folder.unFold(e)&&(this.forceCursorView=!1,this.setCursorRealPos(),this.setScrollerHeight(),this.render())},search:function(){var e=this,t=we.getToSearchObj(),i=null,n=this.searcher.hasCache();t.text&&(i=this.searcher.search(t.text,t),i&&i.result&&(we.selectedRanges.length?this.cursor.addCursorPos(i.result.end):this.cursor.setCursorPos(i.result.end),n||i.list.map((function(t){e.selecter.addSelectedRange(t.start,t.end)})),this.renderSelectedBg()))},clearSearch:function(){this.searcher.clearCache(),we.getToSearchObj.searchObj=null},setData:function(e,t){"function"!==typeof this[e]&&(this[e]=t)},setNowCursorPos:function(e){this.nowCursorPos=e},setCursorRealPos:function(e){var t=this;function i(e){t.$nextTick((function(){!e.del&&n(e)}))}function n(e){var i=0,n=we.htmls[e.line-1];i=B()("#line_"+e.line).length&&n.tokens&&n.tokens.length?s(e):t.getStrWidthByLine(e.line,0,e.column);var r=(t.folder.getRelativeLine(e.line)-t.folder.getRelativeLine(t.startLine))*t.charObj.charHight,o=t.folder.getRelativeLine(e.line)*t.charObj.charHight;!1!==t.forceCursorView&&e===t.nowCursorPos&&(o>t.scrollTop+t.scrollerArea.height-t.charObj.charHight?t.$vScroller.scrollTop=o+t.charObj.charHight-t.scrollerArea.height:(r<0||0==r&&t.top<0)&&(t.$vScroller.scrollTop=(e.line-1)*t.charObj.charHight),i>t.scrollerArea.width+t.scrollLeft-t.charObj.fullAngleCharWidth?t.$hScroller.scrollLeft=i+t.charObj.fullAngleCharWidth-t.scrollerArea.width:i<t.scrollLeft&&(t.$hScroller.scrollLeft=i-1)),requestAnimationFrame((function(){t.forceCursorView=!0})),e.top=r+"px",e.left=i+"px",t.multiCursorPos.splice()}function s(e){for(var i=we.htmls[e.line-1],n=i.tokens[0],s=1;s<i.tokens.length;s++){if(!(i.tokens[s].column<e.column))break;n=i.tokens[s]}var r=B()("#line_"+e.line).children(".my-editor-code").children('span[data-column="'+n.column+'"]'),o=n.value.slice(0,e.column-n.column);return r[0].offsetLeft+t.getStrWidth(o)}e?i(e):this.multiCursorPos.map((function(e){i(e)})),this.cursorVisible=!0},setMaxWidth:function(){var e={line:we.htmls[0].lineId,width:0};we.htmls.map((function(t){t.width>e.width&&(e={lineId:t.lineId,text:t.text,width:t.width})})),this.maxWidthObj=e},setLineWidth:function(e){var t=0,i=this,n=Date.now();function s(){while(t<e.length){var r=e[t];if(we.lineIdMap.has(r.lineId)){var o=i.getStrWidth(r.text);r.width=o,o>i.maxWidthObj.width&&(i.maxWidthObj={lineId:r.lineId,text:r.text,width:o})}if(t++,Date.now()-n>20)break}t<e.length&&(i.setLineWidth.timer=setTimeout((function(){s()}),20))}clearTimeout(this.setLineWidth.timer),s()},setScrollerHeight:function(){var e=we.htmls.length;e=this.folder.getRelativeLine(e),this.scrollerHeight=e*this.charObj.charHight+"px"},setErrorMap:function(e){this.errorMap=e},getStrWidth:function(e,t,i){return H.getStrWidth(e,this.charObj.charWidth,this.charObj.fullAngleCharWidth,this.tabSize,t,i)},getStrWidthByLine:function(e,t,i){return this.getStrWidth(we.htmls[e-1].text,t,i)},getColumnByWidth:function(e,t){var i,n,s,r,o=0,a=e.length;while(o<a){if(i=Math.floor((o+a)/2),n=this.getStrWidth(e,0,i),s=e[i-1]&&this.getStrWidth(e[i-1])/2,r=e[i]&&this.getStrWidth(e[i])/2||s,n>=t&&n-t<s||t>=n&&t-n<r){o=i;break}n>t?a=i:o=i+1}return o},getPosByEvent:function(e){var t=this,i=B()(e.target);if(i.attr("data-line")||i.attr("data-column"))return h(e);var n=B()(this.$scroller),s=n.offset(),r=0,o=e.clientX<0?0:e.clientX,a=e.clientY<0?0:e.clientY,l=Math.ceil((a+this.scrollTop-s.top)/this.charObj.charHight)||1;return l=this.folder.getRealLine(l),l>we.htmls.length?(l=we.htmls.length,r=we.htmls[l-1].text.length):r=this.getColumnByWidth(we.htmls[l-1].text,o+this.scrollLeft-s.left),{line:l,column:r};function h(e){var i=B()(e.target),n=i.attr("data-line")-0,s=i.attr("data-column");n||(n=i.parent().attr("data-line")-0);var r=we.htmls[n-1];if(s){s-=0;for(var o=0;o<r.tokens.length;o++)if(r.tokens[o].column==s){s+=t.getColumnByWidth(r.tokens[o].value,e.offsetX);break}}else s=r.text.length;return{line:n,column:s}}},onContextmenu:function(e){var t=this,i=0,n=0,s=B()(this.$editor),r=s.offset();this.menuVisble=!0,this.$nextTick((function(){i=t.$refs.menu.$el.clientWidth,n=t.$refs.menu.$el.clientHeight,n+e.clientY>r.top+t.scrollerArea.height?t.menuStyle.top=e.clientY-r.top-n+"px":t.menuStyle.top=e.clientY-r.top+"px",i+e.clientX>r.left+s[0].clientWidth?t.menuStyle.left=e.clientX-r.left-i+"px":t.menuStyle.left=e.clientX-r.left+"px"}))},onClickMenu:function(e){switch(e.op){case"cut":case"copy":H.writeClipboard(we.getCopyText("cut"===e.op));break;case"paste":this.$textarea.focus(),H.readClipboard().then((function(e){we.insertContent(e)}));break}this.menuVisble=!1,this.focus()},onIconMouseOver:function(e,t){var i=B()(this.$editor),n=i.offset();this.tipStyle={left:t.clientX-n.left+10+"px",top:t.clientY-n.top+10+"px"},this.tipContent=this.errorMap[e]},onIconMouseLeave:function(){this.tipContent=""},onToggleFold:function(e){we.foldMap.has(e)?this.unFold(e):this.foldLine(e)},onClickEditor:function(){this.$refs.statusBar.closeAllPanel(),this.menuVisble=!1},onScrollerMdown:function(e){if(3!=e.which){var t=this.getPosByEvent(e);this.cursor.setCursorPos(t),this.focus(),this.mouseStartObj={time:Date.now(),start:t}}},onScrollerMmove:function(e){var t=this;if(this.mouseStartObj&&Date.now()-this.mouseStartObj.time>100){var i=B()(this.$scroller).offset(),n=this.getPosByEvent(e);this.selecter.setSelectedRange(Object.assign({},this.mouseStartObj.start),n),this.cursor.setCursorPos(n),this.renderSelectedBg(),cancelAnimationFrame(this.selectMoveTimer),e.clientY>i.top+this.scrollerArea.height?s("down",e.clientY-i.top-this.scrollerArea.height):e.clientY<i.top?s("up",i.top-e.clientY):e.clientX<i.left?s("left",i.left-e.clientX):e.clientX>i.left+this.scrollerArea.width&&s("right",e.clientX-i.left-this.scrollerArea.width)}function s(e,i){var n=t.nowCursorPos.line,s=t.nowCursorPos.column,r=0;function o(e,i){var a=n,l=s;switch(e){case"up":r+=i,a=Math.floor(r/t.charObj.charHight),a=n-a;break;case"down":r+=i,a=Math.floor(r/t.charObj.charHight),a=n+a;break;case"left":r+=i,l=Math.floor(r/t.charObj.charWidth),l=s-l;break;case"right":r+=i,l=Math.floor(r/t.charObj.charWidth),l=s+l;break}a=a<1?1:a>we.htmls.length?we.htmls.length:a,l=l<0?0:l>we.htmls[n-1].text.length?we.htmls[n-1].text.length:l,t.cursor.setCursorPos({line:a,column:l}),t.selecter.setSelectedRange(t.mouseStartObj.start,{line:a,column:l}),t.renderSelectedBg(),t.selectMoveTimer=requestAnimationFrame((function(){o(e,i)}))}o(e,i)}},onScrollerMup:function(e){var t=this.getPosByEvent(e);this.mouseStartObj&&Date.now()-this.mouseStartObj.time>100&&0!=H.comparePos(this.mouseStartObj.start,t)?(this.selecter.setSelectedRange(this.mouseStartObj.start,t),this.cursor.setCursorPos(t),this.renderSelectedBg()):3!=e.which&&(this.selecter.clearRange(),this.clearSearch(),this.renderSelectedBg(),this.mouseUpTime&&Date.now()-this.mouseUpTime<300&&this.search()),cancelAnimationFrame(this.selectMoveTimer),this.mouseStartObj=null,this.mouseUpTime=Date.now()},onHscroll:function(e){this.scrollLeft=e.target.scrollLeft,this.$scroller.scrollLeft=this.scrollLeft,this.forceCursorView=!1},onVscroll:function(e){var t=1;this.scrollTop=e.target.scrollTop,t=Math.floor(this.scrollTop/this.charObj.charHight),t++,this.startLine=this.folder.getRealLine(t),this.top=-this.scrollTop%this.charObj.charHight,this.forceCursorView=!1,this.tokenizer.onScroll(),this.render(),this.setCursorRealPos()},onWheel:function(e){this.$vScroller.scrollTop=this.scrollTop+e.deltaY,this.$hScroller.scrollLeft=this.scrollLeft+e.deltaX},onCompositionstart:function(){clearTimeout(this.compositionendTimer),this.compositionstart=!0},onCompositionend:function(){var e=this;if(this.compositionstart){var t=this.$textarea.value||"";t&&(we.insertContent(t),this.$textarea.value="")}this.compositionendTimer=setTimeout((function(){e.compositionstart=!1}),100)},onInput:function(){if(!this.compositionstart){var e=this.$textarea.value||"";e&&(we.insertContent(e),this.$textarea.value="")}},onCopy:function(e){var t=window.clipboardData?"Text":"text/plain",i=e.clipboardData||window.clipboardData;i.setData(t,we.getCopyText())},onCut:function(e){var t=window.clipboardData?"Text":"text/plain",i=e.clipboardData||window.clipboardData;i.setData(t,we.getCopyText(!0))},onPaste:function(e){var t=window.clipboardData?"Text":"text/plain",i=e.clipboardData||window.clipboardData,n="";n=i.getData(t),we.insertContent(n)},onFocus:function(){clearTimeout(this.onBlur.timer),this.showCursor()},onBlur:function(){var e=this;this.onBlur.timer=setTimeout((function(){e.hideCursor()}),300)},onKeyDown:function(e){this.shortcut.onKeyDown(e)}}},Se=Te,Ee=Object(l["a"])(Se,p,d,!1,null,null,null),Pe=Ee.exports;n["a"].use(c["a"]);var Me=new c["a"]({routes:[{path:"/home",name:"Home",component:Pe,meta:{title:"my-editor"}},{path:"*",redirect:"/home"}]}),Ie=Me;i("6295"),i("a970"),i("a205"),i("6b7e");n["a"].config.productionTip=!1,new n["a"]({router:Ie,render:function(e){return e(u)}}).$mount("#app")},6295:function(e,t,i){},"6b7e":function(e,t,i){},a205:function(e,t,i){},a970:function(e,t,i){}});
//# sourceMappingURL=app.d2fefdde.js.map