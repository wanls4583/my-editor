(function(e){function t(t){for(var n,a,l=t[0],o=t[1],h=t[2],c=0,p=[];c<l.length;c++)a=l[c],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&p.push(s[a][0]),s[a]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,h||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],n=!0,l=1;l<i.length;l++){var o=i[l];0!==s[o]&&(n=!1)}n&&(r.splice(t--,1),e=a(a.s=i[0]))}return e}var n={},s={app:0},r=[];function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var h=0;h<l.length;h++)t(l[h]);var u=o;r.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("keep-alive",[i("router-view")],1)],1)},r=[],a={name:"App"},l=a,o=i("2877"),h=Object(o["a"])(l,s,r,!1,null,null,null),u=h.exports,c=i("ac56"),p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"editor",staticClass:"my-editor-wrap",style:{"padding-bottom":e._statusHeight},on:{contextmenu:function(t){return t.preventDefault(),e.onContextmenu.apply(null,arguments)},mousedown:e.onClickEditor,selectstart:function(e){e.preventDefault()},wheel:function(t){return t.preventDefault(),e.onWheel.apply(null,arguments)}}},[i("div",{staticClass:"my-editor-nums",style:{top:e._numTop}},[i("div",{staticClass:"my-editor-num",staticStyle:{visibility:"hidden"}},[e._v(e._s(e.maxLine))]),e._l(e.renderHtmls,(function(t){return i("div",{key:t.num,staticClass:"my-editor-num",class:{"my-editor-num-active":e._activeLine(t.num)},style:{height:e._lineHeight,"line-height":e._lineHeight}},[i("span",{staticClass:"my-editor-icon my-editor-center",class:[e.errorMap[t.num]?"my-editor-icon-error":""],on:{mouseleave:e.onIconMouseLeave,mouseover:function(i){return e.onIconMouseOver(t.num,i)}}}),i("span",[e._v(e._s(t.num))]),t.fold?i("span",{staticClass:"my-editor-fold my-editor-center",class:["open"==t.fold?"my-editor-fold-open":"my-editor-fold-close"],on:{click:function(i){return e.onToggleFold(t.num)}}}):e._e()])}))],2),i("div",{staticClass:"my-editor-content-wrap",style:{"box-shadow":e._leftShadow}},[i("div",{ref:"scroller",staticClass:"my-editor-content-scroller",on:{mousedown:e.onScrollerMdown}},[i("div",{ref:"content",staticClass:"my-editor-content",style:{top:e._top,minWidth:e._contentMinWidth},on:{selectend:function(t){return t.preventDefault(),e.onSelectend.apply(null,arguments)}}},[e._l(e.renderHtmls,(function(t){return i("div",{key:t.num,staticClass:"my-editor-line",class:{active:e._activeLine(t.num)},style:{height:e._lineHeight,"line-height":e._lineHeight},attrs:{"data-line":t.num,id:"line_"+t.num}},[i("div",{staticClass:"my-editor-code",class:[t.selected?"my-editor-select-bg my-editor-select-active":"","close"==t.fold?"fold-close":""],attrs:{"data-line":t.num},domProps:{innerHTML:e._s(t.html)}}),e._l(e.selectedRanges,(function(n){return e._startBgLineVisible(n,t.num)?i("div",{staticClass:"my-editor-line-bg my-editor-select-bg",class:{"my-editor-select-active":n.active},style:{left:n.start.left+"px",width:n.start.width+"px"}}):e._e()})),e._l(e.selectedRanges,(function(n){return e._endBgLineVisible(n,t.num)?i("div",{staticClass:"my-editor-line-bg my-editor-select-bg my-editor-select-active",style:{left:n.end.left+"px",width:n.end.width+"px"}}):e._e()})),e._l(t.tabNum,(function(t){return i("span",{staticClass:"my-editor-tab-line",style:{left:e._tabLineLeft(t)}})}))],2)})),e._l(e.multiCursorPos,(function(t){return i("div",{staticClass:"my-editor-cursor",style:{height:e._lineHeight,top:t.top,left:t.left,visibility:e._cursorVisible}})}))],2)]),i("div",{ref:"hScroller",staticClass:"my-editor-h-scroller-wrap",on:{mousedown:function(e){e.stopPropagation()},mouseup:function(e){e.stopPropagation()},scroll:e.onHscroll}},[i("div",{staticClass:"my-editor-h-scroller",style:{width:e._hScrollWidth}})]),i("div",{ref:"vScroller",staticClass:"my-editor-v-scroller-wrap",on:{mousedown:function(e){e.stopPropagation()},mouseup:function(e){e.stopPropagation()},scroll:e.onVscroll}},[i("div",{staticClass:"my-editor-v-scroller",style:{height:e.scrollerHeight}})]),i("textarea",{ref:"textarea",staticClass:"my-editor-textarea",style:{top:e._textAreaPos.top,left:e._textAreaPos.left},on:{blur:e.onBlur,compositionend:e.onCompositionend,compositionstart:e.onCompositionstart,copy:function(t){return t.preventDefault(),e.onCopy.apply(null,arguments)},cut:function(t){return t.preventDefault(),e.onCut.apply(null,arguments)},focus:e.onFocus,input:e.onInput,keydown:e.onKeyDown,paste:function(t){return t.preventDefault(),e.onPaste.apply(null,arguments)}}})]),i("status-bar",{ref:"statusBar",attrs:{column:e.nowCursorPos.column+1,height:e.statusHeight,language:e.language,line:e.nowCursorPos.line,tabSize:e.tabSize},on:{"update:language":function(t){e.language=t},"update:tabSize":function(t){e.tabSize=t},"update:tab-size":function(t){e.tabSize=t}}}),i("panel",{directives:[{name:"show",rawName:"v-show",value:e.menuVisble,expression:"menuVisble"}],ref:"menu",attrs:{checkable:!1,menuList:e.menuList,styles:e.menuStyle},on:{change:e.onClickMenu}}),i("tip",{directives:[{name:"show",rawName:"v-show",value:e.tipContent,expression:"tipContent"}],attrs:{content:e.tipContent,styles:e.tipStyle}})],1)},d=[],f=i("ade3"),m=(i("4ec9"),i("d3b7"),i("3ca3"),i("ddb0"),i("4e82"),i("fb6a"),i("d81d"),i("e6e1"),i("a9e3"),i("ac1f"),i("5319"),i("841c"),i("4de4"),i("1276"),i("99af"),i("a434"),i("466d"),i("a15b"),i("53ca")),g=i("d4ec"),k=i("bee2"),v=(i("4d63"),i("c607"),i("2c3e"),i("25f0"),i("b0c0"),"[\\$_a-zA-Z][\\$_a-zA-Z0-9]*?"),x=function(e){var t=e.value;return"end"!==e.side||"\\"!==t[0]||t.length%2!==0},y={},b={start:/`/,end:/\\*?`/,token:"js-string",plainToken:"js-string",foldName:"js-string",valid:x,childRule:{rules:[{start:/\$\{/,end:/\}/,foldName:"js-string-expr",level:1,childRule:y}]}},w={start:/(?<=^|[\(\{\[\;\,\:\?\!\+\-\*\%\=\>\<\&\|]\s*?)\//,end:/(?<=(?:\\[\s\S]|[^\\])+?)\/(?:i|m|g|im|mi|ig|gi|mg|gm|img|igm|mig|mgi|gim|gmi)?|$/i,childRule:{rules:[{regex:/\\b/,token:"js-regex-ctrl"},{regex:/\\[\s\S]/,token:"js-regex-escape"},{regex:/\?\=|\?\<\=|\?\!|\?\<\!/,token:"js-regex"},{regex:/\*|\^|\$|\?/,token:"js-regex-ctrl"},{start:/\[/,end:/(?<!\\)\]/,token:"js-regex-bracket",childRule:{rules:[{regex:/\^/,token:"js-regex-ctrl",valid:function(e){var t=e.text,i=e.index;return"["===t[i-1]&&"\\"!==t[i-2]}}]}}]},token:"js-regex"},C=[b,{start:/'/,end:/\\*?'|[^\\]$|^$/,token:"js-string",foldName:"js-single-string",valid:x},{start:/"/,end:/\\*?"|[^\\]$|^$/,token:"js-string",foldName:"js-double-string",valid:x},{start:/\/\*/,end:/\*\//,token:"js-comment",foldName:"js-comment"},{regex:/\/\/[\s\S]*$/,token:"js-comment"},w,{regex:/\bvar\b|\blet\b|\bconst\b/,token:"js-type"},{regex:/\bcontinue\b|\bbreak\b|\bswitch\b|\bcase\b|\bdo\b|\bwhile\b|\belse\b|\bfor\b|\bif\b|\bnew\b|\breturn\b|\bfrom\b|\btypeof|\beach\b|\bin\b|\bimport\b|\bexport\b|\bdefault\b|\bwith\b|\bthrow\b|\btry\b|\bcatch\b|\bfinally\b/,token:"js-key"},{regex:/\bclass\b/,token:"js-class"},{regex:/\b[A-Z][\\$_a-zA-Z0-9]*?(?=\.)/,token:"js-function-class"},{regex:/\bfunction\b/,token:"js-function"},{regex:new RegExp("(".concat(v,")\\s*?(?=\\([^\\(\\)]*?\\)\\s*?\\{)")),token:"js-function-name"},{regex:new RegExp("(?<=\\bfunction\\s+?)".concat(v)),token:"js-function-name"},{regex:new RegExp("(?<=\\bnew\\s+?)".concat(v,"(?=\\s*?\\()")),token:"js-new-class"},{regex:/(\{)|(\[)|(\()/,token:["js-lbraces","js-lbracket","js-lparen"],foldType:-1,foldName:["js-braces","js-bracket","js-paren"]},{regex:/(\})|(\])|(\))/,token:["js-rbraces","js-rbracket","js-rparen"],foldType:1,foldName:["js-braces","js-bracket","js-paren"]},{regex:/(?<=\.)(?:prototype\b|toString\b|valueOf\b|toLocaleString\b|hasOwnProperty\b|isPrototypeOf\b|propertyIsEnumerable\b)/,token:"js-local"},{regex:/\bwindow\b|\bdocument\b|\bmodule\b|\bexports\b/,token:"js-local"},{regex:/\bthis\b|\bself\b/,token:"js-this"},{regex:/\+|\-|\*|\/|\=|\!|>|<|\&|\||\?/,token:"js-oprator"},{regex:new RegExp("\\b\\d+\\b|\\b0[xX][a-zA-Z0-9]*?\\b|\\bundefined\\b|\\bnull\\b|\\btrue\\b|\\bfalse\\b|\\bNaN\\b"),token:"js-number"},{regex:new RegExp("(".concat(v,")(?=\\()")),token:"js-function-exec"},{regex:new RegExp("(?<=\\s*?class\\s*?)".concat(v,"(?=\\s*?\\{)")),token:"js-class-name"}];y.rules=C;var T={rules:C},S={start:/\/\*/,end:/\*\//,token:"css-comment",foldName:"css-comment"},E={start:/\{/,end:/\}/,token:["css-lbraces","css-rbraces"],foldName:"css-braces",childRule:{rules:[S,null,{regex:/;/,token:"css-split"},{regex:/:/,token:"css-value-start"},{regex:/[a-zA-Z][^;\:\s\}]*?(?=\s*?\:)/,token:"css-property"},{regex:/(?<=\:\s*?)[^;\:\}]+?(?=;|}|$)/,token:"css-value"},{regex:/(?:\d+(?:\.\d*)?|\.\d+)%/,token:"css-percent"}]}};E.childRule.rules[1]=E;var I={rules:[S,E,{regex:/[#\.]?[^\s\,\:\{]+/,token:function(e){return"."==e[0]?"css-selector-class":"#"==e[0]?"css-selector-id":"css-selector-tag"}},{regex:/(?<=\:)[^\s\,\:]+/,token:"css-pseudo"}]},M=[{regex:/(?<=\:(?:\s*?\w+?\s*?){0,})\d+/,token:"html-style-number"},{regex:/(?<=\:\s*?\d+)px\b/,token:"html-style-px"},{regex:/(?<=(?:\;|'|")\s*?)[^\<\>\:\;'"]+/,token:"html-style-name"},{regex:/(?<=\:\s*?)[^\<\>\:\;'"]+/,token:"html-style-value"}],R=[{start:/(?<=style\s*?\=\s*?)'/,end:/'/,token:"xml-attr-value",level:1,childRule:{rules:M}},{start:/(?<=style\s*?\=\s*?)"/,end:/"/,token:"xml-attr-value",level:1,childRule:{rules:M}},{start:/(?<=\=\s*?)"/,end:/"/,level:1,token:"xml-attr-value"},{start:/(?<=\=\s*?)'/,end:/'/,level:1,token:"xml-attr-value"},{regex:/(?<=\<\/?)\w+\b/,token:"xml-tag-name",foldName:j,foldType:D},{regex:/(?<=\=)\s*?[^\<\>\s\'\"]+\b/,token:"xml-attr-value"},{regex:/\b[^'"=\s\>\<]+\b/,token:"xml-attr-name"}],P={start:/\<(?=script\b)/,end:/\>/,token:N,childRule:{rules:R}},L={start:/\<\/(?=script\>)/,end:/\>/,token:N,childRule:{rules:[{regex:/(?<=\<\/?)\w+\b/,token:"xml-tag-name",foldName:j,foldType:D}]}},O={start:/\<(?=style\b)/,end:/\>/,token:N,childRule:{rules:R}},A={start:/\<\/(?=style\s*?\>)/,end:/\>/,token:N,childRule:{rules:[{regex:/(?<=\<\/?)\w+\b/,token:"xml-tag-name",foldName:j,foldType:D}]}};function N(e){return"start"==e.side?"/"==e.value[1]?"xml-end-tag-open":"xml-tag-open":"end"===e.side?"xml-tag-close":void 0}function j(e){return/hr|br|meta|img|link|input/i.exec(e.value)?"":e.value}function D(e){return"/"==e.text[e.index-1]?1:-1}var F={rules:[{start:P,end:L,childRule:T},{start:O,end:A,childRule:I},{start:/\<\/?(?=\w+\b)/,end:/\/?\>/,token:N,childRule:{rules:R}},{start:/\<\!\-\-/,end:/\-\-\>/,token:"xml-comment",foldName:"xml-comment"}]},_=(i("2b3d"),i("9861"),i("c65b")),B=i.n(_),W=function(){function e(){Object(g["a"])(this,e)}return Object(k["a"])(e,null,[{key:"readClipboard",value:function(){return window.clipboardData?new Promise((function(e){e(clipboardData.getData("Text"))})):navigator.clipboard?navigator.clipboard.readText():void 0}},{key:"writeClipboard",value:function(e){window.clipboardData?clipboardData.setData("Text",e):navigator.clipboard&&navigator.clipboard.writeText(e)}},{key:"getNum",value:function(e){e=String(e),e=e.replace(/[^0123456789\.]/g,"");var t=/^\d+(\.\d*)?$/,i=t.exec(e),n=i&&i[0]||"";return n&&(n=Number(i[0])),n}},{key:"space",value:function(e){for(var t="",i=0;i<e;i++)t+=" ";return t}},{key:"sortNum",value:function(e){e.sort((function(e,t){return Number(e)-Number(t)}))}},{key:"getCharWidth",value:function(t){var i="------------------------------------------------------------------------------------",n="一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一一",s="char-width-"+e.getUUID(),r="char-width-"+e.getUUID(),a=B()('<div class="my-editor-line">\n        <div class="my-editor-code"><span id="'.concat(s,'">').concat(i,'</span><span id="').concat(r,'">').concat(n,"</span></div>\n        </div>"));B()(t).append(a);var l=B()("#"+s)[0],o=l.scrollWidth/i.length,h=l.clientHeight,u=window.getComputedStyle?window.getComputedStyle(l,null).fontSize:l.currentStyle.fontSize,c=B()("#"+r)[0].scrollWidth/n.length;return a.remove(),{charWidth:o,fullAngleCharWidth:c,charHight:h,fontSize:u}}},{key:"getStrWidth",value:function(e,t,i,n,s,r){n=n||4,"undefined"!=typeof s&&(e=e.substr(s)),"undefined"!=typeof r&&(e=e.substring(0,r-s));var a=e.match(this.fullAngleReg),l=e.length*t,o=e.match(/\t/g);return o=o&&o.length||0,a=a&&a.length||0,a&&(a-=o,l=a*i+(e.length-a)*t,l+=o*t*(n-1)),l}},{key:"getStrExactWidth",value:function(t,i,n){if(e.getStrExactWidth.count=e.getStrExactWidth.count||0,e.getStrExactWidth.count++,!t)return 0;var s="str-width-"+e.getUUID(),r=B()('<div class="my-editor-line my-editor-temp-text" style="visibility:hidden">\n        <div class="my-editor-code" id="'.concat(s,'">').concat(o(t),"</div>\n        </div>"));B()(n).append(r);var a=B()("#"+s)[0],l=a.clientWidth;return e.getStrExactWidth.count>5?B()(".my-editor-temp-text").remove():(clearTimeout(e.getStrExactWidth.timer),e.getStrExactWidth.timer=setTimeout((function(){B()(".my-editor-temp-text").remove()}),500)),l;function o(t){for(var n=Math.floor(t.length/100),s=[],r=0;r<n;r++){var a=100*r;s.push(e.htmlTrans(t.slice(a,a+100)))}return n*=100,n<t.length&&s.push(e.htmlTrans(t.slice(n))),"<span>".concat(s.join("</span><span>").replace(/\t/g,e.space(i||4)),"</span>")}}},{key:"htmlTrans",value:function(e){return e=e.replace(/\&\#/g,"&amp;#"),e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{key:"deepAssign",value:function(e,t,i){return n(e,t,i,new Map);function n(e,t,i,s){for(var r in i=i||[],t){var a=t[r];if(!(i.indexOf(r)>-1))if("object"!==Object(m["a"])(a)||a instanceof RegExp||null===a||a.nodeName&&a.nodeType)e[r]=a;else if(s.has(a))e[r]=s.get(a);else{var l=null;a instanceof Array?(l=e[r]||[],s.set(a,l),e[r]=n(l,a,i,new Map(s))):(l=e[r]||{},s.set(a,l),e[r]=n(l,a,i,new Map(s)))}}return e}}},{key:"getUUID",value:function(e){e=e||16;for(var t="",i=0;i<e;i++)t+=(16*Math.random()|0).toString(16);return t}},{key:"comparePos",value:function(e,t){return e.line>t.line||e.line==t.line&&e.column>t.column?1:e.line==t.line&&e.column==t.column?0:-1}},{key:"createWorker",value:function(e){var t=new Blob([e]),i=window.URL.createObjectURL(t),n=new Worker(i);return n}},{key:"defineProperties",value:function(e,t,i){var n={};i.map((function(e){n[e]={get:function(){return"function"==typeof t[e]?t[e].bind(t):t[e]}}})),Object.defineProperties(e,n)}}]),e}();Array.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},Array.prototype.empty=function(){return this.length=0,this},String.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},W.fullAngleReg=/[\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF\uFFF9-\uFFFC]|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,W.keyCode={DELETE:46,BACKSPACE:8},W.command={DELETE:"delete",INSERT:"insert"},W.constData={PAIR_START:-1,PAIR_START_END:0,PAIR_END:1,FOLD_OPEN:1,FOLD_CLOSE:-1,DEFAULT:"default"};var z=W,H=function(){function e(t,i){Object(g["a"])(this,e),this.currentLine=1,this.languageMap=[],this.initProperties(t,i),this.initLanguage(t.language)}return Object(k["a"])(e,[{key:"initLanguage",value:function(e){switch(this.language=e,clearTimeout(this.tokenizeLines.timer),e){case"JavaScript":this.initRules(T);break;case"HTML":this.initRules(F);break;case"CSS":this.initRules(I);break;default:this.language="plain"}}},{key:"initProperties",value:function(e,t){z.defineProperties(this,e,["startLine","maxVisibleLines","maxLine","renderLine"]),z.defineProperties(this,t,["htmls"])}},{key:"initRules",value:function(e){var t=this;if(this.languageMap[this.language]){var i=this.languageMap[this.language];return this.rules=i.rules,this.ruleIdMap=i.ruleIdMap,void(this.regexMap=i.regexMap)}this.ruleId=1,this.ruleIdMap={},this.regexMap={},this.rules=z.deepAssign({},e),this.rules.rules.map((function(e){t.setRuleId(e)})),this.languageMap[this.language]={rules:this.rules,ruleIdMap:this.ruleIdMap,regexMap:this.regexMap}}},{key:"setRuleId",value:function(e){var t=this;e.ruleId=this.ruleId++,e.level=e.level||0,e.token=e.token||"",this.ruleIdMap[e.ruleId]=e,"object"!==Object(m["a"])(e.start)||e.start instanceof RegExp||(this.setRuleId(e.start),e.start.startBy=e.ruleId),"object"!==Object(m["a"])(e.end)||e.end instanceof RegExp||(this.setRuleId(e.end),e.end.endBy=e.ruleId),e.childRule&&e.childRule.rules&&(e.childRule.rules.map((function(e){!e.ruleId&&t.setRuleId(e)})),e.rules=e.childRule.rules)}},{key:"getCombRegex",value:function(e){var t=this;e=e||[];var i=e+""||"0",n=[],s={},r=[],a=0,l=null;if(this.regexMap[i])return this.regexMap[i];if(e.length>1){var o=[];while(a<e.length-1)l=this.ruleIdMap[e[a+1]],l.startBy!==e[a]&&l.endBy!==e[a]?(o.push(e[a]),a++):a++;o.push(e[a]),e=o}a=e.length-1,l=e.length&&this.ruleIdMap[e.peek()]||this.rules;while(a>=0&&this.ruleIdMap[e[a]].level>=l.level)r.push(this.getEndRegex(this.ruleIdMap[e[a]])),a--;return r.reverse(),l.rules&&l.rules.map((function(e){r.push(t.getStartRegex(e))})),r.map((function(e){var t=-1===e.side?"start":"end";s[e.ruleId]&&s[e.ruleId]===t||(n.push("?<".concat(t,"_").concat(e.ruleId,">").concat(e.regex.source)),s[e.ruleId]=t)})),this.regexMap[i]=new RegExp("(".concat(n.join(")|("),")"),"g"),this.regexMap[i]}},{key:"getStartRegex",value:function(e){return e.regex instanceof RegExp?{ruleId:e.ruleId,regex:e.regex,side:-1}:e.start instanceof RegExp?{ruleId:e.ruleId,regex:e.start,side:-1}:e.start.startBy?this.getStartRegex(e.start):void 0}},{key:"getEndRegex",value:function(e,t){return e.regex instanceof RegExp?{ruleId:e.ruleId,regex:e.regex,side:t||1}:e.end instanceof RegExp?{ruleId:e.ruleId,regex:e.end,side:t||1}:e.end.endBy?this.getStartRegex(e.end,-1):void 0}},{key:"onInsertContentBefore",value:function(e){this.onInsertContentBefore.nowLine=e}},{key:"onInsertContentAfter",value:function(e){e=this.onInsertContentBefore.nowLine,"plain"!=this.language&&(e<=this.currentLine?this.tokenizeLines(e):this.tokenizeVisibleLins())}},{key:"onDeleteContentBefore",value:function(e){}},{key:"onDeleteContentAfter",value:function(e){"plain"!=this.language&&(e<=this.currentLine?this.tokenizeLines(e):this.tokenizeVisibleLins())}},{key:"onScroll",value:function(){"plain"!=this.language&&this.tokenizeVisibleLins()}},{key:"tokenizeVisibleLins",value:function(){var e=this.currentLine;this.tokenizeLines(this.startLine),this.currentLine=e}},{key:"tokenizeLines",value:function(e,t){var i=this,n=0,s=Date.now();t=t||this.maxLine;while(e<=t){var r=this.htmls[e-1];if(!r.tokens){var a=this.tokenizeLine(e);if(r.tokens=a.tokens,r.folds=a.folds,r.html=a.tokens.map((function(e){var t=i.ruleIdMap[e.ruleId];return t&&"function"===typeof t.value?t.value(e.value):'<span class="'.concat(e.type.split(".").join(" "),'" data-column="').concat(e.column,'">').concat(z.htmlTrans(e.value),"</span>")})).join(""),this.renderLine(r.lineId),r.states+""!=a.states+""&&(r.states=a.states,r=this.htmls[e],r&&(r.tokens=null)),n++,n%10==0&&Date.now()-s>=20){e++;break}}e++}this.currentLine=e,e<=t&&(this.tokenizeLines.timer=setTimeout((function(){i.tokenizeLines(e,t)}),20))}},{key:"tokenizeLine",value:function(e){var t=null,i=null,n=0,s=0,r=[],a=(e>1&&this.htmls[e-2].states||[]).slice(0),l=this.htmls[e-1],o=this.getRegex(a),h={tokens:[],folds:[]};if(l.text.length>1e4)return{tokens:this.splitLongToken([{type:"plain",column:0,value:l.text}]),folds:[],states:a};while(t=o.exec(l.text)){var u=null,c=null,p=!0,d="";for(var f in t.groups)if(void 0!=t.groups[f]){if(d=f.split("_")[0],f=f.split("_")[1]-0,i=this.ruleIdMap[f],s<t.index){var m=l.text.slice(s,t.index);h.tokens.push({value:m,column:s,type:this.getTokenType({rule:this.ruleIdMap[a.peek()],index:s,value:m,text:l.text})}),s=t.index}if("function"===typeof i.valid&&(p=i.valid({index:t.index,text:l.text,value:t[0],side:d}),!p))break;c=this.getFold(i,t,a,h,l.text),u=this.getToken(i,t,a,r,h,l.text,d),h.tokens.push(u),c&&h.folds.push(c),s=t.index+t[0].length;break}if(!t[0])break;p&&(n=o.lastIndex,o.lastIndex=0,o=this.getRegex(a,i.ruleId),o.lastIndex=n)}if(!h.tokens.length&&a.length)h.tokens.push({value:l.text,column:0,type:this.getTokenType({rule:this.ruleIdMap[a.peek()],value:l.text,text:l.text})});else if(s<l.text.length){var g=l.text.slice(s);h.tokens.push({value:g,column:s,type:this.getTokenType({rule:this.ruleIdMap[a.peek()],index:s,value:g,text:l.text})})}return o.lastIndex=0,{tokens:this.splitLongToken(h.tokens),folds:h.folds,states:a}}},{key:"splitLongToken",value:function(e){var t=[];return e.map((function(e){if(e.value.length>100){for(var i=e.column,n=Math.floor(e.value.length/100),s=0;s<n;s++){var r=100*s;t.push({column:r+i,value:e.value.slice(r,r+100),type:e.type})}n*=100,n<e.value.length&&t.push({column:n+i,value:e.value.slice(n),type:e.type})}else t.push(e)})),t}},{key:"getToken",value:function(e,t,i,n,s,r,a){var l=t[0],o={ruleId:e.ruleId,value:l,column:t.index};if(e.start&&e.end)if("end"===a){while(i.peek()!=e.ruleId)i.pop();if(i.pop(),!e.rules)if(n.indexOf(e.ruleId)>-1){var h="";o=s.tokens.pop(),h=o.value,o.ruleId!==e.ruleId&&(o=s.tokens.pop(),h=o.value+h),o.value=h+l}else s.tokens.pop(),o.value=r.slice(0,t.index+l.length),o.column=0}else i.push(e.ruleId),n.push(e.ruleId);return o.type=this.getTokenType({rule:e,index:t.index,value:o.value,text:r,match:t,side:a}),o}},{key:"getTokenType",value:function(e){var t=e.rule,i=e.index||0,n=e.value||e.text,s=e.text,r=e.match,a=e.side||(t&&t.start&&t.end?"start":""),l="";if(!t)return"plain";if("function"==typeof t.token)l=t.token({value:n,index:i,text:s,side:a});else if(t.token instanceof Array)if(t.start&&t.end)l="start"==a?t.token[0]:t.token[1];else{var o=r&&this.getChildExpIndex(r)||-1;l=o>-1?t.token[o]:t.token.join(".")}else l=t.token;return l}},{key:"getFold",value:function(e,t,i,n,s){var r=t[0],a="",l=null;if(e.start&&e.end?(a="start",i.indexOf(e.ruleId)>-1&&(a="end"),e.foldName&&(l={start:t.index,end:t.index+r.length,value:r})):e.foldName&&e.foldType&&(l={start:t.index,end:t.index+r.length,value:r}),l){var o=this.getFoldName(e,t,s,a);if(!o)return null;l.name=o,l.type=this.getFoldType(e,t,s,a),1==l.type&&(l=h(n,l))}return l;function h(e,t){var i=e.folds;if(i)for(var n=i.length-1;n>=0;n--)if(i[n].name==t.name&&-1==i[n].type){e.folds=i.slice(0,n),t=null;break}return t}}},{key:"getFoldName",value:function(e,t,i,n){var s="";if(e.foldName instanceof Array)if(e.start&&e.end)s="start"==n?e.foldName[0]:e.foldName[1];else{var r=this.getChildExpIndex(t);r=-1==r?0:r,s=e.foldName[r]}else s="function"===typeof e.foldName?e.foldName({value:t[0],text:i,index:t.index,side:n}):e.foldName;return s}},{key:"getFoldType",value:function(e,t,i,n){var s="";if(e.foldType instanceof Array)if(e.start&&e.end)s="start"==n?e.foldType[0]:e.foldType[1];else{var r=this.getChildExpIndex(t);r=-1==r?0:r,s=e.foldType[r]}else s="function"===typeof e.foldType?e.foldType({value:t[0],text:i,index:t.index,side:n}):e.start&&e.end?"start"==n?-1:1:e.foldType;return s}},{key:"getChildExpIndex",value:function(e){if(void 0!==e.childExpIndex)return e.childExpIndex;var t=e.slice(1),i=t.filter((function(e){return e})).length>1;if(i){for(var n=0;n<t.length;n++)if(void 0!=t[n]){t=t.slice(n+1);break}for(var s=0;s<t.length;s++)if(void 0!=t[s])return e.childExpIndex=s,s}return e.childExpIndex=-1,-1}},{key:"getRegex",value:function(e,t){var i=this.ruleIdMap[t];while(i&&-1==e.indexOf(i.ruleId)&&i.endBy){while(e.peek()!=i.endBy)e.pop();e.pop(),i=this.ruleIdMap[i.endBy]}return i&&-1==e.indexOf(i.ruleId)&&i.startBy&&e.push(i.startBy),this.getCombRegex(e)}}]),e}(),V=function(){Array.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},Array.prototype._isArray=!0,String.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]};var e=["if","in","do","var","for","new","try","let","this","else","case","void","with","enum","while","break","catch","throw","const","yield","class","super","return","typeof","delete","switch","export","import","default","finally","extends","function","continue","debugger","instanceof","async","await"],t=["=",">>>=",">>=","<<=","+=","-=","*=","/=","%=","&=","|=","^="],i=["+","-","*","/","%","&","|","^","&&","||","===","==","!=","!==",">",">=","<","<=",">>",">>>","<<","instanceof","in"],n=["+","-","~","!","typeof","delete","void"],s=["{","}","[","]","(",")"],r={space:/^\s+/,number:/^(?:\d+(?:\.\d*)?|\.\d+?|0x[a-z0-9]+?)(?:e[\+\-]?\d+(?:\.\d*)?)?\b/i,identifier:/^[a-zA-Z_$][a-zA-Z0-9_$]*/,comment:/\*\//,string1:/\\*'/,string2:/\\*"/,string3:/(\\*`)|(\$\{)/,regex:/^\/(?:\\[\s\S]|[^\\])+?\//,other:/^[^\s+\-\*\/%&\|\^\=\!\>\<\~\{\}\(\)]+/},a={i:!0,m:!0,g:!0,gi:!0,gm:!0,im:!0,gim:!0},l=100;function o(e,t){this.type=e,this.label=t,this._isTokenType=!0}function h(e){this.type=e}function u(e,t,i){e=e||{},this.type=t,this.param=i,this.line=e.line,this.column=e.column,this.value=e.value,this.error=this.toString()}function c(){this.init()}function p(e){this.lexer=e,this.cacheList=[],this.backs=[],this.parseList=[],this.preToken=null,u.errors=[]}o.prototype.toString=function(){return this.label},o.NUMBER=new o(1,"number"),o.BOOLEAN=new o(2,"boolean"),o.STRING=new o(3,"string"),o.IDENTIFIER=new o(4,"identifier"),o.KEYWORD=new o(5,"keyword"),o.OPERATOR=new o(6,"operator"),o.BRACKET=new o(7,"bracket"),o.PUNCTUATOR=new o(8,"punctuator"),o.REGEXP=new o(9,"regexp"),o.OTHER=new o(10,"other"),h.UNEXPECTED=new h(1),h.EXPECTED=new h(2),h.MISS=new h(3),h.UNMATCH=new h(4),u.prototype.toString=function(){var e="",t=this.param instanceof Array?this.param:[this.param];switch(t="".concat(1===t.length?"a ":"","'").concat(t.join("'、'"),"'"),this.type){case h.UNEXPECTED:e="unexpected '".concat(this.value,"'");break;case h.EXPECTED:e="expected ".concat(t),this.value&&(e+=" and instead saw '".concat(this.value,"'"));break;case h.MISS:e="missing ".concat(t),this.value&&(e+=" before '".concat(this.value,"'"));break;case h.UNMATCH:e="unmatched '".concat(this.value,"'");break}return e},u.push=function(e){u.errors.push(e)},u.expectedIdentifier=function(e){u.push(new u(e,h.EXPECTED,o.IDENTIFIER))},u.expectedSemicolon=function(e){u.push(new u(e,h.MISS,";"))},u.expected=function(e,t){u.push(new u(e,h.EXPECTED,t))},u.unexpected=function(e){u.push(new u(e,h.UNEXPECTED))},u.unmatch=function(e){u.push(new u(e,h.UNMATCH))},c.prototype.init=function(){var r=this;u.errors=[],this.lines=[""],this.line=1,this.column=0,this.input="",this.assignOperatorMap={},this.unitOperatorMap={},this.binaryOperatorMap={},this.keywordsMap=new Map,this.bracketsMap=new Map,t.map((function(e){r.assignOperatorMap[e]=!0})),n.map((function(e){r.unitOperatorMap[e]=!0})),i.map((function(e){r.binaryOperatorMap[e]=!0})),e.map((function(e){r.keywordsMap.set(e,!0)})),s.map((function(e){r.bracketsMap.set(e,!0)}))},c.prototype.reset=function(e){this.lines=e.texts,this.line=e.line||1,this.column=e.column||0,this.input=this.lines[this.line-1].slice(this.column)},c.prototype.skip=function(e){this.input=e?this.input.slice(e):this.input,this.column+=e},c.prototype.skipLine=function(e){this.line+=e,this.column=0,this.input=this.lines[this.line-1]||""},c.prototype.hasNext=function(){return!(u.errors.length>l)&&(this.line<this.lines.length||this.line==this.lines.length&&this.lines.peek().length>this.column)},c.prototype.isVariable=function(e){return e.type==o.IDENTIFIER||"this"==e.value},c.prototype.isValue=function(e){return this.isScalar(e)||this.isVariable(e)},c.prototype.isScalar=function(e){return e.type==o.NUMBER||e.type==o.STRING||e.type==o.BOOLEAN||e.type==o.REGEXP},c.prototype.isDotAble=function(e){return e.type===o.IDENTIFIER||e.type===o.KEYWORD},c.prototype.isPostOp=function(e){return"++"===e.value||"--"===e.value},c.prototype.isPreOp=function(e){return"++"===e.value||"--"===e.value},c.prototype.isAssignOperator=function(e){return this.assignOperatorMap[e.value]},c.prototype.isUnitOperator=function(e){return this.unitOperatorMap[e.value]},c.prototype.isBinaryOperator=function(e){return this.binaryOperatorMap[e.value]},c.prototype.isKeyWord=function(e){return this.keywordsMap.has(e)},c.prototype.isBracket=function(e){return this.bracketsMap.has(e)},c.prototype.isTokenType=function(e){return e._isTokenType},c.prototype.craeteToken=function(e,t){var i=this.line,n=this.column;return i>this.lines.length&&(i=this.lines.length,n=this.lines.peek().length),{type:t,line:i,column:n,value:e}},c.prototype.scanSpace=function(){var e=null;while(!this.input.length&&this.line<this.lines.length)this.skipLine(1);e=r.space.exec(this.input),e&&(this.skip(e.index+e[0].length),e.index>=this.input.length-1&&this.scanSpace())},c.prototype.scanComment=function(){var e=null,t=null,i=null,n=null;if(this.scanSpace(),t=this.input[0],i=this.input[1],"/"===t&&"/"==i)this.skipLine(1),this.scanComment();else if("/"===t&&"*"===i){n=this.craeteToken("/*"),this.skip(2);while(this.hasNext()&&!(e=r.comment.exec(this.input)))this.skipLine(1);e?this.skip(e.index+e[0].length):u.unmatch(n)}},c.prototype.scanString=function(){var e=this,t=null,i=null,n=null;if("'"===this.input[0])return n=this.craeteToken("'",o.STRING),this.skip(1),t=s(r.string1),i=this.craeteToken("'",o.STRING),t||(u.unmatch(n),this.skipLine(1)),i;if('"'===this.input[0])return n=this.craeteToken('"',o.STRING),this.skip(1),t=s(r.string2),i=this.craeteToken('"',o.STRING),t||(u.unmatch(n),this.skipLine(1)),i;if("`"===this.input[0]){n=this.craeteToken("`",o.STRING),this.skip(1);while(this.hasNext())if(t=r.string3.exec(this.input),t&&t[2])a(t);else{if(t&&t[0].length%2!==0){this.skip(t.index+t[0].length);break}this.skipLine(1)}i=this.craeteToken("`",o.STRING),t&&t[0].length%2===1||u.unmatch(n)}return i;function s(i){return(t=i.exec(e.input))?(e.skip(t.index+t[0].length),t[0].length%2!==0||s(i)):"\\"===e.input.peek()&&(e.skipLine(1),s(i))}function a(t){var i=e.parser.preToken,n=e.parser.backs.slice(0),s=e.parser.parseList.slice(0);e.skip(t.index+t[2].length),e.parser.preToken=null,e.parser.backs=[],e.parser.parseList=[],e.parser.parseExprStmt(),e.parser.peekMatch("}"),e.parser.preToken=i,e.parser.backs=n,e.parser.parseList=s}},c.prototype.scanNunmber=function(){var e=null,t=null;return(e=r.number.exec(this.input))&&(t=this.craeteToken(e[0],o.NUMBER),this.skip(e.index+e[0].length)),t},c.prototype.scanIdentifier=function(){var e=null,t=null;return(e=r.identifier.exec(this.input))&&(t=this.craeteToken(e[0],this.isKeyWord(e[0])?o.KEYWORD:o.IDENTIFIER),"true"!==t.value&&"false"!==t.value||(t.type=o.BOOLEAN),"null"===t.value&&(t.type=o.NUMBER),this.skip(e.index+e[0].length)),t},c.prototype.scanBracket=function(){var e=null,t=this.input[0];return this.isBracket(t)&&(e=this.craeteToken(t,o.BRACKET),this.skip(1)),e},c.prototype.scanOperator=function(){var e=this.input[0],t=this.input[1],i=this.input[2],n=this.input[3],s=null;return"."==e&&"."===t&&"."===i?s=this.craeteToken("...",o.OPERATOR):">"===e&&">"===t&&">"===i&&"="===n?s=this.craeteToken(">>>=",o.OPERATOR):"="===e&&"="===t&&"="===i?s=this.craeteToken("===",o.OPERATOR):"!"===e&&"="===t&&"="===i?s=this.craeteToken("!==",o.OPERATOR):">"===e&&">"===t&&">"===i?s=this.craeteToken(">>>",o.OPERATOR):"<"===e&&"<"===t&&"="===i?s=this.craeteToken("<<=",o.OPERATOR):">"===e&&">"===t&&"="===i?s=this.craeteToken(">>=",o.OPERATOR):"="===e&&">"===t?s=this.craeteToken("=>",o.OPERATOR):e===t&&"+-<>&|*".indexOf(e)>=0?s="*"===e&&"="===i?this.craeteToken(e+t+i,o.OPERATOR):this.craeteToken(e+t,o.OPERATOR):"<>=!+-*%&|^/".indexOf(e)>=0?s="="===t?this.craeteToken(e+t,o.OPERATOR):this.craeteToken(e,o.OPERATOR):"?:.;,~".indexOf(e)>-1&&(s=this.craeteToken(e,o.OPERATOR)),s&&this.skip(s.value.length),s},c.prototype.scanOther=function(){var e=null,t=null;return(e=r.other.exec(this.input))&&(t=this.craeteToken(e[0],o.OTHER),this.skip(e.index+e[0].length)),t},c.prototype.next=function(){var e=null,t=this;return this.scanComment(),this.hasNext()&&(e=this.scanIdentifier()||this.scanBracket()||this.scanNunmber()||this.scanString()||i(),!e)?(e=this.scanOther(),e&&u.unexpected(e),this.next()):(this.preToken=e,e);function i(){var e=null;if("/"!==t.input[0]||t.preToken&&t.preToken.type!==o.OPERATOR&&"{"!==t.preToken.value&&"["!==t.preToken.value&&"("!==t.preToken.value&&"return"!==t.preToken.value)e=t.scanOperator();else{var i=r.regex.exec(t.input);if(i)e=t.craeteToken(i[0],o.REGEXP),t.skip(i.index+i[0].length);else if(e=t.craeteToken(t.input,o.REGEXP),t.skipLine(1),"/"!==e.value.peek()){var n=Object.assign({},e);n.value="/",u.unmatch(n)}}return e}},p.prototype.reset=function(e){this.backs=[],this.parseList=[],this.preToken=null,this.recovery(e),u.errors=[]},p.prototype.cache=function(){this.cacheList.length&&this.cacheList.peek().line==this.lexer.line&&this.cacheList.pop(),this.preToken&&this.cacheList.push({line:this.preToken.line,column:this.preToken.column,parseList:this.parseList.slice(0)})},p.prototype.recovery=function(e){var t=0,i=e.split("\n")||[""],n=!1;while(t<i.length&&t<this.lexer.lines.length&&i[t]===this.lexer.lines[t])t++;if(t>0){for(var s=-1,r=0;r<this.cacheList.length;r++){if(!(this.cacheList[r].line<=t))break;s=r}if(s>-1){var a=this.cacheList[s];this.parseList=a.parseList,this.cacheList=this.cacheList.slice(0,s+1),this.lexer.reset({texts:i,line:a.line,column:a.column}),this.next(),n=!0}}n||(this.cacheList=[],this.lexer.reset({texts:i}))},p.prototype.match=function(e,t){for(var i=!1,n=0;n<t.length;n++)if(this.lexer.isTokenType(t[n])){if(t[n]===e.type){i=!0;break}}else if(t[n]===e.value){i=!0;break}return i},p.prototype.next=function(e){var t=null;e=e||1;while(e>0)t=this.backs.length?this.backs.shift():this.lexer.next(),this.pre2Token=this.preToken,this.preToken=t||this.preToken,e--;return this.puted=!1,t},p.prototype.nextMatch=function(e){var t=this.next()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i||(t.value&&this.match(this.peek(),e)?u.unexpected(t):u.expected(t,e)),i},p.prototype.peek=function(e){var t=null;if(e=e||1,this.backs.length&&(t=this.backs[e-1]),!t){e-=this.backs.length;while(e>0)e--,t=this.lexer.next(),t&&this.backs.push(t)}return t||{}},p.prototype.peekMatch=function(e){var t=this.peek()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i?this.next():t.value&&this.match(this.peek(),e)?u.unexpected(t):u.expected(t,e),i},p.prototype.hasNext=function(){var e=this.peek();return e.value},p.prototype.putBack=function(){this.preToken&&!this.puted&&(this.backs.unshift(this.preToken),this.preToken=this.pre2Token,this.puted=!0)},p.prototype.skipSemicolon=function(e){e=e||1/0;while(";"===this.peek().value&&e>0)this.next(),e--},p.prototype.parse=function(){var e=this,t=0,i=Date.now();while(this.hasNext())if(this.parseStmt(),!u.errors.length&&this.cache(),++t%10===0&&Date.now()-i>200){this.parseTimer=setTimeout((function(){e.parseStmt()}),10);break}},p.prototype.parseStmt=function(e){var t=this.peek();if(e){if(";"===t.value)return}else this.preToken&&this.preToken.line==t.line&&"{"!=this.preToken.value&&"}"!=this.preToken.value&&";"!=t.value&&u.expectedSemicolon(t);switch(this.skipSemicolon(),t=this.peek(),t.type===o.IDENTIFIER&&":"===this.peek(2).value&&(this.next(2),t=this.peek()),t.value){case"var":case"let":case"const":this.parseDeclareStmt();break;case"{":":"===this.peek(3).value?this.parseObjectStmt():this.parseBlockStmt();break;case"import":this.parseImportStmt();break;case"export":this.parseExportStmt();break;case"if":this.parseIfStmt();break;case"switch":this.parseSwitchStmt();break;case"with":this.parseWithStmt();break;case"while":this.parseWhileStmt();break;case"do":this.parseDoStmt();break;case"try":this.parseTryStmt();break;case"for":this.parseForStmt();break;case"class":this.parseClassStmt();break;case"continue":case"break":this.parseControlStmt();break;case"return":this.parseReturnStmt();break;case"throw":this.parseThrowStmt();break;case"function":this.parseFunctionStmt(!0);break;default:this.parseExprStmt();break}},p.prototype.parseBlockStmt=function(e){var t=this.peek();this.peekMatch("{");while(this.hasNext()){this.skipSemicolon();var i=this.peek();if("}"===i.value||e&&e.indexOf(i.value)>-1)break;this.parseStmt(!0)}this.peekMatch("}")||"{"!==t.value||u.unmatch(t)},p.prototype.parseObjectStmt=function(){var e=this.peek(),t=null;this.peekMatch("{");while(this.hasNext()&&"}"!=this.peek().value){if("..."===this.peek().value)this.next(),"{"===this.peek().value?this.parseObjectStmt():this.nextMatch(o.IDENTIFIER);else{if("["===this.peek().value)this.next(),this.parseExpr(),this.peekMatch("]");else if(this.peek().type===o.OPERATOR)u.unexpected(this.next());else{if(!this.hasNext())break;this.next()}t=this.peek(),":"===t.value||"]"===this.preToken.value?(this.peekMatch(":"),this.parseExpr()):(this.preToken.type!==o.IDENTIFIER&&u.expected(t,":"),"("===t.value?(this.parseFunArgsStmt(),this.parseBlockStmt()):"("===this.peek(2).value&&("get"!==this.preToken.value&&"static"!==this.preToken.value&&u.expected(this.preToken,["get","static"]),this.nextMatch(o.IDENTIFIER),this.parseFunArgsStmt(),this.parseBlockStmt()))}if("}"!=this.peek().value&&!this.peekMatch(","))break}this.peekMatch("}")||"{"!==e.value||u.unmatch(e)},p.prototype.parseDeclareStmt=function(){var e=this;this.nextMatch(["var","let","const"]),i(),"="===this.peek().value&&t();while(this.hasNext()&&","===this.peek().value)this.next(),i(),"="===this.peek().value&&t();function t(){e.next(),e.parseExpr()}function i(){var t=e.peek();if("{"===t.value||"["===t.value){var i=e.next(),n="{"===t.value?"}":"]";e.nextMatch(o.IDENTIFIER);while(e.hasNext()&&e.peek().value!==n)if(e.peekMatch(","),!e.peekMatch(o.IDENTIFIER))break;e.peekMatch(n)||u.unmatch(i)}else e.nextMatch(o.IDENTIFIER)}},p.prototype.parseAssignStmt=function(e){e=e||"=",this.nextMatch(e);while(this.hasNext()){if("="===this.peek(2).value){!this.lexer.isVariable(this.next())&&u.expected(o.IDENTIFIER),this.parseAssignStmt("=");break}if(this.parseExpr(),","!==this.peek().value)break;this.next()}},p.prototype.parseImportStmt=function(){var e=null;if(this.nextMatch("import"),e=this.peek(),e.type===o.STRING)this.next();else{if("{"===e.value){this.next(),this.nextMatch(o.IDENTIFIER);while(this.hasNext()&&"}"!=this.peek().value){if(this.peekMatch(","),!this.peekMatch(o.IDENTIFIER))break;"as"===this.peek().value&&(this.next(),this.nextMatch(o.IDENTIFIER))}this.peekMatch("}")||u.unmatch(e)}else"*"===e.value?(this.next(),this.nextMatch("as"),this.nextMatch(o.IDENTIFIER)):this.nextMatch(o.IDENTIFIER);this.nextMatch("from"),this.nextMatch(o.STRING)}},p.prototype.parseExportStmt=function(){var e=null;if(this.nextMatch("export"),e=this.peek(),"function"===e.value)this.next(),this.parseFunctionStmt();else if("default"===e.value)this.next(),e=this.peek(),"function"==e.value?this.parseFunctionStmt():"class"===e.value?this.parseClassStmt():this.parseExprStmt();else if("{"===e.value){this.next(),this.nextMatch(o.IDENTIFIER);while(this.hasNext()&&"}"!=this.peek().value){if(this.peekMatch(","),!this.peekMatch(o.IDENTIFIER))break;"as"===this.peek().value&&(this.next(),this.nextMatch(o.IDENTIFIER))}this.peekMatch("}")||u.unmatch(e),"from"===this.peek().value&&(this.next(),this.nextMatch(o.STRING))}else"*"===e.value?(this.next(),"as"===this.peek().value&&(this.nextMatch("as"),this.nextMatch(o.IDENTIFIER)),this.nextMatch("from"),this.nextMatch(o.STRING)):this.parseDeclareStmt()},p.prototype.parseIfStmt=function(){var e=this,t=null;function i(){e.peekMatch("("),e.parseExprStmt(),e.peekMatch(")")}function n(){if("{"!==e.peek().value)return e.parseStmt(!0),!0;e.parseBlockStmt(["else"])}this.nextMatch("if"),this.parseList.push("if"),i(),t=n()&&";"===this.peek().value?this.peek(2):this.peek(),"else"===t.value&&(";"===this.next().value&&this.next(),"if"===this.peek().value?this.parseIfStmt():n()),this.parseList.pop()},p.prototype.parseSwitchStmt=function(){var e=null,t=null;this.parseList.push("switch"),this.nextMatch("switch"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),e=this.peek(),this.peekMatch("{");while(this.hasNext()&&"}"!=this.peek().value){"default"===this.peek().value?this.nextMatch("default"):(this.nextMatch("case"),this.parseExprStmt()),this.peekMatch(":");while(this.hasNext()){if(this.skipSemicolon(),t=this.peek(),"}"===t.value||"break"===t.value||"case"===t.value||"default"===t.value)break;this.parseStmt(!0)}if("break"===this.peek().value){var i={"}":!0,case:!0,default:!0};if(this.next(),this.skipSemicolon(),t=this.peek(),!i[t.value]){u.expected(t,["case","default"]);while(this.hasNext()&&!i[this.peek().value])this.next()}}}this.peekMatch("}")||"{"!==e.value||u.unmatch(e),this.parseList.pop()},p.prototype.parseWithStmt=function(){this.nextMatch("with"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),this.parseBlockStmt()},p.prototype.parseWhileStmt=function(){this.parseList.push("while"),this.nextMatch("while"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),"{"===this.peek().value?this.parseBlockStmt():this.parseStmt(!0),this.parseList.pop()},p.prototype.parseDoStmt=function(){this.parseList.push("do"),this.nextMatch("do"),"{"===this.peek().value?this.parseBlockStmt():(this.parseStmt(!0),this.skipSemicolon(1)),this.nextMatch("while"),this.peekMatch("("),this.parseExprStmt(),this.peekMatch(")"),this.parseList.pop()},p.prototype.parseTryStmt=function(){var e=null;this.nextMatch("try"),this.parseBlockStmt(),e=this.peek(),"catch"!==e.value&&"finally"!==e.value?u.expected(e,["catch","finally"]):("catch"===e.value&&(this.nextMatch("catch"),this.peekMatch("("),this.nextMatch(o.IDENTIFIER),this.peekMatch(")"),this.parseBlockStmt()),"finally"===this.peek().value&&(this.next(),this.parseBlockStmt()))},p.prototype.parseForStmt=function(){this.parseList.push("for"),this.nextMatch("for"),this.peekMatch("("),"in"===this.peek(2).value||"of"===this.peek(2).value||"in"===this.peek(3).value||"of"===this.peek(3).value?("in"!==this.peek(3).value&&"of"!==this.peek(3).value||this.nextMatch(["var","let","const"]),this.nextMatch(o.IDENTIFIER),this.nextMatch(["in","of"]),this.parseExprStmt()):(["var","let","const"].indexOf(this.peek().value)>-1?this.parseDeclareStmt():";"!=this.peek().value&&this.parseExprStmt(),this.nextMatch(";"),";"!=this.peek().value&&this.parseExprStmt(),this.nextMatch(";"),")"!=this.peek().value&&this.parseExprStmt()),this.peekMatch(")"),"{"===this.peek().value?this.parseBlockStmt():this.parseStmt(!0),this.parseList.pop()},p.prototype.parseFunctionStmt=function(e){this.nextMatch("function"),(this.peek().type===o.IDENTIFIER||e)&&this.nextMatch(o.IDENTIFIER),this.parseFunArgsStmt(),this.parseBlockStmt()},p.prototype.parseClassStmt=function(){var e=null,t=!this.preToken||-1==["(","=","default"].indexOf(this.preToken.value);this.nextMatch("class"),(this.peek().type===o.IDENTIFIER||t)&&this.nextMatch(o.IDENTIFIER),"extends"===this.peek().value&&(this.next(),this.nextMatch(o.IDENTIFIER)),e=this.peek(),this.peekMatch("{");while(this.hasNext()&&"}"!=this.peek().value)"="===this.peek(2).value?(this.nextMatch(o.IDENTIFIER),this.parseAssignStmt("=")):("static"!==this.peek().value&&"get"!==this.peek().value||this.next(),this.nextMatch(o.IDENTIFIER),this.parseFunArgsStmt(),this.parseBlockStmt());this.peekMatch("}")||"{"!==e.value||u.unmatch(e)},p.prototype.parseFunArgsStmt=function(){var e=this;this.peekMatch("("),")"!=this.peek().value&&this.nextMatch(o.IDENTIFIER),"="===this.peek().value&&t();while(this.hasNext()&&","===this.peek().value)this.next(),this.nextMatch(o.IDENTIFIER),"="===this.peek().value&&t();function t(){e.next(),e.parseExpr()}this.peekMatch(")")},p.prototype.parseControlStmt=function(){var e=this.next();this.checkIn(["for","while","do","if"])?this.peek().type===o.IDENTIFIER&&this.next():u.unexpected(e)},p.prototype.parseReturnStmt=function(){var e=null;this.nextMatch("return"),e=this.peek(),";"!==e.value&&"}"!==e.value&&e.line===this.preToken.line&&this.parseExprStmt()},p.prototype.parseThrowStmt=function(){var e=null;this.nextMatch("throw"),e=this.peek(),e.line!==this.preToken.line?u.expected(e,"expression"):this.parseExprStmt()},p.prototype.checkIn=function(e){e=e instanceof Array?e:[e];for(var t=this.parseList.length;t>=0;t--)if(e.indexOf(this.parseList[t])>-1)return!0;return!1},p.prototype.parseRegex=function(){if(this.next(),this.peek().type===o.IDENTIFIER){var e=this.peek().value.toLowerCase();a[e.split("").sort().join("")]&&this.next()}},p.prototype.parseExprStmt=function(){while(this.hasNext()){if(this.parseExpr(),","!=this.peek().value)break;this.next()}},p.prototype.parseExpr=function(){this.peek();var e=null;if(this.hasNext())while(1){var t=this.parseLeftHand();if(t.end)break;if(e=this.peek(),"."===e.value&&this.preToken.type!==o.NUMBER&&(this.parseDot(),e=this.peek(),t.assignAble=!0),"["===e.value&&this.preToken.type!==o.NUMBER&&(this.parseProperty(),e=this.peek(),t.assignAble=!0),this.lexer.isPostOp(e)&&(!t.assignAble&&u.expectedIdentifier(e),t.assignAble=!1,this.next(),e=this.peek()),"?"!==e.value){if(this.lexer.isAssignOperator(e)&&t.assignAble){this.parseAssignStmt(this.peek().value);break}if(!this.lexer.isBinaryOperator(e))break;if(this.next(),!this.hasNext()){u.unexpected(this.preToken);break}}else this.nextMatch("?"),this.parseExpr(),this.peekMatch(":")}else u.expected(null,"expression")},p.prototype.parseLeftHand=function(){var e=this.preToken,t=this.next(),i=null,n=!1,s=!1,r=!1,a=!1;if(this.lexer.isUnitOperator(t)){if("!"===t.value||"delete"===t.value||"void"===t.value){var l=t.value;while(t&&t.value===l)
//!!!...
e=t,t=this.next()}else e=t,t=this.next();a=!0}return t&&this.lexer.isPreOp(t)&&(e=t,t=this.next(),t&&!this.lexer.isVariable(t)&&u.expectedIdentifier(t),r=!0),i=this.peek(),t?"function"===t.value?(this.putBack(),this.parseFunctionStmt(),"("===this.peek().value&&this.parseCallArgs()):"("===t.value?(this.putBack(),this.parseParen(),n=!0):"["===t.value?(this.putBack(),this.parseArray()):"new"===t.value?(this.putBack(),this.parseNew()):"{"==t.value?(this.putBack(),this.parseObjectStmt()):t.type===o.REGEXP?(this.putBack(),this.parseRegex()):"("!==i.value||r?"=>"!==i.value||r||a||!this.lexer.isVariable(t)?r||a||!this.lexer.isVariable(t)?this.lexer.isValue(t)||(u.expectedIdentifier(t),s=!0):n=!0:(this.parseArrorwFunction(e&&":"===e.value),s=!0):this.parseCallArgs():(u.expectedIdentifier(),s=!0),{assignAble:n,end:s}},p.prototype.parseParen=function(){var e=1,t=this.peek(),i=this.preToken;this.nextMatch("(");var n=this.peek();while(n.value&&")"!=n.value)e++,n=this.peek(e);")"===n.value&&"=>"===this.peek(e+1).value?(this.putBack(),this.parseFunArgsStmt(),this.parseArrorwFunction(i&&":"===i.value)):(this.parseExprStmt(),!this.peekMatch(")")&&u.unmatch(t),"("===this.peek().value&&this.parseCallArgs())},p.prototype.parseArray=function(){var e=null;this.nextMatch("[");while(this.hasNext()&&"]"!==this.peek().value){if("..."===this.peek().value&&this.next(),this.parseExpr(),e=this.peek(),","!==e.value)break;this.next()}this.nextMatch("]")},p.prototype.parseNew=function(){this.nextMatch("new"),"("===this.peek().value?this.parseParen():this.nextMatch([o.IDENTIFIER,o.KEYWORD]),"("===this.peek().value&&this.parseCallArgs()},p.prototype.parseArrorwFunction=function(e){this.nextMatch("=>"),"{"===this.peek().value?this.parseBlockStmt():e?this.parseExpr():this.parseExprStmt()},p.prototype.parseCallArgs=function(){if(this.peekMatch("("),")"!==this.peek().value)while(this.hasNext()){if("..."===this.peek().value?(this.next(),"{"===this.peek().value?this.parseObjectStmt():this.nextMatch(o.IDENTIFIER)):this.parseExpr(),")"===this.peek().value)break;this.peekMatch(",")}this.peekMatch(")"),"("===this.peek().value&&this.parseCallArgs()},p.prototype.parseDot=function(){var e=null;this.preToken.type!==o.NUMBER&&this.preToken.type!==o.BOOLEAN?(this.nextMatch("."),e=this.peek(),this.lexer.isDotAble(e)?(this.next(),e=this.peek(),"("===e.value&&this.parseCallArgs(),e=this.peek(),"["===e.value?this.parseProperty():"."===e.value&&this.parseDot()):u.expected(e,o.IDENTIFIER)):u.unexpected(this.next())},p.prototype.parseProperty=function(){var e=null;this.nextMatch("["),this.parseExprStmt(),this.nextMatch("]"),e=this.peek(),"("===e.value&&this.parseCallArgs(),e=this.peek(),"["===e.value?this.parseProperty():"."===e.value&&this.parseDot()};var d=new c,f=new p(d);return d.parser=f,{parse:function(e){var t=null;return clearTimeout(f.parseTimer),f.reset(e),f.parse(),t=u.errors.map((function(e){var t=e.line,i=e.column;return(!e.line||e.line>d.lines.length)&&(t=d.lines.length,i=d.lines.peek().length),{line:t,column:i,error:e.error}})).sort((function(e,t){return e.line===t.line?e.column-t.column:e.line-t.line})),console.log(t),t}}},$=function(){Array.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]},Array.prototype._isArray=!0,String.prototype.peek=function(e){if(this.length)return this[this.length-(e||1)]};var e=["{","}","[","]","(",")"],t={space:/^\s+/,tag:/^@?[a-zA-Z_\-][a-zA-Z0-9_\-]*/,propertyName:/^[\*]?[a-zA-Z_$][a-zA-Z0-9_\-$]*/,numValue:/^(?:\d+(?:\.\d*)?|\.\d+)(?:[sS%]|px|PX)?/,propertyValue:/^[+\-]?[a-zA-Z0-9_\-$%]+|^#[a-zA-Z0-9]+/,punctuator:/^[\+\-\*\~\,\:\;\.\#\=\!]/,comment:/\*\//,string1:/\\*'/,string2:/\\*"/,other:/^[\s\S]/},i=100;function n(e,t){this.type=e,this.label=t,this._isTokenType=!0}function s(e){this.type=e}function r(e,t,i){e=e||{},this.type=t,this.param=i,this.line=e.line,this.column=e.column,this.value=e.value,this.error=this.toString()}function a(){this.init()}function l(e){this.lexer=e,this.cacheList=[],this.backs=[],this.parseList=[],this.preToken=null,r.errors=[]}n.prototype.toString=function(){return this.label},n.STRING=new n(2,"string"),n.SELECTOR=new n(3,"selector"),n.PROPERTY=new n(4,"property"),n.VALUE=new n(5,"value"),n.NUM_VALUE=new n(6,"numValue"),n.BRACKET=new n(7,"bracket"),n.PUNCTUATOR=new n(8,"punctuator"),n.OTHER=new n(10,"other"),s.UNEXPECTED=new s(1),s.EXPECTED=new s(2),s.MISS=new s(3),s.UNMATCH=new s(4),r.prototype.toString=function(){var e="",t=this.param instanceof Array?this.param:[this.param];switch(t="".concat(1===t.length?"a ":"","'").concat(t.join("'、'"),"'"),this.type){case s.UNEXPECTED:e="unexpected '".concat(this.value,"'");break;case s.EXPECTED:e="expected ".concat(t),this.value&&(e+=" and instead saw '".concat(this.value,"'"));break;case s.MISS:e="missing ".concat(t),this.value&&(e+=" before '".concat(this.value,"'"));break;case s.UNMATCH:e="unmatched '".concat(this.value,"'");break}return e},r.push=function(e){r.errors.push(e)},r.expected=function(e,t){r.push(new r(e,s.EXPECTED,t))},r.unexpected=function(e){r.push(new r(e,s.UNEXPECTED))},r.unmatch=function(e){r.push(new r(e,s.UNMATCH))},a.prototype.init=function(){var t=this;r.errors=[],this.lines=[""],this.line=1,this.column=0,this.input="",this.bracketsMap=new Map,e.map((function(e){t.bracketsMap.set(e,!0)}))},a.prototype.reset=function(e){this.lines=e.texts,this.line=e.line||1,this.column=e.column||0,this.input=this.lines[this.line-1].slice(this.column)},a.prototype.skip=function(e){this.input=e?this.input.slice(e):this.input,this.column+=e},a.prototype.skipLine=function(e){this.line+=e,this.column=0,this.input=this.lines[this.line-1]||""},a.prototype.hasNext=function(){return!(r.errors.length>i)&&(this.line<this.lines.length||this.line==this.lines.length&&this.lines.peek().length>this.column)},a.prototype.isBracket=function(e){return this.bracketsMap.has(e)},a.prototype.isTokenType=function(e){return e._isTokenType},a.prototype.isProp=function(e){return e.type===n.SELECTOR||e.type===n.PROPERTY},a.prototype.isValue=function(e){return e.type===n.VALUE||e.type===n.NUM_VALUE||e.type===n.SELECTOR||e.type===n.PROPERTY||e.type===n.STRING},a.prototype.craeteToken=function(e,t){var i=this.line,n=this.column;return i>this.lines.length&&(i=this.lines.length,n=this.lines.peek().length),{type:t,line:i,column:n,value:e}},a.prototype.scanSpace=function(){var e=null;while(!this.input.length&&this.line<this.lines.length)this.skipLine(1);e=t.space.exec(this.input),e&&(this.skip(e.index+e[0].length),e.index>=this.input.length-1&&this.scanSpace())},a.prototype.scanComment=function(){var e=null,i=null,n=null,s=null;if(this.scanSpace(),i=this.input[0],n=this.input[1],"/"===i&&"*"===n){s=this.craeteToken("/*"),this.skip(2);while(this.hasNext()&&!(e=t.comment.exec(this.input)))this.skipLine(1);e?this.skip(e.index+e[0].length):r.unmatch(s)}},a.prototype.scanString=function(){var e=this,i=null,s=null,a=null;return"'"===this.input[0]?(a=this.craeteToken("'",n.STRING),this.skip(1),i=l(t.string1),s=this.craeteToken("'",n.STRING),i||(r.unmatch(a),this.skipLine(1)),s):'"'===this.input[0]?(a=this.craeteToken('"',n.STRING),this.skip(1),i=l(t.string2),s=this.craeteToken('"',n.STRING),i||(r.unmatch(a),this.skipLine(1)),s):s;function l(t){return!!e.hasNext()&&((i=t.exec(e.input))?(e.skip(i.index+i[0].length),i[0].length%2!==0||l(t)):(e.skipLine(1),l(t)))}},a.prototype.scanIdentifier=function(){var e=null,i=null;return(e=t.tag.exec(this.input))?(i=this.craeteToken(e[0],n.SELECTOR),this.skip(e.index+e[0].length)):(e=t.propertyName.exec(this.input))?(i=this.craeteToken(e[0],n.PROPERTY),this.skip(e.index+e[0].length)):(e=t.numValue.exec(this.input))?(i=this.craeteToken(e[0],n.NUM_VALUE),this.skip(e.index+e[0].length)):(e=t.propertyValue.exec(this.input))&&(i=this.craeteToken(e[0],n.VALUE),this.skip(e.index+e[0].length)),i},a.prototype.scanBracket=function(){var e=null,t=this.input[0];return this.isBracket(t)&&(e=this.craeteToken(t,n.BRACKET),this.skip(1)),e},a.prototype.scanPunctuator=function(){var e=null;return(exec=t.punctuator.exec(this.input))&&(e=this.craeteToken(exec[0],n.PUNCTUATOR),this.skip(exec.index+exec[0].length)),e},a.prototype.scanOther=function(){var e=null,i=null;return(e=t.other.exec(this.input))&&(i=this.craeteToken(e[0],n.OTHER),this.skip(e.index+e[0].length)),i},a.prototype.next=function(){var e=null;return this.scanComment(),this.hasNext()&&(e=this.scanIdentifier()||this.scanBracket()||this.scanString()||this.scanPunctuator(),!e)?(e=this.scanOther(),e&&r.unexpected(e),this.next()):(this.preToken=e,e)},l.prototype.reset=function(e){this.backs=[],this.parseList=[],this.preToken=null,this.recovery(e),r.errors=[]},l.prototype.cache=function(){this.cacheList.length&&this.cacheList.peek().line==this.lexer.line&&this.cacheList.pop(),this.preToken&&this.cacheList.push({line:this.preToken.line,column:this.preToken.column,parseList:this.parseList.slice(0)})},l.prototype.recovery=function(e){var t=0,i=e.split("\n")||[""],n=!1;while(t<i.length&&t<this.lexer.lines.length&&i[t]===this.lexer.lines[t])t++;if(t>0){for(var s=-1,r=0;r<this.cacheList.length;r++){if(!(this.cacheList[r].line<=t))break;s=r}if(s>-1){var a=this.cacheList[s];this.parseList=a.parseList,this.cacheList=this.cacheList.slice(0,s+1),this.lexer.reset({texts:i,line:a.line,column:a.column}),this.next(),n=!0}}n||(this.cacheList=[],this.lexer.reset({texts:i}))},l.prototype.match=function(e,t){for(var i=!1,n=0;n<t.length;n++)if(this.lexer.isTokenType(t[n])){if(t[n]===e.type){i=!0;break}}else if(t[n]===e.value){i=!0;break}return i},l.prototype.next=function(e){var t=null;e=e||1;while(e>0)t=this.backs.length?this.backs.shift():this.lexer.next(),this.pre2Token=this.preToken,this.preToken=t||this.preToken,e--;return this.puted=!1,t},l.prototype.nextMatch=function(e){var t=this.next()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i||(t.value&&this.match(this.peek(),e)?r.unexpected(t):r.expected(t,e)),i},l.prototype.peek=function(e){var t=null;if(e=e||1,this.backs.length&&(t=this.backs[e-1]),!t){e-=this.backs.length;while(e>0)e--,t=this.lexer.next(),t&&this.backs.push(t)}return t||{}},l.prototype.peekMatch=function(e){var t=this.peek()||{},i=!1;return e=e._isArray?e:[e],i=t.value&&this.match(t,e),i?this.next():t.value&&this.match(this.peek(),e)?r.unexpected(t):r.expected(t,e),i},l.prototype.hasNext=function(){var e=this.peek();return e.value},l.prototype.putBack=function(){this.preToken&&!this.puted&&(this.backs.unshift(this.preToken),this.preToken=this.pre2Token,this.puted=!0)},l.prototype.skipSemicolon=function(e){e=e||1/0;while(";"===this.peek().value&&e>0)this.next(),e--},l.prototype.parse=function(){var e=this,t=0,i=Date.now();while(this.hasNext())if(this.parseStmt(),!r.errors.length&&this.cache(),++t%10===0&&Date.now()-i>200){this.parseTimer=setTimeout((function(){e.parseStmt()}),10);break}},l.prototype.parseStmt=function(){var e=this.peek();"@import"!==e.value?"@charset"!==e.value?"@keyframes"!==e.value&&"@-webkit-keyframes"!==e.value?"@media"!==e.value?(this.parseSelector(),"{"===this.peek().value&&this.parseBlock()):this.parseMedia():this.parseKeyFrames():this.parseCharset():this.parseImport()},l.prototype.parseImport=function(){this.nextMatch("@import"),this.nextMatch(n.STRING),["all","print","screen","speech"].indexOf(this.peek().value)>-1&&this.parseMedia(!0),this.peekMatch(";")},l.prototype.parseCharset=function(){this.nextMatch("@charset"),this.nextMatch(n.STRING),this.peekMatch(";")},l.prototype.parseMedia=function(e){var t=null;!e&&this.nextMatch("@media"),t=this.peek(),"not"!==t.value&&"only"!==t.value||this.next(),this.nextMatch(["all","print","screen","speech"]);while(this.hasNext()){if(t=this.peek(),"and"!==t.value&&"or"!==t.value)break;this.next(),this.nextMatch("("),t=this.next()||{},this.lexer.isProp(t)||r.expected(t,n.PROPERTY),")"!=this.peek().value&&(this.peekMatch(":"),t=this.next()||{},this.lexer.isValue(t)||r.expected(t,n.VALUE),this.peekMatch(")"))}e||(this.peekMatch("{"),this.parseStmt(),this.peekMatch("}"))},l.prototype.parseKeyFrames=function(){var e=null;this.nextMatch(["@keyframes","@-webkit-keyframes"]),e=this.next(),e.type!==n.SELECTOR&&r.expected(e,"name"),this.peekMatch("{");while(this.hasNext()){if("}"===this.peek().value)break;this.nextMatch(n.NUM_VALUE),this.parseBlock()}this.peekMatch("}")},l.prototype.parseSelector=function(){var e=this.next()||{};"."===e.value||"#"===e.value?this.nextMatch(n.SELECTOR):"["===e.value?(this.nextMatch(n.SELECTOR),"]"!==this.peek().value?(this.nextMatch("="),e=this.peek(),this.lexer.isValue(e)?this.next():r.expected(e,"value"),this.peekMatch("]")):this.next()):":"===e.value?(":"===this.peek().value&&this.next(),this.nextMatch(n.SELECTOR),"("===this.peek().value&&(this.next(),this.parseSelector(),this.peekMatch(")"))):"*"!==e.value&&(this.putBack(),this.nextMatch(n.SELECTOR)),this.hasNext()&&"{"!==this.peek().value&&(e=this.peek(),("+"===e.value||"~"===e.value||","===e.value)&&this.next(),this.parseSelector())},l.prototype.parseBlock=function(){var e=this;this.nextMatch("{");while(this.hasNext()){if("}"===this.peek().value)break;t(),this.peekMatch(":"),i(),"}"!==this.peek().value&&this.peekMatch(";")}function t(){var t=e.next();t.type!==n.SELECTOR&&t.type!==n.PROPERTY&&r.expected(n.PROPERTY)}function i(){var t=!1;while(e.hasNext()){var s=e.peek();if(";"===s.value||"}"===s.value||")"===s.value)break;if(s=e.next(),e.lexer.isValue(s))t=!0;else if("("===s.value){var a=1;while(e.hasNext()&&a){var l=e.next()||{};")"===l.value?a--:"("===l.value&&a++}a&&e.peekMatch(")")}else{if(t&&","===s.value){i();break}if(t&&"!"===s.value){e.peekMatch("important");break}r.expected(s,n.VALUE)}}return t||r.expected(null,n.VALUE),t}this.peekMatch("}")};var o=new a,h=new l(o);return o.parser=h,{parse:function(e){var t=null;return clearTimeout(h.parseTimer),h.reset(e),h.parse(),t=r.errors.map((function(e){var t=e.line,i=e.column;return(!e.line||e.line>o.lines.length)&&(t=o.lines.length,i=o.lines.peek().length),{line:t,column:i,error:e.error}})).sort((function(e,t){return e.line===t.line?e.column-t.column:e.line-t.line})),console.log(t),t}}};function U(){var e={js:/(?<!\<[^\>]*?['"][^\>]*?)(\<script(?:\s[^\>]*?)?\>)([\s\S]*?)\<\/script\>/,css:/(?<!\<[^\>]*?['"][^\>]*?)(\<style(?:\s[^\>]*?)?\>)([\s\S]*?)\<\/style\>/,enter:/\n/g,column:/\n([^\n]+)$/,comment:/\<\!--[\s\S]*?--\>/};function t(){}t.prototype.reset=function(e){this.text=e,this.comments=[]},t.prototype.parseComentRange=function(){var t=null,i={line:1,column:0,index:0},n=this.text,s=null,r=null;while(t=e.comment.exec(n))this.setLineColumn(n.slice(0,t.index),i),i.index+=t.index,s=Object.assign({},i),this.setLineColumn(t[0],i),i.index+=t[0].length,r=Object.assign({},i),n=this.text.slice(i.index),this.comments.push({start:s,end:r})},t.prototype.setLineColumn=function(t,i){var n=t.match(e.enter);if(n=n&&n.length||0,i.line+=n,n){var s=e.column.exec(t);i.column=s&&s[1].length||0}else i.column+=t.length},t.prototype.parse=function(){return this.parseComentRange(),i.parseJs().concat(i.parseCss())},t.prototype.parseJs=function(){var t=jsParser().parse;return this._parse(e.js,t)},t.prototype.parseCss=function(){var t=cssParser().parse;return this._parse(e.css,t)},t.prototype._parse=function(e,t){var i=null,n={line:1,column:0,index:0},s=this.text,r=[];while(i=e.exec(s))if(this.setLineColumn(s.slice(0,i.index),n),n.index+=i.index,this.checkInComment(n)){if(this.setLineColumn(i[1],n),n.index+=i[1].length,i[2]){var a=t(i[2]);a.map((function(e){1==e.line&&(e.column+=n.column),e.line+=n.line-1})),r=r.concat(a)}this.setLineColumn(i[0].slice(i[1].length),n),n.index+=i[0].slice(i[1].length).length,s=this.text.slice(n.index)}else s=this.text.slice(n.index);return r},t.prototype.checkInComment=function(e){for(var t=0;t<this.comments.length;t++){var i=this.comments[t];if(n(i.start,e)<0&&n(i.end,e)>0)return e.line=i.end.line,e.column=i.end.column,e.index=i.end.index,!1}return!0;function n(e,t){return e.line===t.line?e.column-t.column:e.line-t.line}};var i=new t;return{parse:function(e){var t=null;return i.reset(e),t=i.parse(),t.sort((function(e,t){return e.line===t.line?e.column-t.column:e.line-t.line})),t}}}var X=new Function("function jsParser()".concat(V.toString().replace(/^[^\)]+?\)/,""),"\nfunction cssParser()").concat($.toString().replace(/^[^\)]+?\)/,""),"\nfunction htmlParser()").concat(U.toString().replace(/^[^\)]+?\)/,""),"\nreturn htmlParser();\n")),G=function(){function e(t,i){Object(g["a"])(this,e),this.parseId=1,this.initProperties(t,i),this.initLanguage(t.language)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){z.defineProperties(this,t,["htmls"]),z.defineProperties(this,e,["setErrorMap"])}},{key:"initLanguage",value:function(e){var t=this;if(this.language!==e){switch(this.language=e,this.worker&&this.worker.terminate(),this.worker=null,this.setErrorMap({}),e){case"HTML":this.worker=this.createWorker(X);break;case"JavaScript":this.worker=this.createWorker(V);break;case"CSS":this.worker=this.createWorker($);break}this.worker&&(this.worker.onmessage=function(e){var i=e.data.parseId,n=e.data.errors,s=0,r={};if(t.parseId==i){while(s<n.length){var a=n[s].line,l=[];while(s<n.length&&n[s].line===a)l.push(n[s].error),s++;a=a||t.htmls.length,r[a]=l.join("<br>")}t.setErrorMap(r)}},this.parse())}}},{key:"createWorker",value:function(e){var t=e.toString().replace(/^[^\)]+?\)/,""),i="function fun()".concat(t,"\n            let parser = fun();\n            self.onmessage = function(e) {\n                var parseId = e.data.parseId;\n                var errors = parser.parse(e.data.text);\n                self.postMessage({\n                    errors: errors,\n                    parseId: parseId\n                });\n            }");return z.createWorker(i)}},{key:"onInsertContentBefore",value:function(e){}},{key:"onInsertContentAfter",value:function(e){var t=this;this.worker&&(clearTimeout(this.parseTimer),this.parseTimer=setTimeout((function(){t.parse()}),300))}},{key:"onDeleteContentBefore",value:function(e){}},{key:"onDeleteContentAfter",value:function(e){var t=this;this.worker&&(clearTimeout(this.parseTimer),this.parseTimer=setTimeout((function(){t.parse()}),300))}},{key:"parse",value:function(){var e=this.htmls.map((function(e){return e.text})).join("\n");this.parseId++,this.worker.postMessage({text:e,parseId:this.parseId})}}]),e}(),K=function(){function e(t,i){Object(g["a"])(this,e),this.editorFunObj={},this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){z.defineProperties(this.editorFunObj,e,["unFold"]),z.defineProperties(this,e,["selectedRange"]),z.defineProperties(this,t,["htmls","folds","foldMap"])}},{key:"onInsertContentBefore",value:function(e){var t=this;if(this.folds.length){var i=this.findFoldIndex(e),n=[];while(i<this.folds.length&&this.folds[i].start.line<e&&this.folds[i].end.line>e)n.push(this.folds[i].start.line),i++;n.map((function(e){t.editorFunObj.unFold(e)}))}}},{key:"onInsertContentAfter",value:function(e){}},{key:"onDeleteContentBefore",value:function(e){if(this.selectedRange)for(var t=this.selectedRange.start,i=this.selectedRange.end,n=t.line;n<i.line;n++)this.editorFunObj.unFold(n)}},{key:"onDeleteContentAfter",value:function(e){var t=this;if(this.folds.length){var i=this.findFoldIndex(e),n=[];while(i<this.folds.length&&this.folds[i].start.line<e&&this.folds[i].end.line>e)n.push(this.folds[i].start.line),i++;n.map((function(e){t.editorFunObj.unFold(e)}))}}},{key:"findFoldIndex",value:function(e){var t=0,i=this.folds.length-1;while(t<i){var n=Math.floor((t+i)/2),s=this.folds[n];s.start.line<e?s.end.line<=e?t=n+1:i=n:s.start.line==e?t=n+1:i=n-1}return t}},{key:"foldLine",value:function(e){var t=e,i=this.getRangeFold(e);if(i){for(var n=i.start.line;n<i.end.line;n++)this.foldMap.has(n)&&this.foldMap.get(n).end.line>i.end.line&&this.unFold(n);this.foldMap.set(t,i),this.folds.push(i),this.folds.sort((function(e,t){return e.start.line-t.start.line}))}return i}},{key:"unFold",value:function(e){var t=0,i=this.folds.length;if(!this.foldMap.has(e))return!1;while(t<=i){var n=Math.floor((t+i)/2);if(this.folds[n].start.line==e){this.folds.splice(n,1);break}this.folds[n].start.line>e?i=n-1:t=n+1}return this.foldMap.delete(e),!0}},{key:"getRangeFold",value:function(e,t){var i=[],n=e,s=this.htmls[n-1],r=null;if(e++,s.folds&&s.folds.length)for(var a=0;a<s.folds.length;a++){var l=s.folds[a];-1==l.type&&(i.length&&i.peek().name!=l.name||i.push(l))}while(i.length&&e<=this.htmls.length&&(!t||e-n<=1)){if(s=this.htmls[e-1],s.folds&&s.folds.length)for(var o=0;o<s.folds.length;o++){var h=s.folds[o];if(-1==h.type)i.peek().name==h.name&&i.push(h);else if(i.peek().name==h.name){if(1==i.length){if(t)return e-n>1;r={start:{line:n,start:i.peek().start},end:{line:e,end:h.end},name:h.name},i.pop();break}i.pop()}}e++}return t?e-n>1:r}},{key:"getRealLine",value:function(e){var t=0,i=1,n=1;while(t<this.folds.length&&i<e){var s=this.folds[t];if(!(i+s.start.line-n<e))break;i+=s.start.line+1-n,n=s.end.line,t++;while(t<this.folds.length&&this.folds[t].end.line<=s.end.line)t++}return n+=e-i,n}},{key:"getRelativeLine",value:function(e){var t=e,i=0;while(i<this.folds.length){var n=this.folds[i];if(!(e>=n.end.line))break;t-=n.end.line-n.start.line-1,i++;while(i<this.folds.length&&this.folds[i].end.line<=n.end.line)i++}return t}}]),e}(),Y={enter:/\n/g,column:/\n([^\n]+)$/},Z=function(){function e(t,i){Object(g["a"])(this,e),this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){z.defineProperties(this,e,["selecter","nowCursorPos"]),z.defineProperties(this,t,["htmls"])}},{key:"search",value:function(e,t){var i=this.checkCache(e);if(i)return i;var n=null,s=null,r=null,a=null,l=null,o=[],h=null,u=null,c={line:1,column:0,index:0},p=context.htmls.map((function(e){return e.text})).join("\n"),d=p,f=e.replace(/\\|\.|\*|\+|\-|\?|\(|\)|\[|\]|{|\}|\^|\$|\~|\!/g,"\\$&");f=(t.wholeWord?"\\b":"")+f+(t.wholeWord?"\\b":""),t=t||{},n=new RegExp(f,t.ignoreCase?"i":"");while(s=n.exec(p))this.setLineColumn(p.slice(0,s.index),c),c.index+=s.index,r=Object.assign({},c),this.setLineColumn(s[0],c),c.index+=s[0].length,a=Object.assign({},c),p=d.slice(c.index),u={start:r,end:a},h=h||u,!l&&z.comparePos(a,this.nowCursorPos)>=0&&!this.selecter.checkCursorSelected(r)&&(l=u),o.push(u);return l||!h||this.selecter.checkCursorSelected(h.start)||(l=h),this.cache(e,o,l),{list:z.deepAssign([],o),result:z.deepAssign({},l)}}},{key:"checkCache",value:function(e){if(this.cacheData&&this.cacheData.str===e){for(var t=this.cacheData.list,i=null,n=0;n<t.length;n++){var s=t[n];if(z.comparePos(s.end,this.cacheData.result.end)>0){i=s;break}}return i||(i=t[0]),this.cacheData.result=i,{list:z.deepAssign([],t),result:z.deepAssign({},i)}}}},{key:"cache",value:function(e,t,i){this.cacheData={str:e,list:t,result:i}}},{key:"clearCache",value:function(){this.cacheData=null}},{key:"setLineColumn",value:function(e,t){var i=e.match(Y.enter);if(i=i&&i.length||0,t.line+=i,i){var n=Y.column.exec(e);t.column=n&&n[1].length||0}else t.column+=e.length}}]),e}(),J=i("2909"),q=function(){function e(t,i){Object(g["a"])(this,e),this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){z.defineProperties(this,e,["selectedRanges","renderSelectedBg","moveCursor","multiCursorPos"]),z.defineProperties(this,t,["htmls"])}},{key:"select",value:function(e,t){var i=this;this.multiCursorPos.map((function(n){var s=i.checkCursorSelected(n);if(s)i.moveCursor(n,e,t),z.comparePos(n,s.start)<0||z.comparePos(n,s.end)<0&&"right"===e?(s.start.line=n.line,s.start.column=n.column):(s.end.line=n.line,s.end.column=n.column);else{var r=Object.assign({},n);n=i.moveCursor(n,e,t),i.addSelectedRange(r,n)}})),this.filterSelectedRanges(),this.renderSelectedBg()}},{key:"addSelectedRange",value:function(e,t){var i=!1,n=z.comparePos(e,t);if(n>0){var s=e;e=t,t=s}else if(!n)return;this.selectedRanges.filter((function(i){return 0==z.comparePos(e,i.start)&&0==z.comparePos(t,i.end)})).length>0||(i=this.checkSelectedCursor({start:e,end:t}),this.selectedRanges.push({active:i,start:Object.assign({},e),end:Object.assign({},t)}),this.filterSelectedRanges())}},{key:"checkActive",value:function(e){var t=this.checkCursorSelected(e);t&&(t.active=!0)}},{key:"checkCursorSelected",value:function(e){for(var t=0;t<this.selectedRanges.length;t++){var i=this.selectedRanges[t];if(z.comparePos(e,i.start)>=0&&z.comparePos(e,i.end)<=0)return i}return!1}},{key:"checkSelectedCursor",value:function(e){if(e.start.line!==e.end.line)return!0;for(var t=0;t<this.multiCursorPos.length;t++){var i=this.multiCursorPos[t];if(z.comparePos(i,e.start)>=0&&z.comparePos(i,e.end)<=0)return i}return!1}},{key:"filterSelectedRanges",value:function(){var e,t=this.checkCursorSelected(this.selectedRanges[0].start),i=new Map,n=this.selectedRanges[0];t=t?"left":"right";for(var s=1;s<this.selectedRanges.length;s++){var r=this.selectedRanges[s];z.comparePos(n.end,r)>=0?(n.end=r.end,r.del=!0,"left"===t?i.set(r.start.line+","+r.start.column,!0):i.set(r.end.line+","+r.end.column,!0)):n=r}var a=this.selectedRanges.slice();if(this.selectedRanges.empty(),(e=this.selectedRanges.empty()).push.apply(e,Object(J["a"])(a.filter((function(e){return!e.del&&z.comparePos(e.start,e.end)<0})))),i.size){var l,o=this.multiCursorPos.slice();(l=this.multiCursorPos.empty()).push.apply(l,Object(J["a"])(o.filter((function(e){return!i.has(e.line+","+e.column)}))))}}}]),e}(),Q=function(){function e(t,i){Object(g["a"])(this,e),this.initProperties(t,i)}return Object(k["a"])(e,[{key:"initProperties",value:function(e,t){z.defineProperties(this,e,["insertContent","deleteContent","clearCursorPos","addCursorPos","setSelectedRange"]),z.defineProperties(this,t,["history"])}},{key:"undo",value:function(){if(this.history.index>0){var e=this.history[this.history.index-1];this.doCommand(e),this.history.index--}}},{key:"redo",value:function(){if(this.history.index<this.history.length){var e=this.history[this.history.index];this.history.index++,this.doCommand(e)}}},{key:"doCommand",value:function(e){var t=e instanceof Array?e[0].type:e.type;switch(this.clearCursorPos(),t){case z.command.DELETE:if(e instanceof Array){var i=e.map((function(e){return{start:e.preCursorPos,end:e.cursorPos}}));this.deleteContent(z.keyCode.BACKSPACE,i)}else this.deleteContent(z.keyCode.BACKSPACE,{start:e.preCursorPos,end:e.cursorPos});break;case z.command.INSERT:if(e instanceof Array){var n=[],s=[];e.map((function(e){n.push(e.text),s.push(e.cursorPos)})),this.insertContent(n,s)}else this.insertContent(e.text,Object.assign({},e.cursorPos));break}}},{key:"pushHistory",value:function(e){while(this.history.length>this.history.index)this.history.pop();var t=this,i=this.history[this.history.index-1];if(e=this.sortComand(e),i instanceof Array&&e instanceof Array&&i.length===e.length&&Date.now()-this.pushHistoryTime<2e3)if(r(i.peek(),e.peek())){var n=e.peek();i.map((function(e){l(e.preCursorPos,n.preCursorPos,n.cursorPos)}));for(var s=0;s<i.length;s++)a(i[s],e[s])}else this.history.push(e);else r(i,e)?a(i,e):this.history.push(e);function r(e,i){if(e&&e.type&&e.type==i.type&&i.preCursorPos.line==i.cursorPos.line&&0==z.comparePos(e.cursorPos,i.preCursorPos)&&Date.now()-t.pushHistoryTime<2e3)return!0}function a(e,t){e.type===z.command.DELETE||(e.text=t.text+e.text),e.cursorPos=t.cursorPos}function l(e,t,i){e.line>t.line?e.line+=i.line-t.line:e.line===t.line&&e.column>t.column&&(e.line+=i.line-t.line,e.column+=i.column-t.column)}this.history.index=this.history.length,this.pushHistoryTime=Date.now()}},{key:"updateHistory",value:function(e,t){this.history[e-1]=this.sortComand(t)}},{key:"sortComand",value:function(e){return e instanceof Array&&e.sort((function(e,t){return e=e.cursorPos,t=t.cursorPos,e.line===t.line?t.column-e.column:t.line-e.line})),e}}]),e}(),ee=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-editor-status-bar",style:{height:e.height+"px"},on:{contextmenu:function(e){e.stopPropagation(),e.preventDefault()}}},[i("div",{staticClass:"my-editor-status-left"},[i("div",{staticClass:"my-editor-status-item"},[i("span",[e._v("Line "+e._s(e.line)+", Column "+e._s(e.column))])])]),i("div",{staticClass:"my-editor-status-right"},[i("div",{staticClass:"my-editor-status-item clickable",on:{mousedown:function(t){return t.stopPropagation(),e.showTabsize.apply(null,arguments)}}},[i("span",[e._v("Tab Size:"+e._s(e._tabSize))]),i("panel",{directives:[{name:"show",rawName:"v-show",value:e.tabsizeVisible,expression:"tabsizeVisible"}],attrs:{menuList:e.tabSizeList,styles:{right:0,bottom:e.height+"px"}},on:{change:e.onTabsizeChange}})],1),i("div",{staticClass:"my-editor-status-item clickable",on:{mousedown:function(t){return t.stopPropagation(),e.showLanguage.apply(null,arguments)}}},[i("span",[e._v(e._s(e._language))]),i("panel",{directives:[{name:"show",rawName:"v-show",value:e.languageVisible,expression:"languageVisible"}],attrs:{menuList:e.languageList,styles:{right:0,bottom:e.height+"px"}},on:{change:e.onLnaguageChange}})],1)])])},te=[],ie=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-editor-panel",style:e.styles,on:{mousedown:function(e){e.stopPropagation()}}},e._l(e.menuList,(function(t){return i("div",{staticClass:"my-editor-menu-group"},e._l(t,(function(n){return i("div",{staticClass:"my-editor-menu-item",class:{checked:e.checkable&&n.checked,disabled:n.disabled},on:{mousedown:function(i){return e.onClick(n,t)}}},[i("div",{staticClass:"my-editor-menu-content"},[e._v(e._s(n.name))]),n.shortcut?i("div",{staticClass:"my-editor-menu-shortcut"},[e._v(e._s(n.shortcut))]):e._e()])})),0)})),0)},ne=[],se={name:"Panel",props:{menuList:{type:Array,default:[]},styles:{type:Object},checkable:{type:Boolean,default:!0}},data:function(){return{}},created:function(){},methods:{onClick:function(e,t){e.disabled||(t.map((function(e){e.checked=!1})),e.checked=!0,this.$emit("change",e))}}},re=se,ae=Object(o["a"])(re,ie,ne,!1,null,null,null),le=ae.exports,oe={name:"StatusBar",props:{height:{type:Number,default:25},line:{type:Number,default:1},column:{type:Number,default:1},language:{type:String,default:"JavaScript"},tabSize:{type:Number,default:4}},components:{Panel:le},data:function(){return{_tabSize:0,_language:"",tabsizeVisible:!1,languageVisible:!1,tabSizeList:[[]],languageList:[[{name:"JavaScript"},{name:"HTML"},{name:"CSS"}]]}},created:function(){for(var e=1;e<=8;e++)this.tabSizeList[0].push({name:"Tab Width：".concat(e),size:e});this._tabSize=this.tabSize,this._language=this.language,this.setDefault()},methods:{setDefault:function(){var e=this;this.tabSizeList[0].map((function(t){t.checked=t.size==e._tabSize})),this.languageList[0].map((function(t){t.checked=t.name==e._language}))},showTabsize:function(){var e=this.tabsizeVisible;this.closeAllPanel(),this.tabsizeVisible=!e},showLanguage:function(){var e=this.languageVisible;this.closeAllPanel(),this.languageVisible=!e},closeAllPanel:function(){this.languageVisible=!1,this.tabsizeVisible=!1},onTabsizeChange:function(e){this._tabSize!=e.size&&(this._tabSize=e.size,this.$emit("update:tabSize",e.size)),this.tabsizeVisible=!1},onLnaguageChange:function(e){this._language!=e.name&&(this._language=e.name,this.$emit("update:language",e.name)),this.languageVisible=!1}}},he=oe,ue=Object(o["a"])(he,ee,te,!1,null,null,null),ce=ue.exports,pe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-editor-tip",style:e.styles,on:{mousedown:function(e){e.stopPropagation()}}},[i("div",{domProps:{innerHTML:e._s(e.content)}})])},de=[],fe={name:"Tip",props:{content:String,styles:{type:Object}},data:function(){return{}},created:function(){},methods:{}},me=fe,ge=Object(o["a"])(me,pe,de,!1,null,null,null),ke=ge.exports,ve={htmls:[],folds:[],history:[],lineIdMap:new Map,renderedIdMap:new Map,foldMap:new Map},xe={word:/[a-zA-Z0-9_]/},ye={name:"Home",components:{StatusBar:ce,Panel:le,Tip:ke},data:function(){return Object(f["a"])({charObj:{charWidth:7.15,fullAngleCharWidth:15,charHight:19},nowCursorPos:{line:1,column:0,top:0,left:0},multiCursorPos:[],cursorVisible:!0,cursorFocus:!0,language:"HTML",statusHeight:23,tabSize:4,renderHtmls:[],startLine:1,startToEndToken:null,top:0,scrollLeft:0,scrollTop:0,maxVisibleLines:1,maxLine:1,scrollerHeight:"auto",scrollerArea:{},selectedRanges:[],maxWidthObj:{lineId:null,text:"",width:0},menuList:[[{name:"Cut",op:"cut",shortcut:"Ctrl+X"},{name:"Copy",op:"copy",shortcut:"Ctrl+C"},{name:"Paste",op:"paste",shortcut:"Ctrl+V"}]],menuStyle:{top:"0px",left:"0px","min-width":"200px"},tipStyle:{top:"0px",left:"0px"},errorMap:{},menuVisble:!1,tipContent:!1},"tipContent","")},computed:{_numTop:function(){return this.top-this.charObj.charHight+"px"},_leftShadow:function(){return this.scrollLeft?"17px 0 16px -16px rgba(0, 0, 0, 0.8) inset":"none"},_top:function(){return this.top+"px"},_lineHeight:function(){return this.charObj.charHight+"px"},_statusHeight:function(){return this.statusHeight+4+"px"},_cursorVisible:function(){return this.cursorVisible&&this.cursorFocus?"visible":"hidden"},_hScrollWidth:function(){return this._contentMinWidth},_contentMinWidth:function(){var e=0;return this.$content&&(e=z.getStrExactWidth(this.maxWidthObj.text,this.tabSize,this.$content),e+=this.charObj.fullAngleCharWidth),e=this.scrollerArea.width>e?this.scrollerArea.width:e,e+"px"},_textAreaPos:function(){var e=0,t=this.top;if(this.multiCursorPos.length){var i=this.multiCursorPos.slice().sort((function(e,t){return e.top-t.top}))[0];e=z.getNum(i.left),t=z.getNum(i.top)+this.top,e-=this.scrollLeft,e=e<this.charObj.charWidth?this.charObj.charWidth:e,e=e>this.scrollerArea.width-this.charObj.charWidth?this.scrollerArea.width-this.charObj.charWidth:e,t+=this.charObj.charHight,t>this.scrollerArea.height-2*this.charObj.charHight&&(t=this.scrollerArea.height-2*this.charObj.charHight)}return{top:t+"px",left:e+"px"}},_startBgLineVisible:function(){return function(e,t){return t==e.start.line}},_endBgLineVisible:function(){return function(e,t){return t==e.end.line&&e.end.line>e.start.line}},_tabLineLeft:function(){var e=this;return function(t){return(t-1)*e.tabSize*e.charObj.charWidth+"px"}},_activeLine:function(){var e=this;return function(t){return 1===e.multiCursorPos.length&&e.nowCursorPos.line==t}},space:function(){return z.space(this.tabSize)}},watch:{language:function(e){ve.htmls.map((function(e){e.tokens=null,e.folds=null,e.states=null,e.html=""})),this.render(),this.tokenizer.initLanguage(e),this.tokenizer.tokenizeVisibleLins(),this.tokenizer.tokenizeLines(1),this.lint.initLanguage(e)},tabSize:function(e){this.render(),this.maxWidthObj={lineId:null,text:"",width:0},this.setLineWidth(ve.htmls)},maxLine:function(e){this.setScrollerHeight()}},created:function(){window.editor=this,window.context=ve,this.initData(),this.initEvent()},mounted:function(){this.$editor=this.$refs.editor,this.$scroller=this.$refs.scroller,this.$content=this.$refs.content,this.$textarea=this.$refs.textarea,this.$vScroller=this.$refs.vScroller,this.$hScroller=this.$refs.hScroller,this.charObj=z.getCharWidth(this.$content),this.maxVisibleLines=Math.ceil(this.$scroller.clientHeight/this.charObj.charHight)+1,this.render(),this.focus()},methods:{initData:function(){this.lineId=Number.MIN_SAFE_INTEGER,ve.htmls.push({lineId:this.lineId++,text:"",html:"",width:0,tokens:[],folds:[],states:[]}),ve.lineIdMap.set(ve.htmls[0].lineId,ve.htmls[0]),this.maxWidthObj.lineId=ve.htmls[0].lineId,this.multiCursorPos.push(this.nowCursorPos),this.tokenizer=new H(this,ve),this.lint=new G(this,ve),this.folder=new K(this,ve),this.history=new Q(this,ve),this.searcher=new Z(this,ve),this.selecter=new q(this,ve)},initEvent:function(){var e=this;B()(document).on("mousemove",(function(t){e.onScrollerMmove(t)})),B()(document).on("mouseup",(function(t){e.onScrollerMup(t)}))},showCursor:function(){var e=this;if(this.cursorFocus=!0,this.multiCursorPos.length){if(!this.showCursor.show){this.showCursor.show=!0,this.cursorVisible=!0;var t=function t(){clearTimeout(e.curserTimer),e.curserTimer=setTimeout((function(){e.cursorVisible=!e.cursorVisible,t()}),500)};t()}}else this.showCursor.show=!1},hideCursor:function(){clearTimeout(this.curserTimer),this.showCursor.show=!1,this.cursorFocus=!1},focus:function(){var e=this;this.$textarea.focus(),setTimeout((function(){setTimeout((function(){e.$textarea.focus()}),100)}),100)},render:function(){var e=this;this.renderLine(),this.$nextTick((function(){e.scrollerArea={height:e.$scroller.clientHeight,width:e.$scroller.clientWidth}}))},renderLine:function(e){var t=this;if(e){if(ve.renderedIdMap.has(e)){var i=ve.lineIdMap.get(e),n=ve.renderedIdMap.get(e);Object.assign(n,u(i,n.num))}}else{ve.renderedIdMap.clear(),this.renderHtmls=[];for(var s=0,r=this.startLine;s<this.maxVisibleLines&&r<=ve.htmls.length;s++){var a=ve.htmls[r-1],l=a.lineId,o=u(a,r);if(this.renderHtmls.push(o),ve.renderedIdMap.set(l,o),ve.foldMap.has(r)){var h=ve.foldMap.get(r);r=h.end.line}else r++}}function u(e,i){var n=!1,s=/^\s+/.exec(e.text),r=0,a="";s&&(r=/\t+/.exec(s[0]),r=r&&r[0].length||0,r+=Math.ceil((s[0].length-r)/t.tabSize));for(var l=0;l<t.selectedRanges.length;l++){var o=t.selectedRanges[l];o&&i>o.start.line&&i<o.end.line&&(n=!0)}ve.foldMap.has(i)?a="close":t.folder.getRangeFold(i,!0)&&(a="open");var h=e.html||z.htmlTrans(e.text);return h=h.replace(/\t/g,t.space),{html:h,num:i,tabNum:r,selected:n,fold:a}}},renderSelectedBg:function(){var e=this;this.selectedRanges.length&&this.selectedRanges.map((function(t){e._renderSelectedBg(t)}))},_renderSelectedBg:function(e){var t=e.start,i=e.end,n=ve.htmls[t.line-1].text;t.left=this.getStrWidth(n,0,t.column),t.line==i.line?t.width=this.getStrWidth(n,t.column,i.column):(t.width=this.getStrWidth(n,t.column),i.left=0,n=ve.htmls[i.line-1].text,i.width=this.getStrWidth(n,0,i.column),this.renderHtmls.map((function(e){e.selected=e.num>t.line&&e.num<i.line}))),e.start=t,e.end=i},clearRange:function(e){this.searcher.clearCache(),this.search.stopSearch=!1,this.search.searchText="",this.selectedRanges.length&&(this.selectedRanges=e?this.selectedRanges.filter((function(t){return!(z.comparePos(e,t.start)>=0&&z.comparePos(e,t.end)<=0)})):[],this.renderLine())},insertContent:function(e,t){var i=this,n=[];if(this.selectedRanges.length&&this.deleteContent(),t)e instanceof Array?e.map((function(s,r){var a=i.addCursorPos(t[r]),l=i._insertContent(a,e[r]);n.push(l)})):(t=this.addCursorPos(t),n=this._insertContent(t,e));else if(this.multiCursorPos.length>1){var s=e instanceof Array?e:e.split(/\r\n|\n/);s.length===this.multiCursorPos.length?this.multiCursorPos.map((function(e,t){var r=i._insertContent(e,s[t]);n.push(r)})):this.multiCursorPos.map((function(t){var s=i._insertContent(t,e);n.push(s)})),this.nowCursorPos=this.multiCursorPos[0]}else n=this._insertContent(this.multiCursorPos[0],e);t?this.history.updateHistory(ve.history.index,n):this.history.pushHistory(n)},_insertContent:function(e,t){var i=this,n=ve.htmls[e.line-1].text,s=(e.line,e.column,e.column),r=e.line,a=r,l=s;this.tokenizer.onInsertContentBefore(r),this.lint.onInsertContentBefore(r),this.folder.onInsertContentBefore(r),t=t.split(/\r\n|\n/),t=t.map((function(e){return e={lineId:i.lineId++,text:e,html:"",width:0,tokens:null,folds:null,states:null},ve.lineIdMap.set(e.lineId,e),e})),t.length>1?(l=t[t.length-1].text.length,t[0].text=n.slice(0,s)+t[0].text,t[t.length-1].text=t[t.length-1].text+n.slice(s),ve.htmls=ve.htmls.slice(0,e.line-1).concat(t).concat(ve.htmls.slice(e.line))):(l+=t[0].text.length,t[0].text=n.slice(0,s)+t[0].text+n.slice(e.column),ve.htmls.splice(e.line-1,1,t[0])),a+=t.length-1,this.maxLine=ve.htmls.length,this.render(),this.tokenizer.onInsertContentAfter(a),this.lint.onInsertContentAfter(a),this.folder.onInsertContentAfter(a),this.setLineWidth(t),ve.foldMap.has(r)&&t.length>1&&this.unFold(r),this.updateCursorPos(e,a,l,!0);var o={type:z.command.DELETE,cursorPos:{line:a,column:l},preCursorPos:{line:r,column:s}};return o},deleteContent:function(e,t){var i=this,n=[],s=null;t?(t=t instanceof Array?t:[t],t.map((function(t){i.selecter.addSelectedRange(t.start,t.end),s=i.addCursorPos(t.end);var r=i._deleteContent(s,e);r.text&&n.push(r)}))):(this.multiCursorPos.map((function(t){var s=i._deleteContent(t,e);s.text&&n.push(s)})),this.nowCursorPos=this.multiCursorPos[0]),n=n.length>1?n:n[0],t?this.history.updateHistory(ve.history.index,n):n&&this.history.pushHistory(n)},_deleteContent:function(e,t){var i=null,n=ve.htmls[e.line-1],s=n.text,r={line:e.line,column:e.column},a="",l=[],o=e.line,h=e.column,u=this.selecter.checkCursorSelected(e);if(this.tokenizer.onDeleteContentBefore(e.line),this.lint.onDeleteContentBefore(e.line),this.folder.onDeleteContentBefore(e.line),u){var c=u.end,p=ve.htmls[c.line-1];i=u.start,n=ve.htmls[i.line-1],r={line:c.line,column:c.column},s=n.text,a=this.getRangeText(u.start,u.end),1==i.line&&c.line==this.maxLine?(l=[this.maxWidthObj.lineId],ve.lineIdMap.clear()):l=ve.htmls.slice(i.line-1,c.line).map((function(e){return ve.lineIdMap.delete(e.lineId),e.lineId})),ve.lineIdMap.set(n.lineId,n),i.line==c.line?(s=s.slice(0,i.column)+s.slice(c.column),n.text=s):(s=s.slice(0,i.column),n.text=s,s=p.text,s=s.slice(c.column),n.text+=s,ve.htmls.splice(i.line,c.line-i.line)),o=i.line,h=i.column,this.clearRange(e)}else if(z.keyCode.DELETE==t)e.column==s.length?e.line<ve.htmls.length&&(ve.lineIdMap.delete(ve.htmls[e.line].lineId),s=n.text+ve.htmls[e.line].text,ve.htmls.splice(e.line,1),a="\n",this.multiCursorPos.map((function(t){t.line>e.line&&(t.line===e.line+1&&(0===t.column?t.column=e.column:t.column--),t.line--)}))):(a=s[e.column],s=s.slice(0,e.column)+s.slice(e.column+1),this.multiCursorPos.map((function(t){t.line===e.line&&t.column>e.column&&t.column--}))),n.text=s;else{if(0==e.column){if(e.line>1){var d=ve.htmls[e.line-2].text.length;ve.lineIdMap.delete(ve.htmls[e.line-2].lineId),s=ve.htmls[e.line-2].text+s,ve.htmls.splice(e.line-2,1),a="\n",o=e.line-1,h=d}}else a=s[e.column-1],s=s.slice(0,e.column-1)+s.slice(e.column),h=e.column-1;n.text=s}n.width=this.getStrWidth(n.text),n.tokens=null,n.folds=null,n.states=null,this.maxLine=ve.htmls.length,this.render(),this.tokenizer.onDeleteContentAfter(o),this.lint.onDeleteContentAfter(o),this.folder.onDeleteContentAfter(o),this.updateCursorPos(e,o,h,!0),n.width>=this.maxWidthObj.width?this.maxWidthObj={lineId:n.lineId,text:n.text,width:n.width}:l.indexOf(this.maxWidthObj.lineId)>-1&&this.setMaxWidth();var f={type:z.command.INSERT,cursorPos:{line:e.line,column:e.column},preCursorPos:{line:r.line,column:r.column},text:a};return f},foldLine:function(e){var t=this,i=this.folder.foldLine(e);this.focus(),i&&(this.multiCursorPos.map((function(n){if(n.line>e&&n.line<i.end.line){var s=ve.htmls[e-1];t.updateCursorPos(n,e,s.text.length)}})),this.forceCursorView=!1,this.setCursorRealPos(),this.setScrollerHeight(),this.render())},unFold:function(e){this.focus(),this.folder.unFold(e)&&(this.forceCursorView=!1,this.setCursorRealPos(),this.setScrollerHeight(),this.render())},search:function(){var e=this;if(!this.search.stopSearch){var t={},i=null;this.search.searchText?t.text=this.search.searchText:(t=this.getToSearchObj(),this.search.searchText=t.text),t.text&&(i=this.searcher.search(t.text,t),i?(this.selectedRanges.length?this.addCursorPos(i.result.end):this.setCursorPos(i.result.end),this.selectedRanges.length<2?i.list.map((function(t){e.selecter.addSelectedRange(t.start,t.end)})):this.selecter.checkActive(i.result.end,!0),this.renderSelectedBg()):this.search.stopSearch=!0)}},moveCursor:function(e,t,i){var n=ve.htmls[e.line-1].text,s=e.line,r=e.column;if("up"===t){if(s>1){var a=this.getStrWidth(n,0,r);s--,n=ve.htmls[s-1].text,r=this.getColumnByWidth(n,a)}}else if("down"===t){if(s<ve.htmls.length){var l=this.getStrWidth(n,0,r);s++,n=ve.htmls[s-1].text,r=this.getColumnByWidth(n,l)}}else if("left"===t){while(0===r&&s>1)s--,n=ve.htmls[s-1].text,r=n.length;if(0===r)return;if(i){var o=n[r-1].match(xe.word);r--;while(r&&Boolean(o)===Boolean(n[r-1].match(xe.word)))r--}else e.line===s&&r--}else{while(r===n.length&&s<ve.htmls.length)s++,r=0,n=ve.htmls[s-1].text;if(r===n.length)return;if(i){var h=n[r].match(xe.word);r++;while(r<n.length&&Boolean(h)===Boolean(n[r].match(xe.word)))r++}else e.line===s&&r++}return this.updateCursorPos(e,s,r),{line:s,column:r}},filterMultiCursorPos:function(){var e=this,t={};this.multiCursorPos=this.multiCursorPos.filter((function(i){var n=i.line+","+i.column;return!t[n]&&(t[n]=!0,e.nowCursorPos&&e.nowCursorPos.line===i.line&&e.nowCursorPos.column===e.nowCursorPos.column&&(e.nowCursorPos=i),!0)}))},clearCursorPos:function(){this.multiCursorPos.map((function(e){e.del=!0})),this.multiCursorPos=[]},updateCursorPos:function(e,t,i,n){function s(n){n!=e&&(n.line>e.line?n.line+=t-e.line:n.line===e.line&&n.column>e.column&&(n.line+=t-e.line,n.column+=i-e.column))}n&&(this.multiCursorPos.map((function(e){s(e)})),this.selectedRanges.map((function(e){s(e.start),s(e.end)}))),e.line=t,e.column=i,this.setCursorRealPos(e),this.filterMultiCursorPos()},addCursorPos:function(e){if(e=Object.assign({},e),!(this.multiCursorPos.filter((function(t){return 0==z.comparePos(e,t)})).length>0))return this.multiCursorPos.push(e),this.multiCursorPos.sort((function(e,t){return e.line==t.line?e.column-t.column:e.line-t.line})),this.nowCursorPos=e,this.filterMultiCursorPos(),this.setCursorRealPos(e),e},setCursorPos:function(e){if(e=Object.assign({},e),1==this.multiCursorPos.length){var t=this.multiCursorPos[0];if(t.line===e.line&&t.column===e.column)return}this.multiCursorPos=[e],this.nowCursorPos=e,this.setCursorRealPos(e)},setCursorRealPos:function(e){var t=this;function i(e){t.$nextTick((function(){!e.del&&n(e)}))}function n(e){var i=0,n=ve.htmls[e.line-1];i=B()("#line_"+e.line).length&&n.tokens&&n.tokens.length?s(e):t.getStrWidthByLine(e.line,0,e.column);var r=(t.folder.getRelativeLine(e.line)-t.folder.getRelativeLine(t.startLine))*t.charObj.charHight,a=t.folder.getRelativeLine(e.line)*t.charObj.charHight;!1!==t.forceCursorView&&e===t.nowCursorPos&&(a>t.scrollTop+t.scrollerArea.height-t.charObj.charHight?t.$vScroller.scrollTop=a+t.charObj.charHight-t.scrollerArea.height:(r<0||0==r&&t.top<0)&&(t.$vScroller.scrollTop=(e.line-1)*t.charObj.charHight),i>t.scrollerArea.width+t.scrollLeft-t.charObj.fullAngleCharWidth?t.$hScroller.scrollLeft=i+t.charObj.fullAngleCharWidth-t.scrollerArea.width:i<t.scrollLeft&&(t.$hScroller.scrollLeft=i-1)),requestAnimationFrame((function(){t.forceCursorView=!0})),e.top=r+"px",e.left=i+"px",t.multiCursorPos.splice()}function s(e){for(var i=ve.htmls[e.line-1],n=i.tokens[0],s=1;s<i.tokens.length;s++){if(!(i.tokens[s].column<e.column))break;n=i.tokens[s]}var r=B()("#line_"+e.line).children(".my-editor-code").children('span[data-column="'+n.column+'"]'),a=n.value.slice(0,e.column-n.column);return r[0].offsetLeft+t.getStrWidth(a)}e?i(e):this.multiCursorPos.map((function(e){i(e)})),this.cursorVisible=!0},setMaxWidth:function(){var e={line:ve.htmls[0].lineId,width:0};ve.htmls.map((function(t){t.width>e.width&&(e={lineId:t.lineId,text:t.text,width:t.width})})),this.maxWidthObj=e},setLineWidth:function(e){var t=0,i=this,n=Date.now();function s(){while(t<e.length){var r=e[t];if(ve.lineIdMap.has(r.lineId)){var a=i.getStrWidth(r.text);r.width=a,a>i.maxWidthObj.width&&(i.maxWidthObj={lineId:r.lineId,text:r.text,width:a})}if(t++,Date.now()-n>20)break}t<e.length&&(i.setLineWidth.timer=setTimeout((function(){s()}),20))}clearTimeout(this.setLineWidth.timer),s()},setScrollerHeight:function(){var e=ve.htmls.length;e=this.folder.getRelativeLine(e),this.scrollerHeight=e*this.charObj.charHight+"px"},setSelectedRange:function(e,t){var i=z.comparePos(e,t);if(i>0){var n=e;e=t,t=n}else if(!i)return;this.clearRange(),this.selectedRanges=[{start:e,end:t,active:!0}]},setErrorMap:function(e){this.errorMap=e},getStrWidth:function(e,t,i){return z.getStrWidth(e,this.charObj.charWidth,this.charObj.fullAngleCharWidth,this.tabSize,t,i)},getStrWidthByLine:function(e,t,i){return this.getStrWidth(ve.htmls[e-1].text,t,i)},getColumnByWidth:function(e,t){var i,n,s,r,a=0,l=e.length;while(a<l){if(i=Math.floor((a+l)/2),n=this.getStrWidth(e,0,i),s=e[i-1]&&this.getStrWidth(e[i-1])/2,r=e[i]&&this.getStrWidth(e[i])/2||s,n>=t&&n-t<s||t>=n&&t-n<r){a=i;break}n>t?l=i:a=i+1}return a},getPosByEvent:function(e){var t=this,i=B()(e.target);if(i.attr("data-line")||i.attr("data-column"))return h(e);var n=B()(this.$scroller),s=n.offset(),r=0,a=e.clientX<0?0:e.clientX,l=e.clientY<0?0:e.clientY,o=Math.ceil((l+this.scrollTop-s.top)/this.charObj.charHight)||1;return o=this.folder.getRealLine(o),o>ve.htmls.length?(o=ve.htmls.length,r=ve.htmls[o-1].text.length):r=this.getColumnByWidth(ve.htmls[o-1].text,a+this.scrollLeft-s.left),{line:o,column:r};function h(e){var i=B()(e.target),n=i.attr("data-line")-0,s=i.attr("data-column");n||(n=i.parent().attr("data-line")-0);var r=ve.htmls[n-1];if(s){s-=0;for(var a=0;a<r.tokens.length;a++)if(r.tokens[a].column==s){s+=t.getColumnByWidth(r.tokens[a].value,e.offsetX);break}}else s=r.text.length;return{line:n,column:s}}},getRangeText:function(e,t){var i=ve.htmls[e.line-1].text;if(e.line!=t.line){var n=[];i=i.slice(e.column),n=ve.htmls.slice(e.line,t.line-1),n=n.map((function(e){return e.text})),i+=n.length?"\n"+n.join("\n"):"",i+="\n"+ve.htmls[t.line-1].text.slice(0,t.column)}else i=i.slice(e.column,t.column);return i},getCopyText:function(e){var t=this,i="";return this.multiCursorPos.map((function(n){var s="",r=t.selecter.checkCursorSelected(n);r?(s=t.getRangeText(r.start,r.end),e&&t.deleteContent()):(s=ve.htmls[n.line-1].text,e&&(s&&t.selecter.addSelectedRange({line:n.line,column:0},{line:n.line,column:s.length}),s&&t.deleteContent())),i+="\n"+s})),i.slice(1)},getToSearchObj:function(){var e=this.selecter.checkCursorSelected(this.nowCursorPos),t=!1,i="";if(e)i=this.getRangeText(e.start,e.end);else{var n=ve.htmls[this.nowCursorPos.line-1].text,s="",r=this.nowCursorPos.column,a=/[a-zA-Z0-9_]/;while(r>0&&n[r-1].match(a))s=n[r-1]+s,r--;r=this.nowCursorPos.column;while(r<n.length&&n[r].match(a))s+=n[r],r++;t=!0,i=s}return{text:i,wholeWord:t}},onContextmenu:function(e){var t=this,i=0,n=0,s=B()(this.$editor),r=s.offset();this.menuVisble=!0,this.$nextTick((function(){i=t.$refs.menu.$el.clientWidth,n=t.$refs.menu.$el.clientHeight,n+e.clientY>r.top+t.scrollerArea.height?t.menuStyle.top=e.clientY-r.top-n+"px":t.menuStyle.top=e.clientY-r.top+"px",i+e.clientX>r.left+s[0].clientWidth?t.menuStyle.left=e.clientX-r.left-i+"px":t.menuStyle.left=e.clientX-r.left+"px"}))},onClickMenu:function(e){var t=this;switch(e.op){case"cut":case"copy":z.writeClipboard(this.getCopyText("cut"===e.op));break;case"paste":this.$textarea.focus(),z.readClipboard().then((function(e){t.insertContent(e)}));break}this.menuVisble=!1,this.focus()},onIconMouseOver:function(e,t){var i=B()(this.$editor),n=i.offset();this.tipStyle={left:t.clientX-n.left+10+"px",top:t.clientY-n.top+10+"px"},this.tipContent=this.errorMap[e]},onIconMouseLeave:function(){this.tipContent=""},onToggleFold:function(e){ve.foldMap.has(e)?this.unFold(e):this.foldLine(e)},onClickEditor:function(){this.$refs.statusBar.closeAllPanel(),this.menuVisble=!1},onScrollerMdown:function(e){if(3!=e.which){var t=this.getPosByEvent(e);this.setCursorPos(t),this.focus(),this.mouseStartObj={time:Date.now(),start:t}}},onScrollerMmove:function(e){var t=this;if(this.mouseStartObj&&Date.now()-this.mouseStartObj.time>100){var i=B()(this.$scroller).offset(),n=this.getPosByEvent(e);this.setSelectedRange(Object.assign({},this.mouseStartObj.start),n),this.renderSelectedBg(),this.setCursorPos(n),cancelAnimationFrame(this.selectMoveTimer),e.clientY>i.top+this.scrollerArea.height?s("down",e.clientY-i.top-this.scrollerArea.height):e.clientY<i.top?s("up",i.top-e.clientY):e.clientX<i.left?s("left",i.left-e.clientX):e.clientX>i.left+this.scrollerArea.width&&s("right",e.clientX-i.left-this.scrollerArea.width)}function s(e,i){var n=t.nowCursorPos.line,s=t.nowCursorPos.column,r=0;function a(e,i){var l=n,o=s;switch(e){case"up":r+=i,l=Math.floor(r/t.charObj.charHight),l=n-l;break;case"down":r+=i,l=Math.floor(r/t.charObj.charHight),l=n+l;break;case"left":r+=i,o=Math.floor(r/t.charObj.charWidth),o=s-o;break;case"right":r+=i,o=Math.floor(r/t.charObj.charWidth),o=s+o;break}l=l<1?1:l>ve.htmls.length?ve.htmls.length:l,o=o<0?0:o>ve.htmls[n-1].text.length?ve.htmls[n-1].text.length:o,t.setCursorPos({line:l,column:o}),t.setSelectedRange(t.mouseStartObj.start,{line:l,column:o}),t.renderSelectedBg(),t.selectMoveTimer=requestAnimationFrame((function(){a(e,i)}))}a(e,i)}},onScrollerMup:function(e){var t=this.getPosByEvent(e);this.mouseStartObj&&Date.now()-this.mouseStartObj.time>100&&0!=z.comparePos(this.mouseStartObj.start,t)?(this.setSelectedRange(this.mouseStartObj.start,t),this.renderSelectedBg(),this.setCursorPos(t)):3!=e.which&&(this.clearRange(),this.mouseUpTime&&Date.now()-this.mouseUpTime<300&&this.search()),cancelAnimationFrame(this.selectMoveTimer),this.mouseStartObj=null,this.mouseUpTime=Date.now()},onHscroll:function(e){this.scrollLeft=e.target.scrollLeft,this.$scroller.scrollLeft=this.scrollLeft,this.forceCursorView=!1},onVscroll:function(e){var t=1;this.scrollTop=e.target.scrollTop,t=Math.floor(this.scrollTop/this.charObj.charHight),t++,this.startLine=this.folder.getRealLine(t),this.top=-this.scrollTop%this.charObj.charHight,this.forceCursorView=!1,this.tokenizer.onScroll(),this.render(),this.setCursorRealPos()},onWheel:function(e){this.$vScroller.scrollTop=this.scrollTop+e.deltaY,this.$hScroller.scrollLeft=this.scrollLeft+e.deltaX},onCompositionstart:function(){clearTimeout(this.compositionendTimer),this.compositionstart=!0},onCompositionend:function(){var e=this;if(this.compositionstart){var t=this.$textarea.value||"";t&&(this.insertContent(t),this.$textarea.value="")}this.compositionendTimer=setTimeout((function(){e.compositionstart=!1}),100)},onInput:function(){if(!this.compositionstart){var e=this.$textarea.value||"";e&&(this.insertContent(e),this.$textarea.value="")}},onCopy:function(e){var t=window.clipboardData?"Text":"text/plain",i=e.clipboardData||window.clipboardData;i.setData(t,this.getCopyText())},onCut:function(e){var t=window.clipboardData?"Text":"text/plain",i=e.clipboardData||window.clipboardData;i.setData(t,this.getCopyText(!0))},onPaste:function(e){var t=window.clipboardData?"Text":"text/plain",i=e.clipboardData||window.clipboardData,n="";n=i.getData(t),this.insertContent(n)},onFocus:function(){clearTimeout(this.onBlur.timer),this.showCursor()},onBlur:function(){var e=this;this.onBlur.timer=setTimeout((function(){e.hideCursor()}),300)},onKeyDown:function(e){var t=this;if(e.ctrlKey&&e.shiftKey)switch(e.keyCode){case 37:this.selecter.select("left",!0);break;case 38:break;case 39:this.selecter.select("right",!0);break;case 40:break}else if(e.ctrlKey)switch(e.keyCode){case 37:n("left",!0),this.clearRange();break;case 39:n("right",!0),this.clearRange();break;case 65:e.preventDefault();var i={line:ve.htmls.length,column:ve.htmls.peek().text.length};this.setSelectedRange({line:1,column:0},i),this.renderSelectedBg(),this.forceCursorView=!1,this.setCursorPos(i);break;case 68:e.preventDefault(),this.search();break;case 90:case 122:e.preventDefault(),this.history.undo();break;case 89:case 121:e.preventDefault(),this.history.redo();break}else if(e.shiftKey)switch(e.keyCode){case 37:this.selecter.select("left");break;case 38:this.selecter.select("up");break;case 39:this.selecter.select("right");break;case 40:this.selecter.select("down");break}else{switch(e.keyCode){case 9:e.preventDefault(),this.insertContent("\t");break;case 37:n("left"),this.clearRange();break;case 38:n("up"),this.clearRange();break;case 39:n("right"),this.clearRange();break;case 40:n("down"),this.clearRange();break;case z.keyCode.DELETE:this.deleteContent(z.keyCode.DELETE);break;case z.keyCode.BACKSPACE:this.deleteContent(z.keyCode.BACKSPACE);break}this.filterMultiCursorPos()}function n(e,i){t.selecter.checkCursorSelected(t.nowCursorPos)||t.multiCursorPos.map((function(n){t.moveCursor(n,e,i)}))}}}},be=ye,we=Object(o["a"])(be,p,d,!1,null,null,null),Ce=we.exports;n["a"].use(c["a"]);var Te=new c["a"]({routes:[{path:"/home",name:"Home",component:Ce,meta:{title:"my-editor"}},{path:"*",redirect:"/home"}]}),Se=Te;i("6295"),i("a970"),i("a205"),i("6b7e");n["a"].config.productionTip=!1,new n["a"]({router:Se,render:function(e){return e(u)}}).$mount("#app")},6295:function(e,t,i){},"6b7e":function(e,t,i){},a205:function(e,t,i){},a970:function(e,t,i){}});
//# sourceMappingURL=app.978ecc5a.js.map